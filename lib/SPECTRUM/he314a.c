#include <stdio.h>
#include <math.h>
#include "spectrum.h"

float he4471_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[73] = {-40.0,-35.0,-30.0,-25.0,-20.0,-18.0,-16.0,-14.0,-12.0,
		 -10.0,-9.00,-8.00,-7.00,-6.00,-5.00,-4.00,-3.00,-2.50,
		 -2.00,-1.80,-1.70,-1.60,-1.55,-1.50,-1.45,-1.40,-1.30,
		 -1.20,-1.10,-1.00,-0.90,-0.80,-0.70,-0.60,-0.50,-0.40,
		 -0.30,-0.20,-0.15,-0.10,-0.05,0.00,0.05,0.10,0.15,0.20,
		 0.25,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,1.50,2.00,
		 3.00,4.00,5.00,6.00,7.00,8.00,10.0,12.0,14.0,16.0,18.0,
		 20.0,25.0,30.0,35.0,40.0};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {7.63e-12,7.80e-13,7.77e-13,7.50e-13};
 static float b2[4] = {8.65e-13,7.97e-13,7.10e-13,6.15e-13};
 static float prof[73][4] = {{6.56e-06,6.71e-06,6.68e-06,6.45e-06},
 {9.04e-06,9.25e-06,9.15e-06,8.80e-06},{1.31e-05,1.34e-05,1.31e-05,1.26e-05},
 {2.04e-05,2.06e-05,2.02e-05,1.92e-05},{3.50e-05,3.50e-05,3.40e-05,3.23e-05},
 {4.51e-05,4.49e-05,4.35e-05,4.12e-05},{6.00e-05,5.94e-05,5.73e-05,5.43e-05},
 {8.29e-05,8.17e-05,7.86e-05,7.43e-05},{1.20e-04,1.18e-04,1.13e-04,1.06e-04},
 {1.87e-04,1.82e-04,1.74e-04,1.64e-04},{2.41e-04,2.34e-04,2.23e-04,2.10e-04},
 {3.22e-04,3.11e-04,2.96e-04,2.79e-04},{4.48e-04,4.31e-04,4.10e-04,3.86e-04},
 {6.56e-04,6.30e-04,5.98e-04,5.64e-04},{10.30e-04,9.89e-04,9.39e-04,8.87e-04},
 {1.90e-03,1.84e-03,1.80e-03,1.80e-03},{4.31e-03,4.24e-03,4.23e-03,4.11e-03},
 {7.33e-03,7.38e-03,7.36e-03,7.14e-03},{1.58e-02,1.55e-02,1.50e-02,1.42e-02},
 {2.52e-02,2.44e-02,2.30e-02,2.10e-02},{3.36e-02,3.20e-02,2.94e-02,2.58e-02},
 {4.49e-02,4.15e-02,3.64e-02,3.04e-02},{4.98e-02,4.54e-02,3.91e-02,3.20e-02},
 {5.18e-02,4.70e-02,4.03e-02,3.29e-02},{4.94e-02,4.58e-02,3.98e-02,3.29e-02},
 {4.37e-02,4.20e-02,3.78e-02,3.20e-02},{3.10e-02,3.21e-02,3.13e-02,2.87e-02},
 {2.23e-02,2.43e-02,2.53e-02,2.49e-02},{1.78e-02,1.97e-02,2.12e-02,2.18e-02},
 {1.64e-02,1.75e-02,1.89e-02,1.98e-02},{1.67e-02,1.66e-02,1.79e-02,1.89e-02},
 {1.88e-02,1.78e-02,1.85e-02,1.96e-02},{2.34e-02,2.16e-02,2.16e-02,2.32e-02},
 {3.07e-02,2.86e-02,2.88e-02,3.25e-02},{4.45e-02,4.26e-02,4.43e-02,5.34e-02},
 {7.13e-02,7.05e-02,7.69e-02,10.46e-02},{1.28e-01,1.33e-01,1.59e-01,2.43e-01},
 {2.89e-01,3.24e-01,4.25e-01,5.86e-01},{5.07e-01,5.82e-01,7.22e-01,8.64e-01},
 {9.94e-01,10.75e-01,11.69e-01,11.95e-01},{1.91,1.82,1.71,1.53},
 {2.90,2.54,2.17,1.80},{3.10,2.79,2.38,1.94},{2.37,2.41,2.24,1.91},
 {1.57,1.77,1.86,1.74},{1.12,1.24,1.41,1.46},{8.49e-01,8.91e-01,10.20e-01,11.59e-01},
 {5.97e-01,6.36e-01,7.19e-01,8.72e-01},{2.62e-01,2.89e-01,3.41e-01,4.46e-01},
 {1.40e-01,1.44e-01,1.63e-01,2.16e-01},{8.87e-02,8.76e-02,9.14e-02,11.14e-02},
 {6.17e-02,5.99e-02,6.02e-02,6.63e-02},{4.63e-02,4.47e-02,4.41e-02,4.58e-02},
 {3.64e-02,3.53e-02,3.46e-02,3.48e-02},{2.91e-02,2.82e-02,2.76e-02,2.74e-02},
 {10.70e-03,9.83e-03,9.34e-03,8.63e-03},{5.74e-03,5.23e-03,4.80e-03,4.35e-03},
 {2.53e-03,2.32e-03,2.20e-03,2.01e-03},{11.45e-04,10.59e-04,10.18e-04,9.49e-04},
 {6.64e-04,6.35e-04,5.92e-04,5.44e-04},{4.36e-04,4.15e-04,3.90e-04,3.58e-04},
 {3.05e-04,2.94e-04,2.75e-04,2.52e-04},{2.25e-04,2.17e-04,2.03e-04,1.86e-04},
 {1.33e-04,1.29e-04,1.21e-04,1.11e-04},{8.61e-05,8.41e-05,7.90e-05,7.21e-05},
 {5.93e-05,5.81e-05,5.45e-05,4.96e-05},{4.25e-05,4.18e-05,3.92e-05,3.55e-05},
 {3.16e-05,3.11e-05,2.91e-05,2.62e-05},{2.53e-05,2.49e-05,2.33e-05,2.10e-05},
 {1.61e-05,1.58e-05,1.48e-05,1.33e-05},{11.50e-06,11.20e-06,10.30e-06,9.22e-06},
 {9.09e-06,8.64e-06,7.88e-06,6.95e-06},{7.85e-06,7.23e-06,6.44e-06,5.58e-06}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4471.48;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -40.00) {
   p1 = b1[k]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL > 40.00) {
   p1 = b2[k]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<72;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4922_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[71] = {-40.0,-35.0,-30.0,-25.0,-20.0,-18.0,-16.0,-14.0,
		 -13.0,-12.0,-11.60,-11.40,-11.30,-11.20,-11.10,-11.00,
		 -10.0,-8.00,-6.00,-5.00,-4.00,-3.00,-2.50,-2.00,-1.80,
		 -1.70,-1.60,-1.50,-1.40,-1.30,-1.20,-1.10,-1.00,-0.80,
		 -0.60,-0.50,-0.40,-0.30,-0.20,-0.15,-0.10,-0.05,0.00,
		 0.05,0.10,0.15,0.20,0.25,0.30,0.40,0.50,0.60,0.80,1.00,
		 1.50,2.00,3.00,4.00,5.00,6.00,8.00,10.0,12.0,14.0,16.0,
		 18.0,20.0,25.0,30.0,35.0,40.0};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {1.08e-12,1.07e-12,1.03e-12,9.83e-13};
 static float b2[4] = {8.32e-13,8.42e-13,8.23e-13,7.84e-13};
 static float prof[71][4] = {{1.24e-5,1.23e-5,1.19e-5,1.13e-5},
 {1.77e-5,1.74e-5,1.68e-5,1.58e-5},{2.67e-5,2.61e-5,2.50e-5,2.35e-5},
 {4.42e-5,4.28e-5,4.07e-5,3.82e-5},{8.29e-5,7.83e-5,7.20e-5,6.45e-5},
 {11.46e-5,10.78e-5,9.88e-5,8.83e-5},{1.67e-4,1.57e-4,1.42e-4,1.27e-4},
 {2.73e-4,2.57e-4,2.36e-4,2.12e-4},{3.95e-4,3.78e-4,3.57e-4,3.31e-4},
 {6.90e-4,6.61e-4,6.19e-4,5.64e-4},{11.17e-4,10.44e-4,9.50e-4,8.43e-4},
 {1.63e-3,1.48e-3,1.29e-3,1.08e-3},{1.88e-3,1.67e-3,1.43e-3,1.17e-3},
 {1.81e-3,1.66e-3,1.44e-3,1.19e-3},{1.44e-3,1.41e-3,1.30e-3,1.12e-3},
 {1.08e-3,1.13e-3,1.10e-3,1.01e-3},{3.07e-4,3.16e-4,3.37e-4,3.56e-4},
 {3.96e-4,3.46e-4,2.97e-4,2.53e-4},{7.25e-4,6.45e-4,5.61e-4,4.84e-4},
 {11.39e-4,10.26e-4,9.09e-4,8.02e-4},{2.18e-3,2.03e-3,1.87e-3,1.76e-3},
 {5.33e-3,5.25e-3,5.15e-3,5.03e-3},{9.37e-3,9.27e-3,9.10e-3,8.82e-3},
 {1.96e-2,1.92e-2,1.86e-2,1.76e-2},{2.97e-2,2.88e-2,2.73e-2,2.51e-2},
 {3.79e-2,3.63e-2,3.37e-2,3.01e-2},{4.87e-2,4.59e-2,4.13e-2,3.53e-2},
 {6.00e-2,5.49e-2,4.79e-2,3.94e-2},{6.21e-2,5.68e-2,4.97e-2,4.08e-2},
 {5.04e-2,4.88e-2,4.54e-2,3.92e-2},{3.67e-2,3.82e-2,3.84e-2,3.60e-2},
 {2.87e-2,3.10e-2,3.28e-2,3.30e-2},{2.59e-2,2.77e-2,3.02e-2,3.16e-2},
 {3.01e-2,2.99e-2,3.26e-2,3.55e-2},{4.81e-2,4.68e-2,4.85e-2,5.64e-2},
 {6.66e-2,6.56e-2,6.90e-2,8.35e-2},{1.00e-1,1.01e-1,1.10e-1,1.42e-1},
 {1.67e-1,1.74e-1,2.01e-1,2.74e-1},{3.29e-1,3.60e-1,4.31e-1,5.47e-1},
 {5.01e-1,5.54e-1,6.46e-1,7.51e-1},{8.02e-1,8.70e-1,9.46e-1,9.90e-1},
 {1.29,1.32,1.31,1.24},{1.90,1.83,1.67,1.46},{2.38,2.20,1.92,1.62},
 {2.39,2.25,1.99,1.67},{1.96,1.96,1.84,1.61},{1.40,1.50,1.53,1.45},
 {9.51e-1,10.52e-1,11.74e-1,12.24e-1},{6.55e-1,7.20e-1,8.48e-1,9.79e-1},
 {3.47e-1,3.61e-1,4.19e-1,5.53e-1},{2.10e-1,2.10e-1,2.26e-1,2.93e-1},
 {1.40e-1,1.37e-1,1.40e-1,1.65e-1},{7.48e-2,7.12e-2,6.94e-2,7.24e-2},
 {4.58e-2,4.32e-2,4.14e-2,4.16e-2},{1.93e-2,1.83e-2,1.72e-2,1.63e-2},
 {10.20e-3,9.31e-3,8.32e-3,7.38e-3},{4.01e-3,3.78e-3,3.54e-3,3.37e-3},
 {2.18e-3,2.09e-3,1.94e-3,1.98e-3},{1.29e-3,1.23e-3,1.15e-3,1.07e-3},
 {8.57e-4,8.15e-4,7.63e-4,7.09e-4},{4.46e-4,4.26e-4,4.00e-4,3.72e-4},
 {2.67e-4,2.57e-4,2.42e-4,2.25e-4},{1.75e-4,1.69e-4,1.60e-4,1.49e-4},
 {1.23e-4,1.19e-4,1.13e-4,1.06e-4},{9.00e-5,8.76e-5,8.34e-5,7.81e-5},
 {6.80e-5,6.65e-5,6.35e-5,5.96e-5},{5.30e-5,5.20e-5,4.98e-5,4.68e-5},
 {3.12e-5,3.09e-5,2.97e-5,2.81e-5},{2.02e-5,2.01e-5,1.94e-5,1.84e-5},
 {1.39e-5,1.40e-5,1.36e-5,1.29e-5},{10.05e-6,10.16e-6,9.93e-6,9.47e-6}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4921.93;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -40.00) {
   p1 = b1[k]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL > 40.00) {
   p1 = b2[k]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<70;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4387_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[52] = {-200.00, -150.00, -100.00,  -80.00,  -60.00,  -40.00,
       -30.00,  -20.00,  -15.00,  -10.00,   -7.00,   -6.00,   -5.00,   -4.00,
	-3.00,   -2.00,   -1.50,   -1.00,   -0.80,   -0.60,   -0.50,   -0.40,
	-0.30,   -0.20,   -0.10,    0.10,    0.20,    0.40,    0.60,    0.80,
	 1.00,    1.50,    2.00,    3.00,    5.00,    7.00,   10.00,   15.00,
	20.00,   30.00,   40.00,   45.00,   48.00,   49.00,   50.00,   52.00,
	55.00,   60.00,   80.00,  100.00,  150.00,  200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[52][3] =          {{1.1493e-07,1.4151e-07,1.6275e-07},
   {2.6470e-07,3.1487e-07,3.4618e-07},{8.0837e-07,9.2151e-07,9.6592e-07},
   {1.9177e-06,2.0821e-06,2.1210e-06},{5.7516e-06,5.9826e-06,5.9612e-06},
   {1.8334e-05,1.8475e-05,1.8021e-05},{3.8941e-05,3.8470e-05,3.6992e-05},
   {1.1251e-04,1.0867e-04,1.0293e-04},{2.3696e-04,2.2635e-04,2.1298e-04},
   {6.8890e-04,6.5368e-04,6.1452e-04},{1.9128e-03,1.8258e-03,1.7289e-03},
   {3.3367e-03,3.2412e-03,3.1482e-03},{9.9378e-03,9.8285e-03,9.4680e-03},
   {3.3459e-03,3.0303e-03,2.7177e-03},{6.4067e-03,5.7929e-03,5.1853e-03},
   {2.0518e-02,1.9187e-02,1.7867e-02},{4.6556e-02,4.5380e-02,4.4098e-02},
   {1.0324e-01,1.0197e-01,9.7514e-02},{9.9506e-02,9.7633e-02,1.0278e-01},
   {1.8121e-01,1.9879e-01,2.2441e-01},{3.6432e-01,3.6625e-01,3.4750e-01},
   {4.9882e-01,4.7373e-01,4.2266e-01},{4.0798e-01,4.1450e-01,4.1506e-01},
   {3.4171e-01,3.6209e-01,4.2033e-01},{4.6212e-01,4.8653e-01,5.4998e-01},
   {1.0182e+00,1.0153e+00,9.7346e-01},{1.0048e+00,1.0133e+00,9.8074e-01},
   {5.8623e-01,6.0047e-01,6.1841e-01},{3.0895e-01,3.0937e-01,3.1482e-01},
   {1.7621e-01,1.7231e-01,1.7012e-01},{1.0981e-01,1.0560e-01,1.0196e-01},
   {4.4643e-02,4.1951e-02,3.9365e-02},{2.2086e-02,2.0824e-02,1.9524e-02},
   {8.5710e-03,8.0623e-03,7.5189e-03},{2.6066e-03,2.4611e-03,2.2967e-03},
   {1.1915e-03,1.1298e-03,1.0574e-03},{5.0683e-04,4.8460e-04,4.5537e-04},
   {1.9122e-04,1.8526e-04,1.7557e-04},{9.4635e-05,9.2770e-05,8.8630e-05},
   {3.4030e-05,3.4017e-05,3.2940e-05},{1.6214e-05,1.6463e-05,1.6122e-05},
   {1.1918e-05,1.2182e-05,1.1989e-05},{1.0065e-05,1.0325e-05,1.0189e-05},
   {9.5409e-06,9.7996e-06,9.6814e-06},{9.3060e-06,9.5594e-06,9.4492e-06},
   {7.7757e-06,8.0223e-06,7.9383e-06},{6.7635e-06,7.0005e-06,6.9473e-06},
   {5.4598e-06,5.6765e-06,5.6573e-06},{1.7838e-06,1.9295e-06,1.9601e-06},
   {1.0158e-06,1.1154e-06,1.1525e-06},{2.7697e-07,3.2304e-07,3.5132e-07},
   {1.2089e-07,1.4668e-07,1.6674e-07}};

 DL = wave - 4387.93;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<51;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3705_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[48] = {-80.00,-60.00,-40.00,-30.00,-20.00,-10.00, -7.00,
    -5.00, -3.00, -2.00, -1.50, -1.00, -0.80, -0.60, -0.40, -0.30, -0.20,
    -0.10,  0.10,  0.20,  0.40,  0.60,  0.80,  1.00,  1.50,  2.00,  3.00,
     4.00,  5.00,  6.00,  6.50,  7.00,  9.00, 11.00, 13.00, 15.00, 18.00,
    22.00, 25.00, 27.00, 28.00, 30.00, 33.00, 36.00, 40.00, 50.00, 60.00,
    80.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[48][3] =          {{1.8841e-06,2.4197e-06,2.8875e-06},
   {4.3500e-06,5.4064e-06,6.1698e-06},{1.3369e-05,1.5932e-05,1.7341e-05},
   {2.9489e-05,3.3951e-05,3.5785e-05},{1.5069e-04,1.5890e-04,1.5992e-04},
   {1.0109e-03,1.0170e-03,9.8720e-04},{2.4768e-03,2.4441e-03,2.3394e-03},
   {5.6872e-03,5.5562e-03,5.2771e-03},{1.9702e-02,1.9200e-02,1.8243e-02},
   {5.0501e-02,4.9719e-02,4.7837e-02},{9.0591e-02,9.0376e-02,8.8539e-02},
   {1.8108e-01,1.8026e-01,1.7771e-01},{2.2590e-01,2.2651e-01,2.2568e-01},
   {2.7080e-01,2.7129e-01,2.7276e-01},{3.4165e-01,3.4436e-01,3.5458e-01},
   {4.1108e-01,4.1870e-01,4.2808e-01},{4.7240e-01,4.8377e-01,4.9022e-01},
   {4.7788e-01,4.9260e-01,5.0680e-01},{4.3150e-01,4.4620e-01,4.7075e-01},
   {4.1594e-01,4.3136e-01,4.5381e-01},{3.5933e-01,3.7440e-01,3.9178e-01},
   {2.7910e-01,2.8901e-01,2.9920e-01},{2.0714e-01,2.1213e-01,2.1596e-01},
   {1.5210e-01,1.5390e-01,1.5395e-01},{7.5113e-02,7.3282e-02,7.0040e-02},
   {3.8767e-02,3.7251e-02,3.4888e-02},{1.3904e-02,1.3192e-02,1.2125e-02},
   {6.7232e-03,6.3819e-03,5.8266e-03},{4.2471e-03,4.1029e-03,3.8192e-03},
   {1.3115e-02,1.3440e-02,1.3593e-02},{8.2177e-03,8.2947e-03,8.2504e-03},
   {5.2870e-03,5.2539e-03,5.1105e-03},{1.9940e-03,1.9768e-03,1.9096e-03},
   {1.0464e-03,1.0444e-03,1.0110e-03},{6.5035e-04,6.4969e-04,6.3263e-04},
   {4.1786e-04,4.2418e-04,4.1473e-04},{2.4004e-04,2.4701e-04,2.4349e-04},
   {1.2826e-04,1.3433e-04,1.3381e-04},{8.3804e-05,8.9357e-05,8.9727e-05},
   {4.9575e-05,5.4107e-05,5.4535e-05},{4.5176e-05,4.9581e-05,5.0270e-05},
   {3.9171e-05,4.3135e-05,4.4029e-05},{3.1066e-05,3.4445e-05,3.5474e-05},
   {2.4986e-05,2.7883e-05,2.8930e-05},{1.9096e-05,2.1472e-05,2.2463e-05},
   {8.4101e-06,9.9262e-06,1.0763e-05},{4.9505e-06,5.9779e-06,6.6524e-06},
   {2.0357e-06,2.5778e-06,3.0311e-06}};

 DL = wave - 3705.00;
 if(DL < -80.0 || DL > 80.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<47;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he5875_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[68] = {-300.00,-250.00,-200.00,-150.00,-125.00,-100.00,
	 -80.00, -60.00, -40.00, -30.00, -20.00, -15.00, -12.00, -10.00,
	  -8.00,  -6.00,  -4.00,  -3.00,  -2.00,  -1.50,  -1.00,  -0.80,
	  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
	   0.80,   1.00,   1.50,   2.00,   2.50,   3.00,   4.00,   6.00,
	   8.00,  10.00,  12.00,  15.00,  20.00,  30.00,  40.00,  60.00,
	  80.00, 100.00, 150.00, 165.00, 180.00, 185.00, 188.00, 190.00,
	 191.00, 191.50, 192.00, 193.00, 195.00, 197.00, 200.00, 205.00,
	 210.00, 220.00, 230.00, 250.00, 275.00, 300.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[68][3] =
  {{1.0379e-08,1.2430e-08,1.3762e-08},{2.0109e-08,2.2891e-08,2.4613e-08},
   {3.2907e-08,3.6934e-08,3.9263e-08},{8.1273e-08,8.7732e-08,9.1083e-08},
   {1.2189e-07,1.3058e-07,1.3473e-07},{1.9836e-07,2.1083e-07,2.1615e-07},
   {3.1985e-07,3.3776e-07,3.4442e-07},{5.8478e-07,6.1338e-07,6.2210e-07},
   {1.3423e-06,1.3981e-06,1.4103e-06},{2.3952e-06,2.4856e-06,2.5005e-06},
   {5.3626e-06,5.5438e-06,5.5619e-06},{9.4529e-06,9.7543e-06,9.7727e-06},
   {1.4645e-05,1.5096e-05,1.5112e-05},{2.0922e-05,2.1553e-05,2.1565e-05},
   {3.2342e-05,3.3299e-05,3.3302e-05},{5.6591e-05,5.8256e-05,5.8284e-05},
   {1.2452e-04,1.2820e-04,1.2826e-04},{2.1898e-04,2.2510e-04,2.2523e-04},
   {4.7923e-04,4.9431e-04,4.9744e-04},{8.3587e-04,8.6597e-04,8.7996e-04},
   {1.8394e-03,1.9320e-03,2.0274e-03},{2.8503e-03,3.0443e-03,3.3489e-03},
   {5.1236e-03,5.6802e-03,7.3445e-03},{1.1934e-02,1.6203e-02,2.5926e-02},
   {6.6038e-02,7.9283e-02,8.3805e-02},{1.4470e-01,1.3640e-01,1.1768e-01},
   {1.5112e-01,1.4482e-01,1.2550e-01},{8.0127e-02,9.4986e-02,9.7801e-02},
   {3.4116e-02,3.6076e-02,4.2557e-02},{9.9989e-03,1.2559e-02,1.5672e-02},
   {3.4666e-03,4.0286e-03,5.3293e-03},{1.9756e-03,2.1242e-03,2.3654e-03},
   {7.9652e-04,8.3367e-04,8.5274e-04},{4.3427e-04,4.5164e-04,4.5580e-04},
   {2.7359e-04,2.8375e-04,2.8482e-04},{1.8831e-04,1.9501e-04,1.9521e-04},
   {1.0504e-04,1.0851e-04,1.0827e-04},{4.6277e-05,4.7776e-05,4.7595e-05},
   {2.5956e-05,2.6787e-05,2.6670e-05},{1.6602e-05,1.7123e-05,1.7041e-05},
   {1.1535e-05,1.1888e-05,1.1826e-05},{7.3965e-06,7.6118e-06,7.5682e-06},
   {4.1789e-06,4.2892e-06,4.2604e-06},{1.8732e-06,1.9136e-06,1.8975e-06},
   {1.0122e-06,1.0316e-06,1.0212e-06},{4.5049e-07,4.5752e-07,4.5231e-07},
   {2.5283e-07,2.5656e-07,2.5353e-07},{1.6116e-07,1.6362e-07,1.6169e-07},
   {7.0771e-08,7.2050e-08,7.1253e-08},{5.8451e-08,5.9564e-08,5.8919e-08},
   {4.8785e-08,4.9774e-08,4.9268e-08},{4.7371e-08,4.8344e-08,4.7819e-08},
   {4.5044e-08,4.6328e-08,4.6441e-08},{5.7533e-08,5.9447e-08,5.9600e-08},
   {1.1482e-07,1.9233e-07,4.0881e-07},{8.0167e-06,8.0746e-06,7.4523e-06},
   {4.8726e-06,5.1478e-06,5.4050e-06},{1.4755e-06,1.4723e-06,1.4716e-06},
   {8.2333e-07,8.2722e-07,8.3120e-07},{5.7040e-07,5.7106e-07,5.7043e-07},
   {4.1329e-07,4.1426e-07,4.1394e-07},{2.8987e-07,2.9070e-07,2.9027e-07},
   {2.2706e-07,2.2787e-07,2.2748e-07},{1.6042e-07,1.6115e-07,1.6082e-07},
   {1.2447e-07,1.2515e-07,1.2486e-07},{8.5280e-08,8.5879e-08,8.5640e-08},
   {5.9875e-08,6.0395e-08,6.0206e-08},{4.4990e-08,4.5446e-08,4.5293e-08}};

 DL = wave - 5875.70;
 if(DL < -300.0 || DL > 300.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<67;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3819_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
	 -40.00, -30.00, -20.00, -10.00,  -7.00,  -5.00,  -3.00,  -2.00,
	  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.30,  -0.20,  -0.10,
	   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,
	   3.00,   5.00,   7.00,   9.00,   9.50,  10.00,  10.50,  11.00,
	  12.00,  13.00,  15.00,  18.00,  20.00,  25.00,  30.00,  40.00,
	  43.00,  47.00,  48.00,  49.00,  50.00,  52.00,  55.00,  60.00,
	  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{1.1007e-07,1.4289e-07,1.7674e-07},{2.5284e-07,3.2284e-07,3.8474e-07},
   {4.1917e-07,5.2955e-07,6.1914e-07},{7.7010e-07,9.5685e-07,1.0948e-06},
   {1.4060e-06,1.7123e-06,1.9175e-06},{3.0462e-06,3.5957e-06,3.9122e-06},
   {1.1793e-05,1.2895e-05,1.3312e-05},{3.3642e-05,3.5218e-05,3.5428e-05},
   {1.0315e-04,1.0490e-04,1.0322e-04},{6.1437e-04,6.0446e-04,5.8020e-04},
   {1.4591e-03,1.4195e-03,1.3508e-03},{3.3004e-03,3.1846e-03,3.0152e-03},
   {1.1601e-02,1.1141e-02,1.0535e-02},{3.1759e-02,3.0801e-02,2.9445e-02},
   {6.6131e-02,6.4269e-02,6.1768e-02},{1.3760e-01,1.3700e-01,1.3621e-01},
   {1.9328e-01,1.9507e-01,1.9814e-01},{3.0435e-01,3.0305e-01,2.9543e-01},
   {3.3455e-01,3.3074e-01,3.3166e-01},{3.4867e-01,3.4818e-01,3.6511e-01},
   {4.5972e-01,4.5663e-01,4.7006e-01},{6.3200e-01,6.2796e-01,6.2629e-01},
   {7.7170e-01,7.9152e-01,8.0267e-01},{7.1043e-01,7.3606e-01,7.5798e-01},
   {4.9063e-01,5.1051e-01,5.3122e-01},{3.0194e-01,3.1043e-01,3.1886e-01},
   {1.8543e-01,1.8720e-01,1.8814e-01},{1.1849e-01,1.1754e-01,1.1572e-01},
   {4.7444e-02,4.5601e-02,4.3354e-02},{2.3587e-02,2.2355e-02,2.0886e-02},
   {8.5154e-03,8.0151e-03,7.4006e-03},{2.3299e-03,2.1941e-03,2.0105e-03},
   {9.8755e-04,9.3596e-04,8.5742e-04},{6.3464e-04,6.1351e-04,5.6873e-04},
   {9.0793e-04,9.2109e-04,9.2340e-04},{4.7273e-03,4.7148e-03,4.5601e-03},
   {2.1483e-03,2.1893e-03,2.2371e-03},{1.2810e-03,1.2710e-03,1.2435e-03},
   {7.7849e-04,7.7165e-04,7.5294e-04},{5.5558e-04,5.4898e-04,5.3372e-04},
   {3.3734e-04,3.3463e-04,3.2533e-04},{1.8907e-04,1.8877e-04,1.8393e-04},
   {1.3921e-04,1.3966e-04,1.3646e-04},{7.2793e-05,7.3920e-05,7.2786e-05},
   {4.0587e-05,4.1785e-05,4.1466e-05},{1.6246e-05,1.7193e-05,1.7362e-05},
   {8.7888e-06,9.6411e-06,9.8416e-06},{6.8144e-06,7.5772e-06,7.8167e-06},
   {6.7900e-06,7.5307e-06,7.7737e-06},{6.6786e-06,7.3954e-06,7.6407e-06},
   {6.4274e-06,7.1213e-06,7.3687e-06},{5.9005e-06,6.5522e-06,6.8001e-06},
   {5.1798e-06,5.7733e-06,6.0178e-06},{4.1998e-06,4.7086e-06,4.9406e-06},
   {1.6144e-06,1.9035e-06,2.0708e-06},{8.7503e-07,1.0526e-06,1.1710e-06},
   {4.6883e-07,5.7413e-07,6.5426e-07},{2.7743e-07,3.4454e-07,4.0162e-07},
   {1.1551e-07,1.4720e-07,1.8005e-07}};

 DL = wave - 3819.60;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<58;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3867_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[55] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
 -55.00, -52.00, -50.00, -48.00, -46.00, -44.00, -42.00, -40.00, -38.00,
 -36.00, -33.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
  -3.00,  -2.50,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,
  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,
   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,  80.00,
 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[55][3] =
  {{1.5286e-07,1.8516e-07,2.1579e-07},{4.0085e-07,4.6327e-07,5.0748e-07},
   {6.9049e-07,7.8437e-07,8.3894e-07},{1.2841e-06,1.4370e-06,1.5055e-06},
   {3.0927e-06,3.3371e-06,3.4185e-06},{9.2906e-06,9.7240e-06,9.8132e-06},
   {1.0830e-05,1.1344e-05,1.1430e-05},{1.1158e-05,1.1732e-05,1.1826e-05},
   {2.4578e-05,2.5208e-05,2.5288e-05},{3.5792e-05,3.6347e-05,3.6263e-05},
   {1.3372e-05,1.3910e-05,1.3726e-05},{1.4223e-05,1.4989e-05,1.4997e-05},
   {2.1667e-05,2.2520e-05,2.2478e-05},{3.3544e-05,3.4637e-05,3.4818e-05},
   {8.6444e-04,8.9175e-04,9.2509e-04},{1.2795e-04,1.2993e-04,1.3095e-04},
   {6.9897e-05,7.1122e-05,7.1027e-05},{4.4168e-05,4.5659e-05,4.5637e-05},
   {4.5092e-05,4.7057e-05,4.6948e-05},{5.9591e-05,6.2326e-05,6.2020e-05},
   {9.5794e-05,9.9923e-05,9.9123e-05},{1.9664e-04,2.0418e-04,2.0199e-04},
   {3.0119e-04,3.1269e-04,3.0965e-04},{5.2663e-04,5.4799e-04,5.4372e-04},
   {2.0141e-03,2.1332e-03,2.1380e-03},{2.8616e-03,3.0523e-03,3.0720e-03},
   {4.3931e-03,4.7221e-03,4.7708e-03},{7.0959e-03,7.7842e-03,8.0292e-03},
   {1.5063e-02,1.6667e-02,1.7473e-02},{2.2678e-02,2.5274e-02,2.6891e-02},
   {3.7983e-02,4.2942e-02,4.7197e-02},{7.7285e-02,9.0474e-02,1.0996e-01},
   {2.4397e-01,3.3087e-01,4.7111e-01},{6.8528e-01,8.7043e-01,1.0006e+00},
   {2.8269e+00,2.3094e+00,1.8301e+00},{1.6294e+00,1.5712e+00,1.4080e+00},
   {3.0163e-01,3.4247e-01,3.9763e-01},{1.0256e-01,1.1077e-01,1.1935e-01},
   {5.2030e-02,5.5450e-02,5.7109e-02},{3.1848e-02,3.3743e-02,3.4236e-02},
   {6.9341e-03,7.4082e-03,7.5533e-03},{1.6926e-03,1.8249e-03,1.8699e-03},
   {7.4264e-04,8.0448e-04,8.2777e-04},{4.1185e-04,4.4726e-04,4.6168e-04},
   {2.5967e-04,2.8239e-04,2.9226e-04},{1.1075e-04,1.2064e-04,1.2549e-04},
   {5.9728e-05,6.5116e-05,6.7978e-05},{1.2982e-05,1.5220e-05,1.6587e-05},
   {6.7154e-06,7.9002e-06,8.6912e-06},{2.6010e-06,3.0792e-06,3.4382e-06},
   {1.2999e-06,1.5490e-06,1.7514e-06},{7.4852e-07,8.9792e-07,1.0271e-06},
   {4.2472e-07,5.1387e-07,5.9606e-07},{2.6387e-07,3.2210e-07,3.7879e-07},
   {1.2080e-07,1.5030e-07,1.8179e-07}};

 DL = wave - 3867.50;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<54;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3888_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[73] = {-200.00,-150.00,-125.00,-100.00, -90.00, -85.00,
 -82.00, -80.00, -77.00, -75.00, -60.00, -40.00, -30.00, -25.00, -20.00,
 -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.50,  -2.00,  -1.80,  -1.60,
  -1.50,  -1.40,  -1.20,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,
   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,   6.00,
   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  50.00,  60.00,  80.00,
 100.00, 125.00, 150.00, 200.00, 250.00, 300.00, 350.00, 360.00, 370.00,
 375.00, 380.00, 383.00, 385.00, 387.00, 389.00, 401.00, 404.00, 410.00,
 420.00, 430.00, 450.00, 500.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[73][3] =
  {{1.9285e-08,2.1275e-08,2.2222e-08},{9.6119e-08,9.9273e-08,1.0047e-07},
   {1.6713e-07,1.7134e-07,1.7265e-07},{3.8683e-07,3.9280e-07,3.9410e-07},
   {6.9911e-07,7.0621e-07,7.0751e-07},{1.1779e-06,1.1855e-06,1.1863e-06},
   {2.1725e-06,2.1849e-06,2.1944e-06},{7.6488e-06,7.6392e-06,7.6029e-06},
   {1.6524e-07,1.7490e-07,1.7689e-07},{1.7334e-07,1.8280e-07,1.8364e-07},
   {2.7947e-07,2.9297e-07,2.9263e-07},{6.5652e-07,6.8345e-07,6.7813e-07},
   {1.1855e-06,1.2315e-06,1.2193e-06},{1.7150e-06,1.7808e-06,1.7622e-06},
   {2.6835e-06,2.7870e-06,2.7581e-06},{4.7557e-06,4.9451e-06,4.8979e-06},
   {1.0602e-05,1.1053e-05,1.0969e-05},{1.6481e-05,1.7207e-05,1.7096e-05},
   {2.9163e-05,3.0495e-05,3.0333e-05},{1.1632e-04,1.2199e-04,1.2167e-04},
   {1.6763e-04,1.7597e-04,1.7570e-04},{2.6235e-04,2.7575e-04,2.7585e-04},
   {3.2428e-04,3.4109e-04,3.4161e-04},{4.1067e-04,4.3244e-04,4.3389e-04},
   {4.6648e-04,4.9213e-04,4.9465e-04},{5.3548e-04,5.6545e-04,5.6928e-04},
   {7.2972e-04,7.7212e-04,7.8072e-04},{1.0536e-03,1.1189e-03,1.1396e-03},
   {1.6515e-03,1.7648e-03,1.8257e-03},{2.9874e-03,3.2475e-03,3.4757e-03},
   {6.7823e-03,7.7525e-03,1.0030e-02},{3.5579e-02,4.5901e-02,5.5700e-02},
   {1.0453e-01,1.0923e-01,1.0290e-01},{1.2355e-01,1.2256e-01,1.1078e-01},
   {4.4870e-02,5.5482e-02,6.3894e-02},{8.5154e-03,9.5995e-03,1.2316e-02},
   {3.8123e-03,4.0918e-03,4.3626e-03},{2.1276e-03,2.2456e-03,2.3192e-03},
   {1.3697e-03,1.4363e-03,1.4607e-03},{3.4814e-04,3.6298e-04,3.6408e-04},
   {8.9361e-05,9.3294e-05,9.3498e-05},{4.0292e-05,4.2120e-05,4.2256e-05},
   {2.2851e-05,2.3913e-05,2.4017e-05},{1.4692e-05,1.5387e-05,1.5472e-05},
   {6.5452e-06,6.8663e-06,6.9216e-06},{3.6641e-06,3.8492e-06,3.8887e-06},
   {1.5966e-06,1.6814e-06,1.7050e-06},{8.7488e-07,9.2348e-07,9.3939e-07},
   {5.4381e-07,5.7533e-07,5.8690e-07},{3.6630e-07,3.8840e-07,3.9725e-07},
   {1.9376e-07,2.0636e-07,2.1209e-07},{1.1116e-07,1.1931e-07,1.2335e-07},
   {4.6199e-08,5.1457e-08,5.4292e-08},{3.0660e-08,3.4334e-08,3.6445e-08},
   {1.5931e-08,1.8018e-08,1.9332e-08},{9.5226e-09,1.0867e-08,1.1771e-08},
   {6.2258e-09,7.1640e-09,7.8276e-09},{4.3332e-09,5.0254e-09,5.5350e-09},
   {4.0546e-09,4.7094e-09,5.1950e-09},{3.8012e-09,4.4218e-09,4.8852e-09},
   {3.6839e-09,4.2885e-09,4.7413e-09},{3.5757e-09,4.1666e-09,4.6112e-09},
   {3.5222e-09,4.1057e-09,4.5432e-09},{3.5354e-09,4.1398e-09,4.6121e-09},
   {2.2223e-08,2.8255e-08,3.2683e-08},{9.7449e-08,9.8007e-08,9.8416e-08},
   {2.3598e-08,2.4131e-08,2.4542e-08},{2.0583e-08,2.1105e-08,2.1502e-08},
   {1.6653e-08,1.7160e-08,1.7548e-08},{1.2914e-08,1.3397e-08,1.3769e-08},
   {1.0685e-08,1.1148e-08,1.1505e-08},{8.0567e-09,8.4780e-09,8.8078e-09},
   {5.0152e-09,5.3573e-09,5.6316e-09}};

 DL = wave - 3888.65;
 if(DL < -200.0 || DL > 500.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<72;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3964_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[54] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
 -40.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.00,
  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,
   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,   4.00,   6.00,   6.50,
   7.00,   7.50,   8.00,   9.00,  10.00,  15.00,  20.00,  25.00,  30.00,
  40.00,  50.00,  60.00,  80.00,  85.00,  88.00,  90.00,  95.00, 100.00,
 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[54][3] =
  {{4.6253e-08,5.5141e-08,6.1959e-08},{1.0315e-07,1.1862e-07,1.2822e-07},
   {1.6764e-07,1.8948e-07,2.0095e-07},{4.4489e-07,4.7772e-07,4.9095e-07},
   {1.0090e-06,1.0573e-06,1.0702e-06},{2.0224e-06,2.0977e-06,2.1012e-06},
   {5.3062e-06,5.4229e-06,5.3596e-06},{1.6013e-05,1.6082e-05,1.5676e-05},
   {2.6728e-05,2.6639e-05,2.5816e-05},{5.1291e-05,5.0664e-05,4.8771e-05},
   {1.2627e-04,1.2341e-04,1.1789e-04},{2.0539e-04,1.9980e-04,1.9021e-04},
   {3.8100e-04,3.6873e-04,3.4975e-04},{1.6294e-03,1.5619e-03,1.4722e-03},
   {3.7556e-03,3.5869e-03,3.3775e-03},{7.0773e-03,6.6623e-03,6.2149e-03},
   {1.5974e-02,1.5096e-02,1.4223e-02},{2.4994e-02,2.3722e-02,2.2668e-02},
   {4.5408e-02,4.3753e-02,4.3071e-02},{1.0302e-01,1.0431e-01,1.2401e-01},
   {5.8038e-01,6.0264e-01,5.8067e-01},{1.4197e+00,1.1620e+00,8.9583e-01},
   {6.7482e-01,6.8818e-01,6.4189e-01},{2.2569e-01,2.6509e-01,3.1713e-01},
   {5.2131e-02,5.1536e-02,5.7970e-02},{2.3667e-02,2.2248e-02,2.1089e-02},
   {1.3431e-02,1.2403e-02,1.1333e-02},{8.6816e-03,7.9572e-03,7.1551e-03},
   {3.9240e-03,3.5678e-03,3.1616e-03},{2.2844e-03,2.0612e-03,1.8134e-03},
   {1.7835e-03,1.7270e-03,1.6670e-03},{9.3358e-04,9.1769e-04,8.9985e-04},
   {2.7271e-04,2.4727e-04,2.2399e-04},{2.9033e-04,2.7250e-04,2.6639e-04},
   {2.2642e-03,2.2253e-03,2.0890e-03},{9.0084e-04,9.1311e-04,9.3741e-04},
   {4.1972e-04,4.0790e-04,3.9267e-04},{2.7508e-04,2.6624e-04,2.5618e-04},
   {7.8691e-05,7.5636e-05,7.1760e-05},{3.6092e-05,3.4821e-05,3.3013e-05},
   {1.9987e-05,1.9400e-05,1.8431e-05},{1.2346e-05,1.2066e-05,1.1502e-05},
   {5.7467e-06,5.6940e-06,5.4694e-06},{3.1685e-06,3.1794e-06,3.0778e-06},
   {1.9599e-06,1.9891e-06,1.9404e-06},{9.3869e-07,9.7149e-07,9.6182e-07},
   {8.1033e-07,8.4251e-07,8.3699e-07},{8.2843e-07,8.7224e-07,8.7615e-07},
   {5.5785e-06,5.6107e-06,5.6067e-06},{1.9266e-06,1.9571e-06,1.9598e-06},
   {1.3236e-06,1.3511e-06,1.3528e-06},{4.5278e-07,4.7412e-07,4.7995e-07},
   {2.5565e-07,2.7234e-07,2.7895e-07},{6.1404e-08,7.2342e-08,7.8252e-08}};

 DL = wave - 3964.73;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<53;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4009_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[42] = {-80.00,-60.00,-40.00,-30.00,-20.00,-15.00,-13.00,
 -11.00,-10.00,-9.00,-8.00,-6.00,-3.00,-2.00,-1.50,-1.00,-0.80,-0.60,-0.40,
 -0.20,-0.10,0.10,0.20,0.40,0.60,0.80,1.00,2.00,4.00,6.00,8.00,10.00,12.00,
 14.00,15.00,16.00,18.00,20.00,25.00,30.00,40.00,60.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[42][3] =
  {{2.6152e-06,3.2830e-06,3.8134e-06},{6.0267e-06,7.3130e-06,8.1301e-06},
   {1.8723e-05,2.1683e-05,2.2947e-05},{7.0412e-05,7.5174e-05,7.6278e-05},
   {2.2408e-04,2.3021e-04,2.2721e-04},{5.0989e-04,5.1233e-04,4.9741e-04},
   {7.4613e-04,7.4301e-04,7.1582e-04},{1.2007e-03,1.1847e-03,1.1349e-03},
   {1.5467e-03,1.5185e-03,1.4487e-03},{2.0388e-03,1.9912e-03,1.8927e-03},
   {2.7767e-03,2.7012e-03,2.5599e-03},{5.8879e-03,5.6913e-03,5.3704e-03},
   {3.5577e-02,3.5126e-02,3.4025e-02},{8.0852e-02,8.1636e-02,8.1280e-02},
   {8.5800e-02,8.4815e-02,8.3252e-02},{1.2577e-01,1.2435e-01,1.2220e-01},
   {1.5600e-01,1.5660e-01,1.5640e-01},{1.8784e-01,1.8987e-01,1.9249e-01},
   {2.2855e-01,2.3346e-01,2.4435e-01},{3.1096e-01,3.2617e-01,3.4263e-01},
   {3.4225e-01,3.6052e-01,3.7810e-01},{3.3585e-01,3.5228e-01,3.7643e-01},
   {3.3013e-01,3.4417e-01,3.6626e-01},{3.1930e-01,3.3187e-01,3.4792e-01},
   {2.8975e-01,2.9907e-01,3.0955e-01},{2.4829e-01,2.5359e-01,2.5864e-01},
   {2.0539e-01,2.0774e-01,2.0879e-01},{6.8390e-02,6.7258e-02,6.4815e-02},
   {1.4008e-02,1.3516e-02,1.2728e-02},{5.1330e-03,4.9729e-03,4.6909e-03},
   {2.4662e-03,2.4107e-03,2.2891e-03},{1.3791e-03,1.3635e-03,1.3048e-03},
   {8.2758e-04,8.2642e-04,7.9585e-04},{5.6231e-04,5.4453e-04,5.2959e-04},
   {4.8114e-04,4.5990e-04,4.4822e-04},{3.9550e-04,3.9537e-04,3.8666e-04},
   {2.7464e-04,2.8204e-04,2.7723e-04},{2.0690e-04,2.1437e-04,2.1230e-04},
   {1.0916e-04,1.1518e-04,1.1561e-04},{6.6470e-05,7.1632e-05,7.2782e-05},
   {1.8939e-05,2.1742e-05,2.2955e-05},{5.9851e-06,7.2462e-06,8.0835e-06}};

 DL = wave - 4009.27;
 if(DL < -80.0 || DL > 60.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<41;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4023_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[51] = {-80.00,-60.00,-45.00,-37.00,-33.00,-30.00,-28.00,
   -27.00,-25.00,-22.00,-19.00,-17.00,-16.00,-15.00,-14.00,-12.00,-10.00,
    -7.00, -5.00, -3.00, -2.00, -1.50, -1.00, -0.80, -0.60, -0.40, -0.30,
    -0.20, -0.10,  0.10,  0.20,  0.40,  0.60,  0.80,  1.00,  1.50,  2.00,
     3.00,  4.00,  6.00,  8.00, 10.00, 13.00, 16.00, 20.00, 25.00, 30.00,
    40.00, 50.00, 60.00, 80.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[51][3] =
  {{3.7261e-06,4.3475e-06,4.7626e-06},{9.5104e-06,1.0467e-05,1.0795e-05},
   {3.1943e-05,3.3295e-05,3.3141e-05},{6.7899e-05,7.0466e-05,6.9744e-05},
   {9.4452e-05,9.6458e-05,9.4998e-05},{1.2356e-04,1.2584e-04,1.2365e-04},
   {1.5056e-04,1.5299e-04,1.5012e-04},{1.6802e-04,1.7056e-04,1.6732e-04},
   {2.4322e-04,2.4821e-04,2.4439e-04},{3.8501e-04,3.8902e-04,3.8297e-04},
   {7.5979e-04,7.7043e-04,7.6329e-04},{1.7627e-03,1.8083e-03,1.8167e-03},
   {1.3589e-03,1.3689e-03,1.3439e-03},{6.4524e-04,6.4244e-04,6.1107e-04},
   {1.4044e-03,1.4168e-03,1.3984e-03},{8.4113e-04,8.4652e-04,8.2191e-04},
   {9.6733e-04,9.6583e-04,9.2903e-04},{1.5290e-03,1.5134e-03,1.4410e-03},
   {2.6222e-03,2.5886e-03,2.4511e-03},{6.5615e-03,6.5166e-03,6.1780e-03},
   {1.3903e-02,1.3922e-02,1.3238e-02},{1.9913e-02,2.0722e-02,2.0509e-02},
   {3.8923e-02,4.1051e-02,4.1536e-02},{5.5283e-02,5.8906e-02,6.0684e-02},
   {8.4571e-02,9.1532e-02,9.7192e-02},{1.4495e-01,1.6103e-01,1.8075e-01},
   {2.0197e-01,2.2861e-01,2.6685e-01},{2.9754e-01,3.4393e-01,4.1319e-01},
   {4.6898e-01,5.4294e-01,6.3998e-01},{1.1132e+00,1.1208e+00,1.1194e+00},
   {1.2826e+00,1.2043e+00,1.1364e+00},{8.1411e-01,7.6690e-01,7.2599e-01},
   {3.9343e-01,3.7851e-01,3.6120e-01},{2.1358e-01,2.0718e-01,1.9603e-01},
   {1.3096e-01,1.2773e-01,1.2046e-01},{5.3802e-02,5.2917e-02,4.9948e-02},
   {2.4039e-02,2.4723e-02,2.4367e-02},{1.0344e-02,1.0686e-02,1.0530e-02},
   {5.6725e-03,5.9001e-03,5.8423e-03},{2.3950e-03,2.5129e-03,2.5065e-03},
   {1.2850e-03,1.3541e-03,1.3598e-03},{7.8401e-04,8.3135e-04,8.3931e-04},
   {4.0780e-04,4.3581e-04,4.4333e-04},{2.4979e-04,2.6840e-04,2.7488e-04},
   {1.4630e-04,1.5821e-04,1.6370e-04},{5.5582e-05,6.2267e-05,6.5204e-05},
   {3.2523e-05,3.7458e-05,4.0155e-05},{1.5780e-05,1.8474e-05,2.0197e-05},
   {9.0134e-06,1.0667e-05,1.1837e-05},{5.6756e-06,6.7778e-06,7.6197e-06},
   {2.6942e-06,3.2692e-06,3.7639e-06}};

 DL = wave - 4023.97;
 if(DL < -80.0 || DL > 80.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<50;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4026_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[56] = {-200.00,-150.00,-100.00, -80.00, -60.00, -40.00,
  -30.00, -20.00, -10.00, -7.00,  -5.00,  -3.00,  -2.00,  -1.50,  -1.00,
   -0.80,  -0.60,  -0.40, -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
    0.80,   1.00,   1.50,  2.00,   3.00,   5.00,   7.00,  10.00,  13.00,
   15.00,  16.00,  18.00, 19.00,  20.00,  22.00,  25.00,  30.00,  40.00,
   60.00,  70.00,  80.00, 85.00,  90.00,  93.00,  95.00,  98.00, 100.00,
  105.00, 110.00, 120.00,150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[56][3] =
  {{8.2746e-08,1.0327e-07,1.2150e-07},{1.9274e-07,2.3194e-07,2.6053e-07},
   {5.8515e-07,6.7796e-07,7.2768e-07},{1.0549e-06,1.1983e-06,1.2598e-06},
   {3.9524e-06,4.1883e-06,4.2496e-06},{1.2109e-05,1.2505e-05,1.2443e-05},
   {2.4670e-05,2.5087e-05,2.4646e-05},{6.6650e-05,6.6403e-05,6.4197e-05},
   {3.5661e-04,3.4591e-04,3.2819e-04},{8.3322e-04,8.0089e-04,7.5608e-04},
   {1.8580e-03,1.7773e-03,1.6740e-03},{6.4966e-03,6.2071e-03,5.8717e-03},
   {1.8674e-02,1.7980e-02,1.7121e-02},{4.2159e-02,4.1919e-02,4.2026e-02},
   {9.7233e-02,9.6199e-02,9.3350e-02},{9.0737e-02,9.4088e-02,1.0328e-01},
   {2.5958e-01,2.4002e-01,2.1518e-01},{3.0533e-01,2.8611e-01,2.6152e-01},
   {3.1923e-01,3.2360e-01,3.6695e-01},{5.9775e-01,6.0226e-01,6.3865e-01},
   {1.3985e+00,1.3482e+00,1.2358e+00},{1.1474e+00,1.1732e+00,1.1400e+00},
   {4.8926e-01,5.1488e-01,5.5316e-01},{2.1453e-01,2.1788e-01,2.2724e-01},
   {1.1258e-01,1.1088e-01,1.1044e-01},{6.7589e-02,6.5354e-02,6.3340e-02},
   {2.6575e-02,2.5104e-02,2.3594e-02},{1.3260e-02,1.2489e-02,1.1651e-02},
   {4.9950e-03,4.6944e-03,4.3510e-03},{1.4508e-03,1.3638e-03,1.2580e-03},
   {6.2971e-04,5.9354e-04,5.4592e-04},{2.5343e-04,2.4018e-04,2.2032e-04},
   {1.3188e-04,1.2601e-04,1.1580e-04},{9.4328e-05,9.0818e-05,8.3930e-05},
   {8.3232e-05,8.0205e-05,7.3895e-05},{6.7547e-05,6.8250e-05,6.8234e-05},
   {2.2943e-03,2.2811e-03,2.2648e-03},{2.9492e-04,3.0022e-04,3.1058e-04},
   {1.1852e-04,1.1771e-04,1.1505e-04},{6.9045e-05,6.8755e-05,6.7119e-05},
   {3.7471e-05,3.7456e-05,3.6477e-05},{1.6536e-05,1.6694e-05,1.6320e-05},
   {5.0665e-06,5.2103e-06,5.1434e-06},{2.9545e-06,3.0738e-06,3.0495e-06},
   {1.3940e-06,1.4942e-06,1.4933e-06},{1.1873e-06,1.2788e-06,1.2846e-06},
   {1.0201e-06,1.1040e-06,1.1146e-06},{9.3402e-07,1.0137e-06,1.0267e-06},
   {9.2823e-07,1.0052e-06,1.0192e-06},{8.8573e-07,9.5893e-07,9.7467e-07},
   {8.4787e-07,9.1871e-07,9.3537e-07},{7.5627e-07,8.2163e-07,8.4009e-07},
   {6.7436e-07,7.3481e-07,7.5452e-07},{5.3973e-07,5.9181e-07,6.1286e-07},
   {2.4151e-07,2.7657e-07,2.9729e-07},{9.6316e-08,1.1699e-07,1.3376e-07}};

 DL = wave - 4026.20;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<55;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4120_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[60] = {-200.00,-150.00,-125.00,-110.00,-100.00, -97.00,
 -95.00, -93.00, -90.00, -85.00, -80.00, -77.00, -75.00, -73.00, -70.00,
 -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
  -3.00,  -2.50,  -2.00,  -1.80,  -1.60,  -1.50,  -1.40,  -1.20,  -1.00,
  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
   0.80,   1.00,   2.00,   4.00,   6.00,   8.00,  10.00,  15.00,  20.00,
  30.00,  40.00,  50.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[60][3] =
  {{1.3729e-07,1.6060e-07,1.7602e-07},{4.3032e-07,4.7198e-07,4.9607e-07},
   {6.2243e-07,6.8265e-07,7.1444e-07},{1.6823e-06,1.7597e-06,1.7980e-06},
   {2.1322e-06,2.2268e-06,2.2716e-06},{2.1590e-06,2.2572e-06,2.3011e-06},
   {8.5103e-07,9.6003e-07,1.0111e-06},{9.3462e-07,1.0446e-06,1.0939e-06},
   {1.3252e-06,1.4416e-06,1.4937e-06},{3.4638e-06,3.5956e-06,3.6529e-06},
   {7.8764e-06,8.0254e-06,8.0813e-06},{1.0145e-05,1.0367e-05,1.0483e-05},
   {4.9028e-05,4.9358e-05,4.9219e-05},{1.6903e-05,1.7121e-05,1.7249e-05},
   {9.3689e-06,9.5615e-06,9.6354e-06},{5.3759e-06,5.6335e-06,5.7263e-06},
   {6.8330e-06,7.3903e-06,7.5555e-06},{9.7351e-06,1.0688e-05,1.0942e-05},
   {1.4130e-05,1.5463e-05,1.5801e-05},{2.2197e-05,2.4205e-05,2.4692e-05},
   {3.9466e-05,4.2873e-05,4.3680e-05},{8.8061e-05,9.5361e-05,9.7124e-05},
   {1.3668e-04,1.4796e-04,1.5077e-04},{2.4079e-04,2.6096e-04,2.6623e-04},
   {9.3826e-04,1.0260e-03,1.0531e-03},{1.3410e-03,1.4714e-03,1.5139e-03},
   {2.0736e-03,2.2867e-03,2.3612e-03},{2.5409e-03,2.8047e-03,2.8995e-03},
   {3.1038e-03,3.4622e-03,3.6154e-03},{3.5005e-03,3.9095e-03,4.0925e-03},
   {3.9965e-03,4.4671e-03,4.6842e-03},{5.3816e-03,6.0302e-03,6.3554e-03},
   {7.6440e-03,8.6011e-03,9.1432e-03},{1.1717e-02,1.3279e-02,1.4353e-02},
   {2.0308e-02,2.3402e-02,2.6296e-02},{4.3728e-02,5.2880e-02,6.9946e-02},
   {1.7479e-01,2.4945e-01,3.4828e-01},{5.2481e-01,6.4494e-01,6.9064e-01},
   {1.3733e+00,1.2543e+00,1.0404e+00},{7.0281e-01,7.7524e-01,7.5478e-01},
   {1.2652e-01,1.5594e-01,1.9931e-01},{4.1998e-02,4.7270e-02,5.4476e-02},
   {2.1751e-02,2.3877e-02,2.5453e-02},{1.3495e-02,1.4662e-02,1.5286e-02},
   {3.1301e-03,3.3875e-03,3.4930e-03},{7.8679e-04,8.5267e-04,8.7893e-04},
   {3.5252e-04,3.8233e-04,3.9459e-04},{1.9925e-04,2.1611e-04,2.2328e-04},
   {1.2785e-04,1.3863e-04,1.4336e-04},{5.6749e-05,6.1473e-05,6.3678e-05},
   {3.1632e-05,3.4237e-05,3.5524e-05},{1.3656e-05,1.4769e-05,1.5368e-05},
   {4.0459e-06,4.6481e-06,4.9941e-06},{2.4338e-06,2.8092e-06,3.0392e-06},
   {1.6056e-06,1.8598e-06,2.0240e-06},{8.2048e-07,9.5735e-07,1.0538e-06},
   {4.8097e-07,5.6543e-07,6.2925e-07},{2.7828e-07,3.3029e-07,3.7253e-07},
   {1.7607e-07,2.1102e-07,2.4114e-07},{8.3592e-08,1.0221e-07,1.1986e-07}};

 DL = wave - 4120.80;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<59;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4143_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[51] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
  -40.00, -30.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.50,
   -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.30,  -0.20,  -0.10,
    0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,   6.00,
    8.00,  10.00,  15.00,  20.00,  22.00,  24.00,  25.00,  26.00,  28.00,
   30.00,  40.00,  50.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[51][3] =
  {{1.4737e-07,1.9118e-07,2.3464e-07},{3.4168e-07,4.3635e-07,5.1388e-07},
   {5.7074e-07,7.1990e-07,8.2999e-07},{1.0603e-06,1.3113e-06,1.4753e-06},
   {1.9644e-06,2.3690e-06,2.6003e-06},{4.3658e-06,5.0590e-06,5.3697e-06},
   {2.3640e-05,2.4833e-05,2.5000e-05},{5.5076e-05,5.6325e-05,5.5618e-05},
   {1.6481e-04,1.6384e-04,1.5834e-04},{3.4808e-04,3.4067e-04,3.2538e-04},
   {1.0133e-03,9.7834e-04,9.2587e-04},{1.8094e-03,1.7386e-03,1.6415e-03},
   {3.8644e-03,3.7092e-03,3.5047e-03},{3.2294e-02,3.2429e-02,3.2014e-02},
   {4.0129e-02,4.0156e-02,3.9622e-02},{3.0401e-02,2.8407e-02,2.6399e-02},
   {5.7316e-02,5.4402e-02,5.0986e-02},{1.1706e-01,1.1568e-01,1.1452e-01},
   {1.6550e-01,1.6653e-01,1.7001e-01},{2.6165e-01,2.6733e-01,2.6847e-01},
   {3.0935e-01,3.1320e-01,3.1558e-01},{2.9486e-01,3.0126e-01,3.2033e-01},
   {3.3274e-01,3.4012e-01,3.6483e-01},{4.3013e-01,4.3951e-01,4.5634e-01},
   {5.6826e-01,5.9115e-01,6.0731e-01},{5.6508e-01,5.8818e-01,6.0812e-01},
   {4.7731e-01,4.9106e-01,5.0545e-01},{3.5686e-01,3.6245e-01,3.6773e-01},
   {2.5414e-01,2.5487e-01,2.5451e-01},{1.8018e-01,1.7850e-01,1.7558e-01},
   {4.2215e-02,4.0611e-02,3.8540e-02},{8.1632e-03,7.7814e-03,7.2972e-03},
   {3.0732e-03,2.9428e-03,2.7658e-03},{1.5290e-03,1.4741e-03,1.3914e-03},
   {8.8535e-04,8.5919e-04,8.1495e-04},{3.1037e-04,3.0621e-04,2.9367e-04},
   {1.4419e-04,1.4455e-04,1.4020e-04},{1.1208e-04,1.1304e-04,1.1014e-04},
   {8.5852e-05,8.7161e-05,8.5243e-05},{7.7172e-05,7.8605e-05,7.7070e-05},
   {7.2351e-05,7.3812e-05,7.2547e-05},{6.0437e-05,6.1954e-05,6.1175e-05},
   {5.0806e-05,5.2334e-05,5.1882e-05},{2.1629e-05,2.2862e-05,2.3078e-05},
   {8.8313e-06,9.7379e-06,1.0052e-05},{5.4822e-06,6.1495e-06,6.4466e-06},
   {1.9967e-06,2.3786e-06,2.5950e-06},{1.0898e-06,1.3254e-06,1.4786e-06},
   {5.9109e-07,7.3143e-07,8.3517e-07},{3.5521e-07,4.4506e-07,5.1893e-07},
   {1.5388e-07,1.9673e-07,2.3912e-07}};

 DL = wave - 4143.76;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<50;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4168_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[50] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -40.00, -37.00, -33.00,
  -30.00, -28.00, -27.00, -25.00, -22.00, -20.00, -15.00, -10.00,  -8.00,
   -6.00,  -3.00,  -2.50,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,
   -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[50][3] =
  {{2.1275e-07,2.5685e-07,2.9703e-07},{6.0209e-07,6.8748e-07,7.3675e-07},
   {1.0635e-06,1.1917e-06,1.2430e-06},{2.0185e-06,2.2258e-06,2.2695e-06},
   {3.8782e-06,4.2196e-06,4.2356e-06},{1.1798e-05,1.2360e-05,1.2268e-05},
   {4.8895e-05,4.9978e-05,4.9457e-05},{6.3954e-05,6.5208e-05,6.4556e-05},
   {1.1909e-04,1.2057e-04,1.1952e-04},{2.3298e-04,2.3659e-04,2.3663e-04},
   {8.3653e-04,8.5319e-04,8.5457e-04},{2.7206e-04,2.7655e-04,2.7584e-04},
   {1.0466e-04,1.0734e-04,1.0486e-04},{1.5800e-04,1.6028e-04,1.5731e-04},
   {1.6997e-04,1.7193e-04,1.6833e-04},{2.1767e-04,2.1890e-04,2.1188e-04},
   {3.8154e-04,3.7980e-04,3.6304e-04},{5.4611e-04,5.4173e-04,5.1558e-04},
   {9.3377e-04,9.2637e-04,8.8120e-04},{3.4988e-03,3.5290e-03,3.3840e-03},
   {4.9636e-03,5.0435e-03,4.8568e-03},{7.5878e-03,7.7711e-03,7.5102e-03},
   {1.1861e-02,1.2478e-02,1.2401e-02},{2.4765e-02,2.6348e-02,2.6721e-02},
   {3.6778e-02,3.9514e-02,4.0822e-02},{6.0252e-02,6.5883e-02,7.0709e-02},
   {1.1723e-01,1.3322e-01,1.5792e-01},{3.2058e-01,4.0633e-01,5.4266e-01},
   {7.0577e-01,8.6276e-01,1.0032e+00},{2.2866e+00,1.9893e+00,1.6987e+00},
   {1.7162e+00,1.5674e+00,1.4029e+00},{4.6284e-01,4.7975e-01,5.1077e-01},
   {1.7743e-01,1.8122e-01,1.8471e-01},{9.3064e-02,9.4246e-02,9.2757e-02},
   {5.7052e-02,5.7673e-02,5.6149e-02},{1.1897e-02,1.2322e-02,1.2199e-02},
   {2.9245e-03,3.0545e-03,3.0365e-03},{1.2739e-03,1.3392e-03,1.3386e-03},
   {7.0073e-04,7.3991e-04,7.4286e-04},{4.3809e-04,4.6414e-04,4.6784e-04},
   {1.7608e-04,1.8815e-04,1.9137e-04},{9.2060e-05,9.8935e-05,1.0138e-04},
   {3.6116e-05,3.9127e-05,4.0569e-05},{1.0425e-05,1.2042e-05,1.2926e-05},
   {3.8033e-06,4.4856e-06,4.9375e-06},{1.8729e-06,2.2309e-06,2.4939e-06},
   {1.0717e-06,1.2860e-06,1.4560e-06},{6.0672e-07,7.3366e-07,8.4239e-07},
   {3.7730e-07,4.5939e-07,5.3444e-07},{1.7385e-07,2.1451e-07,2.5610e-07}};

 DL = wave - 4168.97;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<49;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4437_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -57.00, -55.00, -54.00,
  -53.00, -51.00, -50.00, -49.00, -48.00, -46.00, -43.00, -40.00, -30.00,
  -25.00, -20.00, -15.00, -10.00,  -7.00,  -5.00,  -3.00,  -2.50,  -2.00,
   -1.80,  -1.60,  -1.50,  -1.40,  -1.20,  -1.00,  -0.80,  -0.60,  -0.40,
   -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{1.7938e-07,2.0998e-07,2.3063e-07},{4.0624e-07,4.5785e-07,4.8312e-07},
   {1.2037e-06,1.2751e-06,1.3014e-06},{2.2184e-06,2.3245e-06,2.3471e-06},
   {5.9430e-06,6.0987e-06,6.1070e-06},{2.2334e-05,2.2541e-05,2.2471e-05},
   {3.8535e-05,3.8910e-05,3.8952e-05},{1.0662e-04,1.0746e-04,1.0638e-04},
   {4.5480e-05,4.3943e-05,4.1479e-05},{2.1642e-05,2.1805e-05,2.1461e-05},
   {8.0792e-06,8.3726e-06,8.2368e-06},{1.5430e-05,1.6091e-05,1.6150e-05},
   {2.6153e-05,2.6662e-05,2.6579e-05},{2.8185e-05,2.8625e-05,2.8555e-05},
   {3.0360e-05,3.0789e-05,3.0695e-05},{3.5292e-05,3.5717e-05,3.5554e-05},
   {1.4602e-05,1.5093e-05,1.4898e-05},{2.2548e-05,2.3318e-05,2.2898e-05},
   {3.0400e-05,3.1411e-05,3.0760e-05},{4.4483e-05,4.5890e-05,4.4814e-05},
   {7.4403e-05,7.6594e-05,7.4648e-05},{1.5871e-04,1.6321e-04,1.5902e-04},
   {3.1510e-04,3.2487e-04,3.1705e-04},{6.0646e-04,6.2849e-04,6.1500e-04},
   {1.6487e-03,1.7288e-03,1.7027e-03},{2.3544e-03,2.4794e-03,2.4474e-03},
   {3.4854e-03,3.7240e-03,3.7257e-03},{4.2728e-03,4.5700e-03,4.5820e-03},
   {5.3696e-03,5.7531e-03,5.7857e-03},{6.0833e-03,6.5251e-03,6.5756e-03},
   {6.9502e-03,7.4648e-03,7.5410e-03},{9.3522e-03,1.0080e-02,1.0252e-02},
   {1.3264e-02,1.4377e-02,1.4784e-02},{2.0295e-02,2.2208e-02,2.3315e-02},
   {3.4973e-02,3.9072e-02,4.3152e-02},{7.5006e-02,8.8853e-02,1.1812e-01},
   {2.8286e-01,4.0261e-01,5.5071e-01},{8.4681e-01,1.0114e+00,1.0392e+00},
   {2.4126e+00,1.9470e+00,1.4928e+00},{1.1108e+00,1.1529e+00,1.0666e+00},
   {1.6631e-01,1.9696e-01,2.6436e-01},{6.9130e-02,7.4261e-02,8.0158e-02},
   {3.6919e-02,3.8943e-02,4.0000e-02},{2.3265e-02,2.4335e-02,2.4483e-02},
   {5.7205e-03,5.9395e-03,5.8804e-03},{1.3693e-03,1.4384e-03,1.4392e-03},
   {6.0694e-04,6.4151e-04,6.4457e-04},{3.4026e-04,3.6111e-04,3.6403e-04},
   {2.1682e-04,2.3072e-04,2.3317e-04},{9.3614e-05,1.0003e-04,1.0155e-04},
   {5.1415e-05,5.5012e-05,5.6028e-05},{2.1707e-05,2.3248e-05,2.3791e-05},
   {1.1589e-05,1.2422e-05,1.2764e-05},{4.6570e-06,5.0047e-06,5.1806e-06},
   {1.3045e-06,1.4917e-06,1.6006e-06},{7.5862e-07,8.7479e-07,9.5001e-07},
   {4.3491e-07,5.0704e-07,5.5877e-07},{2.7256e-07,3.2145e-07,3.5943e-07},
   {1.2686e-07,1.5333e-07,1.7652e-07}};

 DL = wave - 4437.55;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<58;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4713_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[67] =
{-280.00,-270.00,-260.00,-255.00,-250.00,-246.00,-244.00,-242.00,-240.00,
 -230.00,-220.00,-210.00,-206.00,-202.00,-198.00,-196.00,-194.00,-192.00,
 -188.00,-184.00,-180.00,-170.00,-160.00,-140.00,-120.00,-100.00, -80.00,
  -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
   -4.00,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,
    0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,   4.00,
    6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,  80.00,
  100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[67][3] =
  {{7.1390e-08,7.9028e-08,8.2872e-08},{7.3535e-08,8.1504e-08,8.5477e-08},
   {7.3005e-08,8.1326e-08,8.5435e-08},{7.1180e-08,7.9690e-08,8.3855e-08},
   {6.7618e-08,7.6398e-08,8.0728e-08},{2.5187e-07,2.6065e-07,2.6476e-07},
   {2.7034e-07,2.7929e-07,2.8365e-07},{2.9317e-07,3.0221e-07,3.0658e-07},
   {3.3107e-07,3.4013e-07,3.4439e-07},{7.6185e-08,8.6102e-08,9.0693e-08},
   {7.5852e-08,8.5833e-08,9.0487e-08},{8.4773e-08,9.5270e-08,1.0006e-07},
   {8.8901e-08,9.9626e-08,1.0449e-07},{9.5146e-08,1.0622e-07,1.1106e-07},
   {1.1198e-07,1.2439e-07,1.2991e-07},{8.9726e-07,9.6639e-07,9.7186e-07},
   {3.1746e-06,3.1848e-06,3.1806e-06},{1.8340e-06,1.8467e-06,1.8543e-06},
   {1.0750e-06,1.0867e-06,1.0916e-06},{8.1161e-07,8.2353e-07,8.2873e-07},
   {6.7448e-07,6.8661e-07,6.9177e-07},{5.1787e-07,5.3059e-07,5.3584e-07},
   {4.5509e-07,4.6849e-07,4.7378e-07},{4.2168e-07,4.3661e-07,4.4184e-07},
   {2.9172e-07,3.0861e-07,3.1345e-07},{4.2982e-07,4.4937e-07,4.5324e-07},
   {6.8447e-07,7.0937e-07,7.1171e-07},{1.2207e-06,1.2634e-06,1.2664e-06},
   {2.6663e-06,2.7991e-06,2.8292e-06},{4.5723e-06,4.8840e-06,4.9860e-06},
   {6.4172e-06,6.9408e-06,7.1358e-06},{9.7200e-06,1.0675e-05,1.1067e-05},
   {1.6713e-05,1.8658e-05,1.9516e-05},{3.6597e-05,4.1384e-05,4.3589e-05},
   {5.6807e-05,6.4407e-05,6.7940e-05},{1.0071e-04,1.1420e-04,1.2052e-04},
   {2.2722e-04,2.5675e-04,2.7062e-04},{8.7950e-04,1.0013e-03,1.0655e-03},
   {1.5479e-03,1.7678e-03,1.8934e-03},{3.4251e-03,3.9475e-03,4.3126e-03},
   {5.3009e-03,6.1676e-03,6.8996e-03},{9.3804e-03,1.1158e-02,1.3287e-02},
   {2.0872e-02,2.7114e-02,4.1558e-02},{9.9921e-02,1.4538e-01,1.9169e-01},
   {2.7681e-01,3.2372e-01,3.2906e-01},{4.7716e-01,4.7432e-01,4.2098e-01},
   {2.5385e-01,3.0282e-01,3.1472e-01},{6.4486e-02,7.9425e-02,1.0235e-01},
   {1.7699e-02,2.1664e-02,2.8269e-02},{8.9821e-03,1.0214e-02,1.1536e-02},
   {5.5128e-03,6.1786e-03,6.6846e-03},{2.3742e-03,2.6260e-03,2.7705e-03},
   {1.3308e-03,1.4649e-03,1.5346e-03},{3.3171e-04,3.6389e-04,3.7985e-04},
   {1.5007e-04,1.6420e-04,1.7119e-04},{8.5449e-05,9.3399e-05,9.7362e-05},
   {5.5131e-05,6.0264e-05,6.2857e-05},{2.4707e-05,2.7080e-05,2.8324e-05},
   {1.3889e-05,1.5285e-05,1.6043e-05},{6.1127e-06,6.7737e-06,7.1521e-06},
   {3.3952e-06,3.7782e-06,4.0060e-06},{1.4702e-06,1.6404e-06,1.7475e-06},
   {8.0617e-07,8.9850e-07,9.5918e-07},{2.5159e-07,3.0801e-07,3.4648e-07},
   {1.5445e-07,1.8840e-07,2.1257e-07},{1.0376e-07,1.2597e-07,1.4241e-07},
   {5.5272e-08,6.6468e-08,7.5367e-08}};

 DL = wave - 4713.20;
 if(DL < -280.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<66;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he5047_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] =
{-200.00,-160.00,-155.00,-147.00,-143.00,-140.00,-138.00,-136.00,-134.00,
 -131.00,-129.00,-127.00,-125.00,-123.00,-120.00,-115.00,-110.00,-100.00,
  -80.00, -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,
   -6.00,  -4.00,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,
   -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{3.6591e-07,3.8371e-07,3.8733e-07},{1.1729e-06,1.1939e-06,1.1957e-06},
   {1.4219e-06,1.4432e-06,1.4446e-06},{2.1887e-06,2.2108e-06,2.2118e-06},
   {3.1195e-06,3.1413e-06,3.1405e-06},{5.0203e-06,5.0530e-06,5.0705e-06},
   {1.0870e-05,1.0903e-05,1.0839e-05},{2.2248e-06,2.2634e-06,2.2741e-06},
   {2.7818e-06,2.8075e-06,2.8095e-06},{5.3648e-06,5.3782e-06,5.3658e-06},
   {1.3728e-06,1.4004e-06,1.4032e-06},{4.4515e-07,4.6879e-07,4.6715e-07},
   {6.2434e-07,6.4842e-07,6.4457e-07},{7.6599e-07,7.8979e-07,7.8596e-07},
   {9.0168e-07,9.2442e-07,9.1970e-07},{1.0323e-06,1.0550e-06,1.0488e-06},
   {1.1257e-06,1.1482e-06,1.1401e-06},{1.2984e-06,1.3199e-06,1.3071e-06},
   {1.7587e-06,1.7756e-06,1.7464e-06},{2.6430e-06,2.6519e-06,2.5881e-06},
   {5.1173e-06,5.1563e-06,5.0226e-06},{8.5313e-06,8.7050e-06,8.5240e-06},
   {1.1885e-05,1.2256e-05,1.2061e-05},{1.7920e-05,1.8738e-05,1.8564e-05},
   {3.0482e-05,3.2422e-05,3.2379e-05},{6.6780e-05,7.2046e-05,7.2453e-05},
   {1.0367e-04,1.1222e-04,1.1305e-04},{1.8391e-04,1.9929e-04,2.0094e-04},
   {4.1529e-04,4.4900e-04,4.5262e-04},{1.6147e-03,1.7628e-03,1.7984e-03},
   {2.8544e-03,3.1288e-03,3.2186e-03},{6.3731e-03,7.0673e-03,7.4527e-03},
   {9.9205e-03,1.1136e-02,1.2102e-02},{1.7699e-02,2.0416e-02,2.4224e-02},
   {4.0180e-02,5.1953e-02,8.1270e-02},{1.9571e-01,2.8053e-01,3.5201e-01},
   {5.4065e-01,6.0667e-01,5.7714e-01},{9.5068e-01,8.5412e-01,6.9221e-01},
   {4.3185e-01,4.9999e-01,4.9476e-01},{6.4497e-02,8.5756e-02,1.3191e-01},
   {2.7314e-02,3.0645e-02,3.6220e-02},{1.4730e-02,1.6106e-02,1.7305e-02},
   {9.3607e-03,1.0103e-02,1.0512e-02},{4.1496e-03,4.4309e-03,4.5111e-03},
   {2.3499e-03,2.4998e-03,2.5289e-03},{5.8897e-04,6.2685e-04,6.3391e-04},
   {2.6698e-04,2.8381e-04,2.8696e-04},{1.5199e-04,1.6159e-04,1.6349e-04},
   {9.7936e-05,1.0423e-04,1.0559e-04},{4.3689e-05,4.6709e-05,4.7504e-05},
   {2.4424e-05,2.6259e-05,2.6824e-05},{1.0629e-05,1.1536e-05,1.1871e-05},
   {5.8388e-06,6.3775e-06,6.5983e-06},{2.4801e-06,2.7251e-06,2.8387e-06},
   {1.3393e-06,1.4732e-06,1.5406e-06},{8.2585e-07,9.0779e-07,9.5187e-07},
   {5.0662e-07,5.5591e-07,5.8437e-07},{1.7203e-07,2.0424e-07,2.2399e-07},
   {8.9494e-08,1.0563e-07,1.1670e-07}};

 DL = wave - 5047.74;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<57;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he6678_314(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[53] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -55.00, -52.00, -49.00,
  -48.00, -47.00, -46.50, -46.00, -45.50, -45.00, -44.00, -43.00, -40.00,
  -35.00, -30.00, -20.00, -15.00, -10.00,  -6.00,  -4.00,  -2.00,  -1.00,
   -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
    0.80,   1.00,   1.50,   2.00,   3.00,   5.00,  10.00,  15.00,  20.00,
   30.00,  45.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[53][3] =
  {{1.1033e-07,1.0967e-07,1.0743e-07},{2.3913e-07,2.3329e-07,2.2573e-07},
   {3.9102e-07,3.7863e-07,3.6470e-07},{7.2235e-07,6.9620e-07,6.6924e-07},
   {1.3823e-06,1.3327e-06,1.2839e-06},{3.7795e-06,3.6773e-06,3.5804e-06},
   {5.7615e-06,5.6376e-06,5.5214e-06},{8.2641e-06,8.1211e-06,7.9847e-06},
   {1.5020e-05,1.4892e-05,1.4800e-05},{2.1201e-05,2.0928e-05,2.0602e-05},
   {4.4144e-05,4.6260e-05,4.9137e-05},{9.2419e-05,8.6222e-05,7.7283e-05},
   {8.4287e-06,9.6673e-06,1.2510e-05},{2.6708e-06,2.4677e-06,2.3212e-06},
   {2.2061e-06,1.9986e-06,1.7984e-06},{2.0549e-06,1.8455e-06,1.6458e-06},
   {2.0838e-06,1.8684e-06,1.6652e-06},{2.3494e-06,2.1031e-06,1.8727e-06},
   {3.0417e-06,2.7218e-06,2.4237e-06},{4.1128e-06,3.6818e-06,3.2806e-06},
   {9.0701e-06,8.1422e-06,7.2763e-06},{1.5971e-05,1.4361e-05,1.2854e-05},
   {3.5793e-05,3.2222e-05,2.8869e-05},{9.9828e-05,8.9921e-05,8.0608e-05},
   {2.2346e-04,2.0178e-04,1.8144e-04},{8.9295e-04,8.1102e-04,7.3789e-04},
   {3.6179e-03,3.3772e-03,3.2859e-03},{5.7265e-03,5.4858e-03,5.8482e-03},
   {1.0591e-02,1.0868e-02,1.5249e-02},{2.6899e-02,3.6353e-02,5.6750e-02},
   {1.5497e-01,1.7119e-01,1.6524e-01},{3.3553e-01,2.8692e-01,2.2490e-01},
   {4.2213e-01,3.3054e-01,2.4444e-01},{2.2881e-01,2.2361e-01,1.9458e-01},
   {4.0124e-02,5.4629e-02,7.7429e-02},{1.5678e-02,1.6444e-02,2.2973e-02},
   {8.4553e-03,8.3171e-03,9.1050e-03},{5.3765e-03,5.1599e-03,5.1770e-03},
   {2.3993e-03,2.2645e-03,2.1667e-03},{1.3659e-03,1.2839e-03,1.2146e-03},
   {6.2036e-04,5.8193e-04,5.4702e-04},{2.2527e-04,2.1256e-04,2.0036e-04},
   {5.7567e-05,5.4657e-05,5.1748e-05},{2.5655e-05,2.4464e-05,2.3243e-05},
   {1.4349e-05,1.3732e-05,1.3083e-05},{6.2419e-06,6.0075e-06,5.7496e-06},
   {2.6653e-06,2.5831e-06,2.4855e-06},{1.4107e-06,1.3746e-06,1.3280e-06},
   {7.5155e-07,7.3760e-07,7.1656e-07},{4.5756e-07,4.5199e-07,4.4135e-07},
   {2.7646e-07,2.7514e-07,2.7022e-07},{1.8167e-07,1.8205e-07,1.7973e-07},
   {9.0830e-08,9.2211e-08,9.1903e-08}};

 DL = wave - 6678.15;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<51;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}
