/* Includes Opacity Project data smoothed to remove resonance features.
   Added for v2.75 , Dec 16, 2007 */

#include <math.h>
#include <errno.h>
void search(float xx[], int n, float x, int *jlo);


double he1op_av(double nu,double T,double Ne)
{

  double hckt,A,H,waveno,x,u,Ryd,ryd,xsect,tkev,lnryd,stim;
  int i,j;

  static float x1[48] =
    {1.760792e+00,1.920779e+00,2.269878e+00,2.743476e+00,3.377872e+00,
     3.632486e+00,4.162550e+00,4.279843e+00,4.443188e+00,4.581267e+00,
     4.741080e+00,4.741980e+00,4.742223e+00,4.744493e+00,5.136753e+00,
     5.326348e+00,6.174420e+00,6.423854e+00,6.872833e+00,7.421586e+00,
     7.770792e+00,8.417999e+00,8.938535e+00,9.491269e+00,1.007818e+01,
     1.070137e+01,1.136310e+01,1.206576e+01,1.281187e+01,1.360411e+01,
     1.444534e+01,1.533859e+01,1.628708e+01,1.729420e+01,1.836362e+01,
     1.949918e+01,2.070493e+01,2.154990e+01,2.242937e+01,2.340180e+01,
     2.502370e+01,2.675790e+01,2.861240e+01,3.059530e+01,3.271570e+01,
     3.498300e+01,3.740750e+01,4.000000e+01};
  static float y1[48] =
    {7.468e+00,6.516e+00,4.978e+00,3.542e+00,2.375e+00,
     2.079e+00,1.647e+00,1.626e+00,1.488e+00,1.357e+00,
     1.266e+00,1.258e+00,1.266e+00,1.265e+00,1.002e+00,
     9.160e-01,6.272e-01,5.679e-01,4.923e-01,3.873e-01,
     3.423e-01,2.736e-01,2.285e-01,1.909e-01,1.594e-01,
     1.332e-01,1.112e-01,9.292e-02,7.761e-02,6.482e-02,
     5.415e-02,4.523e-02,3.778e-02,3.155e-02,2.635e-02,
     2.201e-02,1.839e-02,1.633e-02,1.459e-02,1.300e-02,
     1.085e-02,9.045e-03,7.522e-03,6.242e-03,5.171e-03,
     4.276e-03,3.500e-03,2.883e-03};

  static float x2[74] =
    {3.402595e-01,4.515250e-01,5.477483e-01,6.392588e-01,7.263593e-01,
     8.493452e-01,9.638827e-01,1.070728e+00,1.202377e+00,1.351498e+00,
     1.510810e+00,1.673724e+00,1.853226e+00,2.094267e+00,2.313842e+00,
     2.480494e+00,2.590477e+00,2.658392e+00,2.696976e+00,2.727535e+00,
     2.760554e+00,2.773905e+00,2.795172e+00,2.815283e+00,2.838005e+00,
     2.866118e+00,2.885710e+00,2.927049e+00,2.948240e+00,2.977162e+00,
     3.022655e+00,3.126085e+00,3.149537e+00,3.161556e+00,3.200258e+00,
     3.213283e+00,3.244631e+00,3.350259e+00,3.385732e+00,3.473919e+00,
     3.539230e+00,3.675035e+00,3.802197e+00,3.905815e+00,4.230078e+00,
     4.604228e+00,4.928491e+00,5.427357e+00,5.851393e+00,6.350259e+00,
     6.742934e+00,7.018123e+00,7.452095e+00,7.912909e+00,8.235843e+00,
     8.745116e+00,9.285882e+00,9.860089e+00,1.046980e+01,1.111722e+01,
     1.180467e+01,1.253464e+01,1.330973e+01,1.413276e+01,1.500668e+01,
     1.561912e+01,1.658495e+01,1.761049e+01,1.869946e+01,1.985577e+01,
     2.066609e+01,2.194403e+01,2.330095e+01,2.377168e+01};

  static float y2[74] =
    {5.490e+00,4.132e+00,3.207e+00,2.542e+00,2.078e+00,
     1.603e+00,1.277e+00,1.051e+00,8.478e-01,6.811e-01,
     5.480e-01,4.477e-01,3.698e-01,2.975e-01,2.539e-01,
     2.403e-01,5.803e-01,3.927e+00,9.726e+00,1.677e+01,
     2.540e+01,2.860e+01,3.265e+01,3.481e+01,3.493e+01,
     3.185e+01,2.812e+01,1.859e+01,1.395e+01,8.742e+00,
     3.591e+00,5.121e-01,4.752e-01,4.889e-01,6.309e-01,
     7.035e-01,9.139e-01,1.749e+00,1.971e+00,2.271e+00,
     2.318e+00,2.167e+00,1.994e+00,1.949e+00,1.482e+00,
     1.122e+00,9.321e-01,7.163e-01,5.821e-01,4.618e-01,
     3.859e-01,3.422e-01,2.861e-01,2.388e-01,2.117e-01,
     1.770e-01,1.478e-01,1.235e-01,1.032e-01,8.617e-02,
     7.198e-02,6.012e-02,5.022e-02,4.195e-02,3.501e-02,
     3.105e-02,2.595e-02,2.168e-02,1.811e-02,1.511e-02,
     1.340e-02,1.120e-02,9.275e-03,8.735e-03};

  static float x3[137] =
    {2.786500e-01,3.399347e-01,3.899155e-01,4.386362e-01,4.861389e-01,
5.324637e-01,5.776494e-01,6.217329e-01,6.647498e-01,7.477191e-01,
8.268144e-01,9.387082e-01,1.043143e+00,1.140768e+00,1.261333e+00,
1.398281e+00,1.567849e+00,1.735126e+00,1.895730e+00,2.100175e+00,
2.596782e+00,2.675637e+00,2.749739e+00,2.761413e+00,2.776396e+00,
2.862673e+00,2.896634e+00,2.935243e+00,2.959163e+00,3.015136e+00,
3.035390e+00,3.070709e+00,3.100764e+00,3.113144e+00,3.121644e+00,
3.133281e+00,3.142073e+00,3.170715e+00,3.202994e+00,3.235477e+00,
3.235721e+00,3.264015e+00,3.267439e+00,3.267469e+00,3.268219e+00,
3.268763e+00,3.269204e+00,3.316539e+00,3.449462e+00,3.640679e+00,
3.746646e+00,3.747252e+00,3.790536e+00,3.803746e+00,3.803827e+00,
3.809353e+00,3.809418e+00,3.809483e+00,3.809547e+00,3.809612e+00,
3.809868e+00,3.809931e+00,3.811817e+00,3.811991e+00,3.820142e+00,
3.820438e+00,3.820511e+00,3.820548e+00,3.820620e+00,3.825448e+00,
3.825525e+00,3.825702e+00,3.825877e+00,3.825927e+00,3.826098e+00,
3.826147e+00,3.826195e+00,3.826339e+00,3.826387e+00,3.826458e+00,
3.826505e+00,3.826576e+00,3.826623e+00,3.826692e+00,3.826739e+00,
3.826808e+00,3.828168e+00,3.828449e+00,3.828527e+00,3.828567e+00,
3.828645e+00,3.828683e+00,3.828780e+00,3.828856e+00,3.828913e+00,
3.829007e+00,3.829156e+00,3.829339e+00,3.829483e+00,3.829677e+00,
3.829730e+00,3.829816e+00,3.829970e+00,3.830004e+00,3.830255e+00,
3.830610e+00,3.830642e+00,3.844206e+00,4.193412e+00,4.567562e+00,
4.866881e+00,5.365748e+00,5.789784e+00,6.288650e+00,6.677516e+00,
7.090431e+00,7.528877e+00,7.994438e+00,8.488785e+00,9.013707e+00,
9.571080e+00,1.016293e+01,1.079137e+01,1.145867e+01,1.216723e+01,
1.291961e+01,1.371851e+01,1.456682e+01,1.546758e+01,1.642404e+01,
1.743964e+01,1.851805e+01,1.966313e+01,2.087904e+01,2.217012e+01,
     2.307489e+01,2.354105e+01};

  static float y3[137] =
    {1.001e+01,7.347e+00,5.904e+00,4.818e+00,4.002e+00,
3.375e+00,2.886e+00,2.501e+00,2.196e+00,1.744e+00,
1.426e+00,1.097e+00,8.712e-01,7.141e-01,5.718e-01,
4.541e-01,3.456e-01,2.654e-01,2.087e-01,1.548e-01,
5.092e-02,2.074e-01,1.764e+00,2.294e+00,3.106e+00,
8.850e+00,9.905e+00,9.377e+00,8.284e+00,4.910e+00,
3.807e+00,2.338e+00,1.561e+00,1.350e+00,1.235e+00,
1.113e+00,1.043e+00,9.216e-01,9.121e-01,9.642e-01,
9.703e-01,1.042e+00,1.052e+00,1.045e+00,1.054e+00,
1.050e+00,1.055e+00,1.180e+00,1.509e+00,1.969e+00,
1.920e+00,1.932e+00,1.863e+00,1.847e+00,1.858e+00,
1.846e+00,1.834e+00,1.848e+00,1.837e+00,1.847e+00,
1.834e+00,1.848e+00,1.834e+00,1.843e+00,1.821e+00,
1.832e+00,1.819e+00,1.831e+00,1.817e+00,1.820e+00,
1.811e+00,1.824e+00,1.810e+00,1.824e+00,1.809e+00,
1.821e+00,1.810e+00,1.809e+00,1.825e+00,1.810e+00,
1.824e+00,1.810e+00,1.822e+00,1.811e+00,1.822e+00,
1.811e+00,1.804e+00,1.821e+00,1.804e+00,1.822e+00,
1.805e+00,1.822e+00,1.811e+00,1.804e+00,1.821e+00,
1.809e+00,1.818e+00,1.805e+00,1.817e+00,1.803e+00,
1.816e+00,1.808e+00,1.814e+00,1.804e+00,1.804e+00,
1.803e+00,1.814e+00,1.786e+00,1.359e+00,1.070e+00,
8.973e-01,6.942e-01,5.656e-01,4.515e-01,3.779e-01,
3.156e-01,2.636e-01,2.202e-01,1.839e-01,1.537e-01,
1.284e-01,1.072e-01,8.954e-02,7.478e-02,6.246e-02,
5.218e-02,4.358e-02,3.640e-02,3.041e-02,2.540e-02,
2.121e-02,1.772e-02,1.480e-02,1.236e-02,1.033e-02,
     9.105e-03,8.575e-03};

static float x4[73] =
  {2.554638e-01,2.654638e-01,3.167485e-01,3.667293e-01,4.154500e-01,
4.629527e-01,5.092775e-01,5.544632e-01,5.985467e-01,6.415636e-01,
6.835481e-01,7.245329e-01,7.645495e-01,8.036282e-01,8.417981e-01,
8.790870e-01,9.155220e-01,9.859325e-01,1.053225e+00,1.148712e+00,
1.238147e+00,1.322032e+00,1.400816e+00,1.498621e+00,1.610424e+00,
1.749947e+00,1.936033e+00,2.076988e+00,2.196659e+00,2.336023e+00,
2.702013e+00,2.885435e+00,3.048537e+00,3.071745e+00,3.108241e+00,
3.265464e+00,3.374574e+00,3.438390e+00,3.504203e+00,3.626373e+00,
3.821019e+00,4.170226e+00,4.444602e+00,4.743922e+00,5.143015e+00,
5.616938e+00,6.140747e+00,6.521160e+00,6.924410e+00,7.352588e+00,
7.807247e+00,8.125870e+00,8.628343e+00,8.980474e+00,9.535792e+00,
9.924958e+00,1.053868e+01,1.119036e+01,1.188233e+01,1.261710e+01,
1.313201e+01,1.394405e+01,1.480629e+01,1.541055e+01,1.636348e+01,
1.737534e+01,1.844977e+01,1.959064e+01,2.080206e+01,2.165102e+01,
   2.298982e+01,2.392805e+01,2.441144e+01};

static float y4[73] =
  {1.768e+01,1.588e+01,9.876e+00,6.472e+00,4.483e+00,
3.244e+00,2.438e+00,1.894e+00,1.511e+00,1.232e+00,
1.021e+00,8.566e-01,7.263e-01,6.219e-01,5.377e-01,
4.694e-01,4.146e-01,3.318e-01,2.732e-01,2.117e-01,
1.680e-01,1.359e-01,1.125e-01,9.081e-02,7.340e-02,
5.796e-02,4.228e-02,3.324e-02,2.774e-02,2.338e-02,
1.578e-02,1.919e-02,2.191e-01,3.001e-01,4.658e-01,
1.522e+00,1.970e+00,2.065e+00,2.120e+00,2.060e+00,
1.784e+00,1.395e+00,1.172e+00,9.830e-01,7.908e-01,
6.215e-01,4.849e-01,4.064e-01,3.398e-01,2.838e-01,
2.368e-01,2.100e-01,1.754e-01,1.556e-01,1.300e-01,
1.153e-01,9.637e-02,8.050e-02,6.724e-02,5.612e-02,
4.977e-02,4.160e-02,3.473e-02,3.079e-02,2.574e-02,
2.150e-02,1.796e-02,1.500e-02,1.252e-02,1.110e-02,
   9.273e-03,8.160e-03,7.684e-03};

static float x5[99] =
  {2.368543e-01,2.468543e-01,2.981390e-01,3.481198e-01,3.968405e-01,
4.443431e-01,4.906680e-01,5.358536e-01,5.799371e-01,6.229541e-01,
6.649385e-01,7.059233e-01,7.459400e-01,7.850186e-01,8.231885e-01,
8.604775e-01,8.969124e-01,9.325193e-01,9.673230e-01,1.001347e+00,
1.067150e+00,1.130102e+00,1.190366e+00,1.276049e+00,1.356486e+00,
1.432097e+00,1.503261e+00,1.570319e+00,1.653876e+00,1.749820e+00,
1.837351e+00,1.932618e+00,2.018543e+00,2.096308e+00,2.178049e+00,
2.251379e+00,2.308390e+00,2.360639e+00,2.408643e+00,2.445729e+00,
2.480407e+00,2.512881e+00,2.537397e+00,2.560705e+00,2.577440e+00,
2.593570e+00,2.609125e+00,2.619188e+00,2.629014e+00,2.638612e+00,
2.657148e+00,2.683404e+00,2.734600e+00,2.788572e+00,2.823644e+00,
2.859700e+00,2.887061e+00,2.948937e+00,2.991026e+00,3.027893e+00,
3.148699e+00,3.243544e+00,3.282326e+00,3.321252e+00,3.392355e+00,
3.440224e+00,3.580249e+00,3.697104e+00,3.977013e+00,4.176560e+00,
4.425993e+00,4.675426e+00,5.049575e+00,5.423725e+00,5.922591e+00,
6.373051e+00,6.767137e+00,7.185589e+00,7.629927e+00,8.101733e+00,
8.602715e+00,9.134674e+00,9.699532e+00,1.029932e+01,1.093619e+01,
1.161245e+01,1.233053e+01,1.309300e+01,1.390263e+01,1.476232e+01,
1.567517e+01,1.664445e+01,1.767369e+01,1.876657e+01,1.992703e+01,
2.115924e+01,2.246767e+01,2.385698e+01,2.433893e+01};

static float y5[99] =
  {1.515e+01,1.332e+01,7.761e+00,4.699e+00,3.033e+00,
2.060e+00,1.459e+00,1.073e+00,8.141e-01,6.340e-01,
5.036e-01,4.062e-01,3.315e-01,2.734e-01,2.277e-01,
1.916e-01,1.628e-01,1.397e-01,1.212e-01,1.063e-01,
8.346e-02,6.672e-02,5.426e-02,4.060e-02,3.094e-02,
2.416e-02,1.942e-02,1.608e-02,1.302e-02,1.055e-02,
9.007e-03,7.997e-03,7.655e-03,7.857e-03,8.704e-03,
1.030e-02,1.282e-02,1.839e-02,3.263e-02,5.951e-02,
1.120e-01,2.062e-01,3.248e-01,4.937e-01,6.589e-01,
8.606e-01,1.100e+00,1.281e+00,1.477e+00,1.690e+00,
2.155e+00,2.928e+00,4.664e+00,6.300e+00,6.934e+00,
7.106e+00,6.927e+00,5.884e+00,5.026e+00,4.365e+00,
3.022e+00,2.350e+00,2.134e+00,1.973e+00,1.836e+00,
1.837e+00,1.959e+00,1.927e+00,1.606e+00,1.413e+00,
1.205e+00,1.034e+00,8.367e-01,6.890e-01,5.415e-01,
4.387e-01,3.671e-01,3.067e-01,2.562e-01,2.140e-01,
1.787e-01,1.493e-01,1.247e-01,1.042e-01,8.699e-02,
7.266e-02,6.069e-02,5.070e-02,4.234e-02,3.537e-02,
2.954e-02,2.468e-02,2.061e-02,1.721e-02,1.438e-02,
1.201e-02,1.002e-02,8.257e-03,7.776e-03};

static float x6[88] =
  {1.273008e-01,1.373008e-01,1.885855e-01,2.385663e-01,2.872870e-01,
3.347897e-01,3.811145e-01,4.263001e-01,4.703837e-01,5.134006e-01,
5.553851e-01,5.963699e-01,6.363865e-01,7.136350e-01,8.229658e-01,
9.575967e-01,1.051007e+00,1.138539e+00,1.246932e+00,1.621784e+00,
1.744381e+00,1.867116e+00,2.259368e+00,2.409574e+00,2.484017e+00,
2.529059e+00,2.552097e+00,2.569598e+00,2.590391e+00,2.610063e+00,
2.632300e+00,2.646352e+00,2.663107e+00,2.699984e+00,2.824195e+00,
2.860904e+00,2.900980e+00,2.922380e+00,2.981317e+00,3.011278e+00,
3.066633e+00,3.111874e+00,3.137301e+00,3.153501e+00,3.172773e+00,
3.198065e+00,3.231115e+00,3.266581e+00,3.305449e+00,3.343402e+00,
3.465366e+00,3.548458e+00,3.651904e+00,3.717800e+00,3.817573e+00,
3.867460e+00,3.942290e+00,4.017119e+00,4.166779e+00,4.590816e+00,
5.089682e+00,5.613491e+00,6.012584e+00,6.387768e+00,6.782768e+00,
7.059574e+00,7.347681e+00,7.802036e+00,8.284487e+00,8.796775e+00,
9.340734e+00,9.918336e+00,1.053165e+01,1.118289e+01,1.163927e+01,
1.235901e+01,1.312324e+01,1.393474e+01,1.479641e+01,1.571138e+01,
1.668291e+01,1.771451e+01,1.880992e+01,1.997305e+01,2.120813e+01,
   2.207365e+01,2.391209e+01,2.439514e+01};

static float y6[88] =
  {8.595e+00,7.946e+00,5.374e+00,3.805e+00,2.870e+00,
2.276e+00,1.862e+00,1.546e+00,1.297e+00,1.099e+00,
9.433e-01,8.232e-01,7.317e-01,6.024e-01,4.723e-01,
3.471e-01,2.817e-01,2.386e-01,2.035e-01,1.204e-01,
1.015e-01,8.974e-02,6.804e-02,7.774e-02,2.494e-01,
5.233e-01,6.860e-01,7.959e-01,8.902e-01,9.287e-01,
9.069e-01,8.607e-01,7.808e-01,5.668e-01,1.035e+00,
1.893e+00,3.027e+00,3.563e+00,4.167e+00,3.893e+00,
2.782e+00,1.829e+00,1.404e+00,1.186e+00,9.767e-01,
7.812e-01,6.440e-01,6.254e-01,7.322e-01,9.267e-01,
1.549e+00,1.676e+00,1.528e+00,1.302e+00,9.819e-01,
8.800e-01,7.895e-01,7.406e-01,6.833e-01,5.530e-01,
4.255e-01,3.258e-01,2.676e-01,2.245e-01,1.877e-01,
1.663e-01,1.476e-01,1.234e-01,1.031e-01,8.613e-02,
7.193e-02,6.008e-02,5.018e-02,4.189e-02,3.714e-02,
3.105e-02,2.594e-02,2.166e-02,1.810e-02,1.512e-02,
1.263e-02,1.055e-02,8.809e-03,7.358e-03,6.141e-03,
   5.446e-03,4.249e-03,4.001e-03};

static float x7[94] =
  {1.115277e-01,1.215277e-01,1.728124e-01,2.227932e-01,2.715139e-01,
3.190165e-01,3.653414e-01,4.105270e-01,4.546106e-01,4.976275e-01,
5.396120e-01,5.805968e-01,6.206134e-01,6.596921e-01,7.351509e-01,
8.419964e-01,9.418236e-01,1.035234e+00,1.122766e+00,1.204903e+00,
1.354685e+00,1.606011e+00,1.712025e+00,1.807291e+00,1.933052e+00,
2.155188e+00,2.582617e+00,2.623627e+00,2.750698e+00,2.766011e+00,
2.774339e+00,2.780395e+00,2.786294e+00,2.793923e+00,2.803100e+00,
2.813611e+00,2.826836e+00,2.842202e+00,2.860445e+00,2.878162e+00,
2.955878e+00,3.009063e+00,3.063789e+00,3.121528e+00,3.133745e+00,
3.149417e+00,3.168071e+00,3.195925e+00,3.227640e+00,3.259036e+00,
3.294454e+00,3.337733e+00,3.377373e+00,3.394637e+00,3.484143e+00,
3.509338e+00,3.530465e+00,3.598689e+00,3.650527e+00,3.702027e+00,
3.726970e+00,3.751913e+00,3.776857e+00,3.801800e+00,3.826743e+00,
4.001346e+00,4.400439e+00,5.148739e+00,5.822208e+00,6.500059e+00,
6.902002e+00,7.328796e+00,7.781984e+00,8.263194e+00,8.774166e+00,
9.316728e+00,9.892844e+00,1.050459e+01,1.115415e+01,1.184389e+01,
1.257627e+01,1.308952e+01,1.389892e+01,1.475839e+01,1.536069e+01,
1.631053e+01,1.731912e+01,1.839008e+01,1.952725e+01,2.073474e+01,
   2.158095e+01,2.291545e+01,2.433244e+01,2.482401e+01};

static float y7[94] =
  {1.733e+01,1.515e+01,8.514e+00,5.344e+00,3.697e+00,
2.746e+00,2.137e+00,1.709e+00,1.391e+00,1.148e+00,
9.623e-01,8.212e-01,7.138e-01,6.321e-01,5.147e-01,
3.935e-01,3.041e-01,2.395e-01,1.964e-01,1.689e-01,
1.345e-01,8.574e-02,6.976e-02,5.957e-02,5.049e-02,
3.750e-02,6.211e-02,1.450e-01,5.142e-01,5.897e-01,
6.475e-01,6.996e-01,7.600e-01,8.547e-01,9.974e-01,
1.206e+00,1.548e+00,2.070e+00,2.874e+00,3.832e+00,
8.468e+00,9.345e+00,7.407e+00,4.268e+00,3.679e+00,
3.002e+00,2.324e+00,1.566e+00,1.020e+00,7.356e-01,
6.397e-01,7.879e-01,1.163e+00,1.392e+00,2.817e+00,
3.110e+00,3.259e+00,3.047e+00,2.369e+00,1.614e+00,
1.299e+00,1.035e+00,8.254e-01,6.662e-01,5.499e-01,
3.192e-01,3.015e-01,2.244e-01,1.662e-01,1.225e-01,
1.023e-01,8.550e-02,7.142e-02,5.966e-02,4.983e-02,
4.162e-02,3.476e-02,2.903e-02,2.425e-02,2.026e-02,
1.691e-02,1.499e-02,1.253e-02,1.046e-02,9.280e-03,
7.757e-03,6.479e-03,5.412e-03,4.520e-03,3.773e-03,
   3.346e-03,2.797e-03,2.315e-03,2.180e-03};

static float x8[85] =
  {1.058714e-01,1.158714e-01,1.671561e-01,2.171369e-01,2.658576e-01,
3.133603e-01,3.596851e-01,4.048707e-01,4.489543e-01,4.919712e-01,
5.339557e-01,5.749405e-01,6.149571e-01,6.540358e-01,6.922056e-01,
7.294946e-01,7.659296e-01,8.363401e-01,9.036329e-01,9.679893e-01,
1.029578e+00,1.088555e+00,1.172439e+00,1.301114e+00,1.417420e+00,
1.522893e+00,1.618838e+00,1.706368e+00,1.831252e+00,2.221256e+00,
2.342671e+00,2.451900e+00,2.588634e+00,2.867632e+00,2.885191e+00,
2.920436e+00,3.024974e+00,3.096068e+00,3.115871e+00,3.143760e+00,
3.186914e+00,3.212807e+00,3.242355e+00,3.276684e+00,3.319898e+00,
3.368408e+00,3.393431e+00,3.485893e+00,3.509698e+00,3.599995e+00,
3.661427e+00,3.721314e+00,3.746257e+00,3.771200e+00,3.796144e+00,
3.821087e+00,3.995690e+00,4.843763e+00,5.292742e+00,5.766665e+00,
6.239422e+00,6.494054e+00,6.895624e+00,7.322024e+00,7.774794e+00,
8.255559e+00,8.766059e+00,9.308119e+00,9.883704e+00,1.049488e+01,
1.114384e+01,1.183294e+01,1.256465e+01,1.334160e+01,1.388608e+01,
1.474475e+01,1.565652e+01,1.629547e+01,1.730312e+01,1.837308e+01,
   1.950922e+01,2.071558e+01,2.199657e+01,2.289427e+01,2.335675e+01};

static float y8[85] =
  {3.506e+01,2.866e+01,1.254e+01,6.503e+00,3.878e+00,
2.535e+00,1.759e+00,1.272e+00,9.499e-01,7.305e-01,
5.777e-01,4.688e-01,3.891e-01,3.288e-01,2.815e-01,
2.434e-01,2.122e-01,1.635e-01,1.281e-01,1.030e-01,
8.514e-02,7.250e-02,5.935e-02,4.454e-02,3.392e-02,
2.638e-02,2.138e-02,1.822e-02,1.520e-02,8.348e-03,
6.787e-03,5.852e-03,5.151e-03,2.245e-01,3.136e-01,
5.519e-01,1.344e+00,1.398e+00,1.330e+00,1.198e+00,
9.681e-01,8.432e-01,7.308e-01,6.538e-01,6.512e-01,
7.727e-01,8.782e-01,1.350e+00,1.443e+00,1.487e+00,
1.262e+00,9.803e-01,8.724e-01,7.772e-01,6.966e-01,
6.306e-01,4.379e-01,2.895e-01,2.320e-01,1.845e-01,
1.477e-01,1.312e-01,1.097e-01,9.162e-02,7.653e-02,
6.392e-02,5.339e-02,4.460e-02,3.725e-02,3.111e-02,
2.599e-02,2.171e-02,1.813e-02,1.513e-02,1.342e-02,
1.122e-02,9.365e-03,8.304e-03,6.942e-03,5.799e-03,
   4.844e-03,4.046e-03,3.376e-03,2.970e-03,2.797e-03};

static float x9[121] =
  {1.012440e-01,1.112440e-01,1.625287e-01,2.125095e-01,2.612302e-01,
3.087329e-01,3.550577e-01,4.002433e-01,4.443269e-01,4.873438e-01,
5.293283e-01,5.703131e-01,6.103297e-01,6.494084e-01,6.875782e-01,
7.248672e-01,7.613022e-01,7.969090e-01,8.317127e-01,8.657372e-01,
8.990055e-01,9.315399e-01,9.633619e-01,9.944921e-01,1.054756e+00,
1.140438e+00,1.246596e+00,1.296486e+00,1.344401e+00,1.390443e+00,
1.434709e+00,1.477288e+00,1.518265e+00,1.557720e+00,1.614210e+00,
1.781813e+00,1.869208e+00,1.972938e+00,2.019997e+00,2.064196e+00,
2.095607e+00,2.135336e+00,2.172779e+00,2.225029e+00,2.324267e+00,
2.419376e+00,2.457960e+00,2.483577e+00,2.543541e+00,2.564335e+00,
2.584007e+00,2.602636e+00,2.630453e+00,2.646695e+00,2.656048e+00,
2.668086e+00,2.685267e+00,2.704078e+00,2.724090e+00,2.744889e+00,
2.766092e+00,2.783640e+00,2.799882e+00,2.814946e+00,2.828943e+00,
2.841971e+00,2.854117e+00,2.873771e+00,2.960660e+00,2.998780e+00,
3.023287e+00,3.076842e+00,3.111244e+00,3.123461e+00,3.135279e+00,
3.150446e+00,3.164974e+00,3.182286e+00,3.198718e+00,3.217357e+00,
3.240525e+00,3.267049e+00,3.295735e+00,3.323461e+00,3.348192e+00,
3.365442e+00,3.518483e+00,3.602919e+00,3.666800e+00,3.741630e+00,
3.791516e+00,3.966119e+00,4.190609e+00,4.864078e+00,5.263171e+00,
5.836868e+00,6.234701e+00,6.489141e+00,6.890408e+00,7.171609e+00,
7.615078e+00,8.085968e+00,8.585976e+00,9.116907e+00,9.680663e+00,
1.027928e+01,1.091492e+01,1.158986e+01,1.230654e+01,1.280877e+01,
1.360082e+01,1.444185e+01,1.533489e+01,1.628314e+01,1.729002e+01,
1.835918e+01,1.949445e+01,2.069991e+01,2.197993e+01,2.287695e+01,
   2.333908e+01};

static float y9[121] =
  {2.549e+01,1.849e+01,5.272e+00,1.939e+00,8.911e-01,
4.683e-01,2.682e-01,1.638e-01,1.059e-01,7.225e-02,
5.175e-02,3.853e-02,2.949e-02,2.295e-02,1.802e-02,
1.422e-02,1.128e-02,9.013e-03,7.280e-03,5.967e-03,
4.976e-03,4.230e-03,3.665e-03,3.232e-03,2.603e-03,
1.939e-03,1.260e-03,9.922e-04,7.782e-04,6.145e-04,
4.942e-04,4.086e-04,3.492e-04,3.085e-04,2.698e-04,
1.982e-04,1.539e-04,9.720e-05,7.525e-05,5.859e-05,
4.919e-05,3.994e-05,3.342e-05,2.684e-05,2.750e-05,
8.328e-04,2.616e-03,4.663e-03,1.066e-02,1.212e-02,
1.275e-02,1.265e-02,1.142e-02,1.050e-02,1.008e-02,
9.909e-03,1.107e-02,1.615e-02,3.011e-02,6.198e-02,
1.257e-01,2.148e-01,3.370e-01,4.917e-01,6.752e-01,
8.812e-01,1.102e+00,1.509e+00,3.141e+00,3.213e+00,
3.000e+00,2.123e+00,1.512e+00,1.317e+00,1.145e+00,
9.494e-01,7.889e-01,6.312e-01,5.132e-01,4.131e-01,
3.328e-01,2.931e-01,3.051e-01,3.648e-01,4.522e-01,
5.286e-01,1.206e+00,1.210e+00,1.074e+00,8.935e-01,
8.031e-01,6.796e-01,6.318e-01,4.550e-01,3.682e-01,
2.756e-01,2.272e-01,2.018e-01,1.686e-01,1.495e-01,
1.250e-01,1.044e-01,8.723e-02,7.286e-02,6.085e-02,
5.083e-02,4.246e-02,3.546e-02,2.960e-02,2.625e-02,
2.194e-02,1.833e-02,1.531e-02,1.279e-02,1.068e-02,
8.921e-03,7.452e-03,6.224e-03,5.194e-03,4.569e-03,
   4.303e-03};

static float x10[166] =
  {1.012127e-01,1.112127e-01,1.624974e-01,2.124782e-01,2.611989e-01,
3.087016e-01,3.550264e-01,4.002120e-01,4.442956e-01,4.873125e-01,
5.292970e-01,5.702818e-01,6.102984e-01,6.493771e-01,6.875469e-01,
7.248359e-01,7.612709e-01,7.968777e-01,8.316814e-01,8.657059e-01,
8.989742e-01,9.315086e-01,9.633306e-01,9.944608e-01,1.054725e+00,
1.167781e+00,1.246564e+00,1.296455e+00,1.344370e+00,1.367619e+00,
1.390412e+00,1.412761e+00,1.434677e+00,1.456172e+00,1.477257e+00,
1.518234e+00,1.557689e+00,1.614179e+00,1.750593e+00,1.811911e+00,
1.882901e+00,1.960666e+00,1.996809e+00,2.019965e+00,2.042408e+00,
2.053370e+00,2.064165e+00,2.074795e+00,2.085265e+00,2.095576e+00,
2.105733e+00,2.115738e+00,2.125594e+00,2.135305e+00,2.144873e+00,
2.154301e+00,2.163592e+00,2.172748e+00,2.190666e+00,2.208077e+00,
2.233280e+00,2.273002e+00,2.317209e+00,2.358009e+00,2.395743e+00,
2.425063e+00,2.452617e+00,2.478545e+00,2.502970e+00,2.521507e+00,
2.539209e+00,2.556125e+00,2.572302e+00,2.587782e+00,2.598959e+00,
2.609781e+00,2.620264e+00,2.630421e+00,2.640267e+00,2.652931e+00,
2.659072e+00,2.665091e+00,2.673896e+00,2.682443e+00,2.688002e+00,
2.693454e+00,2.698802e+00,2.704047e+00,2.709193e+00,2.714242e+00,
2.719196e+00,2.724059e+00,2.728831e+00,2.733516e+00,2.738115e+00,
2.742631e+00,2.747065e+00,2.751419e+00,2.757806e+00,2.764024e+00,
2.768079e+00,2.774030e+00,2.779826e+00,2.787326e+00,2.796348e+00,
2.806685e+00,2.819694e+00,2.833357e+00,2.848791e+00,2.862974e+00,
2.874892e+00,2.928118e+00,2.980122e+00,3.020040e+00,3.068018e+00,
3.111213e+00,3.131352e+00,3.142914e+00,3.157756e+00,3.175439e+00,
3.195468e+00,3.217325e+00,3.240493e+00,3.267018e+00,3.295704e+00,
3.327418e+00,3.353488e+00,3.371920e+00,3.507610e+00,3.590734e+00,
3.638678e+00,3.716655e+00,3.766542e+00,3.816428e+00,4.040918e+00,
4.340238e+00,5.188310e+00,5.762006e+00,6.111213e+00,6.360615e+00,
6.620198e+00,7.029565e+00,7.464253e+00,7.768871e+00,8.085926e+00,
8.585931e+00,9.116860e+00,9.680613e+00,1.027923e+01,1.069873e+01,
1.136030e+01,1.206279e+01,1.280871e+01,1.333144e+01,1.415581e+01,
1.473352e+01,1.564459e+01,1.628305e+01,1.728993e+01,1.835909e+01,
1.949435e+01,2.028993e+01,2.154459e+01,2.287683e+01,2.381046e+01,
   2.429144e+01};

static float y10[166] =
  {2.504e+01,1.813e+01,5.134e+00,1.875e+00,8.556e-01,
4.465e-01,2.538e-01,1.538e-01,9.872e-02,6.696e-02,
4.773e-02,3.539e-02,2.696e-02,2.086e-02,1.626e-02,
1.272e-02,9.989e-03,7.895e-03,6.309e-03,5.120e-03,
4.237e-03,3.580e-03,3.090e-03,2.720e-03,2.188e-03,
1.449e-03,1.007e-03,7.669e-04,5.759e-04,4.988e-04,
4.332e-04,3.783e-04,3.328e-04,2.956e-04,2.653e-04,
2.216e-04,1.940e-04,1.706e-04,1.381e-04,1.176e-04,
8.671e-05,5.128e-05,3.711e-05,2.937e-05,2.301e-05,
2.032e-05,1.795e-05,1.586e-05,1.406e-05,1.250e-05,
1.119e-05,1.009e-05,9.187e-06,8.465e-06,7.906e-06,
7.492e-06,7.209e-06,7.042e-06,7.008e-06,7.301e-06,
8.208e-06,1.061e-05,1.461e-05,1.996e-05,2.875e-05,
4.607e-05,9.914e-05,2.606e-04,6.821e-04,1.366e-03,
2.519e-03,4.282e-03,6.754e-03,9.960e-03,1.282e-02,
1.614e-02,1.973e-02,2.362e-02,2.781e-02,3.399e-02,
3.744e-02,4.123e-02,4.780e-02,5.588e-02,6.244e-02,
7.020e-02,7.947e-02,9.055e-02,1.038e-01,1.196e-01,
1.385e-01,1.608e-01,1.870e-01,2.177e-01,2.535e-01,
2.948e-01,3.422e-01,3.962e-01,4.910e-01,6.039e-01,
6.901e-01,8.368e-01,1.006e+00,1.268e+00,1.658e+00,
2.221e+00,3.131e+00,4.360e+00,6.110e+00,8.055e+00,
9.914e+00,1.928e+01,2.515e+01,2.443e+01,1.853e+01,
1.179e+01,8.992e+00,7.578e+00,5.990e+00,4.431e+00,
3.076e+00,2.026e+00,1.300e+00,8.265e-01,6.061e-01,
5.910e-01,6.970e-01,8.170e-01,1.940e+00,1.982e+00,
1.732e+00,1.228e+00,9.816e-01,8.226e-01,6.361e-01,
5.830e-01,3.885e-01,2.890e-01,2.428e-01,2.155e-01,
1.912e-01,1.599e-01,1.335e-01,1.183e-01,1.050e-01,
8.776e-02,7.331e-02,6.123e-02,5.110e-02,4.532e-02,
3.789e-02,3.165e-02,2.642e-02,2.342e-02,1.957e-02,
1.735e-02,1.450e-02,1.286e-02,1.075e-02,8.977e-03,
7.493e-03,6.645e-03,5.555e-03,4.635e-03,4.078e-03,
   3.841e-03};

static float x11[128] =
  {9.998041e-02,1.099804e-01,1.612651e-01,2.112459e-01,2.599666e-01,
3.074693e-01,3.537941e-01,3.989798e-01,4.430633e-01,4.860802e-01,
5.280647e-01,5.690495e-01,6.090661e-01,6.481448e-01,6.863146e-01,
7.236036e-01,7.600386e-01,7.956454e-01,8.304491e-01,8.644736e-01,
8.977419e-01,9.302764e-01,9.620983e-01,9.932285e-01,1.023687e+00,
1.082664e+00,1.139175e+00,1.219612e+00,1.319421e+00,1.411529e+00,
1.476024e+00,1.536915e+00,1.594464e+00,1.666410e+00,1.749360e+00,
1.839795e+00,1.934354e+00,2.018733e+00,2.094344e+00,2.162360e+00,
2.223765e+00,2.279390e+00,2.329937e+00,2.369679e+00,2.406460e+00,
2.435056e+00,2.456697e+00,2.472251e+00,2.487256e+00,2.496967e+00,
2.506453e+00,2.515721e+00,2.524776e+00,2.533626e+00,2.546530e+00,
2.559005e+00,2.575004e+00,2.594041e+00,2.657840e+00,2.732283e+00,
2.748019e+00,2.754464e+00,2.762792e+00,2.770831e+00,2.778594e+00,
2.782376e+00,2.787929e+00,2.793341e+00,2.798619e+00,2.803765e+00,
2.808785e+00,2.815289e+00,2.821584e+00,2.827679e+00,2.835031e+00,
2.842099e+00,2.854152e+00,2.881500e+00,2.968857e+00,3.006715e+00,
3.062237e+00,3.109980e+00,3.134016e+00,3.149183e+00,3.167246e+00,
3.187698e+00,3.210006e+00,3.239261e+00,3.273261e+00,3.314007e+00,
3.355733e+00,3.499156e+00,3.557797e+00,3.598992e+00,3.638630e+00,
3.715423e+00,3.740366e+00,3.765309e+00,3.790253e+00,3.840139e+00,
3.964856e+00,4.388892e+00,4.738098e+00,5.611114e+00,6.233411e+00,
6.618862e+00,7.028146e+00,7.462748e+00,7.924217e+00,8.414222e+00,
8.934525e+00,9.487006e+00,1.007365e+01,1.069657e+01,1.135801e+01,
1.206035e+01,1.280612e+01,1.359801e+01,1.443886e+01,1.533171e+01,
1.627977e+01,1.728645e+01,1.835538e+01,1.949042e+01,2.069562e+01,
   2.197539e+01,2.287222e+01,2.333424e+01};

static float y11[128] =
  {3.409e+01,2.694e+01,1.043e+01,4.918e+00,2.721e+00,
1.671e+00,1.097e+00,7.540e-01,5.368e-01,3.947e-01,
2.993e-01,2.338e-01,1.872e-01,1.530e-01,1.270e-01,
1.064e-01,8.976e-02,7.607e-02,6.472e-02,5.531e-02,
4.753e-02,4.111e-02,3.584e-02,3.152e-02,2.801e-02,
2.267e-02,1.886e-02,1.481e-02,1.096e-02,8.133e-03,
6.561e-03,5.389e-03,4.534e-03,3.750e-03,3.141e-03,
2.738e-03,2.538e-03,2.550e-03,2.751e-03,3.134e-03,
3.706e-03,4.538e-03,6.030e-03,8.959e-03,1.525e-02,
2.417e-02,3.399e-02,4.303e-02,5.377e-02,6.207e-02,
7.149e-02,8.221e-02,9.447e-02,1.085e-01,1.332e-01,
1.626e-01,2.094e-01,2.783e-01,5.547e-01,7.817e-01,
8.840e-01,9.470e-01,1.054e+00,1.189e+00,1.358e+00,
1.456e+00,1.619e+00,1.803e+00,2.009e+00,2.236e+00,
2.485e+00,2.849e+00,3.249e+00,3.682e+00,4.268e+00,
4.895e+00,6.109e+00,9.446e+00,1.946e+01,1.972e+01,
1.503e+01,9.311e+00,6.799e+00,5.456e+00,4.122e+00,
2.948e+00,2.024e+00,1.259e+00,8.121e-01,6.537e-01,
7.279e-01,1.526e+00,1.626e+00,1.519e+00,1.309e+00,
8.110e-01,6.703e-01,5.513e-01,4.552e-01,3.258e-01,
2.234e-01,2.291e-01,2.114e-01,1.479e-01,1.119e-01,
9.366e-02,7.824e-02,6.535e-02,5.459e-02,4.559e-02,
3.808e-02,3.181e-02,2.657e-02,2.219e-02,1.854e-02,
1.548e-02,1.293e-02,1.080e-02,9.022e-03,7.536e-03,
6.295e-03,5.258e-03,4.392e-03,3.668e-03,3.064e-03,
   2.556e-03,2.249e-03,2.118e-03};

  static double xedge[26] = {1.807139768,0.350424961,0.291908259,0.266307794,
                            0.247643857,0.137363272,0.122527501,0.116151073,
                            0.111257717,0.111226546,0.110275196,0.073015780,
                            0.06716441,0.064641895,0.062569309,0.062551313,
                            0.062129797,0.045232358,0.042348006,0.041097792,
                            0.040036678,0.040026303,0.02779909,0.020421459,
                            0.015633759,0.0123517};

  static int jp[11] = {5,5,5,5,5,5,5,5,5,5,5};

   Ryd = nu/3.289841960361e+15;
   tkev = 8.617e-05*T;

   xsect = 0.0;

   /* Wavelengths tabulated below are in vacuo & air, except for 
      lambda < 2800A */

   /* 1s2 1S    504.259 */

   if(Ryd >= xedge[0]) {
      ryd = Ryd+x1[0]-xedge[0];
      search(x1-1,48,ryd,&jp[0]);
      j = jp[0];
      xsect += 1.0*(y1[j-1] + (y1[j]-y1[j-1])*(ryd-x1[j-1])/
                         (x1[j]-x1[j-1]));
   }

   /* 1s2s 3S   2600.463 */

   if(Ryd >= xedge[1]) {
    ryd = Ryd+x2[0]-xedge[1];
    search(x2-1,74,ryd,&jp[1]);
    j = jp[1];
    xsect += (y2[j-1] + (y2[j]-y2[j-1])*(ryd-x2[j-1])/
                         (x2[j]-x2[j-1]))*3.0*exp(-19.8196134/tkev);
   }

   /* 1s2s 1S   3121.758  3120.853*/

   if(Ryd >= xedge[2]) {
    ryd = Ryd+x3[0]-xedge[2];
    search(x3-1,137,ryd,&jp[2]);
    j = jp[2];
    xsect += (y3[j-1] + (y3[j]-y3[j-1])*(ryd-x3[j-1])/
                         (x3[j]-x3[j-1]))*1.0*exp(-20.6157736/tkev);
   }

   /* 1s2p 3Po   3421.856  3420.875 */

   if(Ryd >= xedge[3]) {
    ryd = Ryd+x4[0]-xedge[3];
    search(x4-1,73,ryd,&jp[3]);
    j = jp[3];
    xsect += (y4[j-1] + (y4[j]-y4[j-1])*(ryd-x4[j-1])/
                         (x4[j]-x4[j-1]))*9.0*exp(-20.9640857/tkev);
   }

   /* 1s2p 1Po   3679.748  3678.701  */

   if(Ryd >= xedge[4]) {
    ryd = Ryd+x5[0]-xedge[4];
    search(x5-1,99,ryd,&jp[4]);
    j = jp[4];
    xsect += (y5[j-1] + (y5[j]-y5[j-1])*(ryd-x5[j-1])/
                         (x5[j]-x5[j-1]))*3.0*exp(-21.2180214/tkev);
   }

   /* 1s3s 3S    6633.993  6632.162 */

   if(Ryd >= xedge[5]) {
    ryd = Ryd+x6[0]-xedge[5];
    search(x6-1,88,ryd,&jp[5]);
    j = jp[5];
    xsect += (y6[j-1] + (y6[j]-y6[j-1])*(ryd-x6[j-1])/
                         (x6[j]-x6[j-1]))*3.0*exp(-22.7184651/tkev);
   }

   /* 1s3s 1S   7437.245  7435.197  */

   if(Ryd >= xedge[6]) {
    ryd = Ryd+x7[0]-xedge[6];
    search(x7-1,94,ryd,&jp[6]);
    j = jp[6];
    xsect += (y7[j-1] + (y7[j]-y7[j-1])*(ryd-x7[j-1])/
                         (x7[j]-x7[j-1]))*1.0*exp(-22.9203161/tkev);
   }

   /* 1s3p 3Po   7845.533  7843.375  */

   if(Ryd >= xedge[7]) {
    ryd = Ryd+x8[0]-xedge[7];
    search(x8-1,85,ryd,&jp[7]);
    j = jp[7];
    xsect += (y8[j-1] + (y8[j]-y8[j-1])*(ryd-x8[j-1])/
                         (x8[j]-x8[j-1]))*9.0*exp(-23.0070718/tkev);
   }

   /* 1s3d 3D   8190.596  8188.345  */

   if(Ryd >= xedge[8]) {
    ryd = Ryd+x9[0]-xedge[8];
    search(x9-1,121,ryd,&jp[8]);
    j = jp[8];
    xsect += (y9[j-1] + (y9[j]-y9[j-1])*(ryd-x9[j-1])/
                         (x9[j]-x9[j-1]))*15.0*exp(-23.0736493/tkev);
   }

   /* 1s3d 1D   8192.892  8190.640  */

   if(Ryd >= xedge[9]) {
    ryd = Ryd+x10[0]-xedge[9];
    search(x10-1,166,ryd,&jp[9]);
    j = jp[9];
    xsect += (y10[j-1] + (y10[j]-y10[j-1])*(ryd-x10[j-1])/
                         (x10[j]-x10[j-1]))*5.0*exp(-23.0740734/tkev);
   } 

   /* 1s3p 1Po  8263.572  8261.301  */

   if(Ryd >= xedge[10]) {
    ryd = Ryd+x11[0]-xedge[10];
    search(x11-1,128,ryd,&jp[10]);
    j = jp[10]; 
    xsect += (y11[j-1] + (y11[j]-y11[j-1])*(ryd-x11[j-1])/
                         (x11[j]-x11[j-1]))*3.0*exp(-23.0870172/tkev);
   } 

   /* 1s5s 3S   12480.412 12476.999 
            Approximate polynomial fits hereafter*/

   if(Ryd >= xedge[11]) {
    ryd = Ryd+0.06303418-xedge[11];
    lnryd = log(ryd);
    xsect += exp(-2.09841 - 2.05676*lnryd - 0.13547*lnryd*lnryd)*3.0*
             exp(-23.5939573/tkev);
   } 

   /* 1s5s 1S   13567.707 13563.998  */

   if(Ryd >= xedge[12]) {
    ryd = Ryd+5.679301e-02-xedge[12];
    lnryd = log(ryd);
    xsect += exp(-2.23048 - 2.20139*lnryd - 0.091531*lnryd*lnryd)*1.0*
             exp(-23.6735693/tkev);
   }

   /* 1s4p 3Po  14097.159 14093.306  No data in OP! */

   /* 1s4d 3D   14564.122 14560.142  
             This one is important -- include OP data */

   if(Ryd >= xedge[14]) {
    ryd = Ryd+5.258232e-02-xedge[14];
    lnryd = log(ryd);
    xsect += exp(-6.3211 - 4.40533*lnryd - 0.297976*lnryd*lnryd)*15.0*
             exp(-23.7360888/tkev);
   }

   /* 1s4d 1D   14568.312 14564.331  */

   if(Ryd >= xedge[15]) {
    ryd = Ryd+5.256399e-02-xedge[15];
    lnryd = log(ryd);
    xsect += exp(-6.49565 - 4.53567*lnryd - 0.326158*lnryd*lnryd)*5.0*
             exp(-23.7363336/tkev);
   }

   /* 1s4p 1Po   14667.150 14663.142  */

   if(Ryd >= xedge[16]) {
    ryd = Ryd+5.202521e-02-xedge[16];
    lnryd = log(ryd);
    xsect += exp(-4.28176 - 3.59158*lnryd - 0.256019*lnryd*lnryd)*3.0*
             exp(-23.7420687/tkev);
   }

   /* 1s5s 3S   20146.353 20140.855  */

   if(Ryd >= xedge[17]) {
    ryd = Ryd+3.521635e-02-xedge[17];
    lnryd = log(ryd);
    xsect += exp(-2.81984 - 2.03799*lnryd - 0.0953245*lnryd*lnryd)*3.0*
             exp(-23.9719700/tkev);
   }

   /* 1s5s 1S   21518.535 21512.664  */

   if(Ryd >= xedge[18]) {
    ryd = Ryd+3.214397e-02-xedge[18];
    lnryd = log(ryd);
    xsect += exp(-2.93 - 2.19572*lnryd - 0.062713*lnryd*lnryd)*1.0*
             exp(-24.0112136/tkev);
   }

   /* 1s5p 3Po   22173.139 22167.089  No data! */

   /* 1s5d 3D   22760.806 22754.596  */

   if(Ryd >= xedge[20]) {
    ryd = Ryd+3.003342e-02-xedge[20];
    lnryd = log(ryd);
    xsect += exp(-6.89061 - 4.33256*lnryd - 0.293688*lnryd*lnryd)*15.0*
             exp(-24.0426608/tkev);
   }

   /* 1s5d 1D   22766.705 22760.494  */

   if(Ryd >= xedge[21]) {
    ryd = Ryd+4.002274e-02-xedge[21];
    lnryd = log(ryd);
    xsect += exp(-7.06954 - 4.4637*lnryd - 0.323372*lnryd*lnryd)*5.0*
             exp(-24.0428020/tkev);
   }

   /* A number of unimportant levels are left out here.  Continue
      with level 27, 1s6d 3D */

   /* 1s6d 3D   32780.463 32771.525  */

   if(Ryd >= xedge[22]) {
    ryd = Ryd+2.779591e-02-xedge[22];
    lnryd = log(ryd);
    xsect += exp(-7.37968 - 4.28293*lnryd - 0.286885*lnryd*lnryd)*15.0*
             exp(-24.2091617/tkev);
   }

   /* 1s7d 3D   44623.014 44610.850  */

  if(Ryd >= xedge[23]) {
    ryd = Ryd+2.041946e-02-xedge[23];
    lnryd = log(ryd);
    xsect += exp(-7.80773 - 4.24383*lnryd - 0.276899*lnryd*lnryd)*15.0*
             exp(-24.3095395/tkev);
   }

  /* 1s8d 3D   58288.416 58272.528  */

  if(Ryd >= xedge[24]) {
    ryd = Ryd+1.562262e-02-xedge[24];
    lnryd = log(ryd);
    xsect += exp(-8.18416 - 4.2116*lnryd - 0.267494*lnryd*lnryd)*15.0*
             exp(-24.3746794/tkev);
   }

  /* 1s9d 3D   73776.650 73756.542  */

  if(Ryd >= xedge[25]) {
    ryd = Ryd+1.234108e-02-xedge[25];
    lnryd = log(ryd);
    xsect += exp(-8.51573 - 4.17014*lnryd - 0.252163*lnryd*lnryd)*15.0*
             exp(-24.4193341/tkev);
   }

   return(1.0e-18*xsect);
} 
