#include <stdio.h>
#include <math.h>
#include "spectrum.h"

float he4471_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[79] = {-60.0,-55.0,-50.0,-45.0,-40.0,-35.0,-30.0,-25.0,-20.0,
           -18.0,-16.0,-14.0,-12.0,-10.0,-8.0,-6.0,-5.0,-4.0,-3.0,
           -2.4,-2.2,-2.0,-1.9,-1.8,-1.7,-1.6,-1.5,-1.4,-1.3,-1.2,
           -1.1,-1.0,-0.8,-0.6,-0.4,-0.3,-0.2,-0.1,0.0,0.1,0.2,0.3,
           0.4,0.5,0.6,0.7,0.8,1.0,1.2,1.4,1.6,2.0,2.5,3.0,4.0,5.0,
           6.0,8.0,10.0,12.0,14.0,16.0,18.0,20.0,25.0,30.0,35.0,40.0,
           45.0,45.2,45.4,45.6,45.8,46.0,46.5,47.0,50.0,55.0,60.0};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {2.62e-12,2.75e-12,2.78e-12,2.72e-12};
 static float b2[4] = {5.45e-12,5.39e-12,5.21e-12,5.00e-12};
 static float prof[79][4] = {{8.06e-06,8.46e-06,8.56e-06,8.38e-06},
 {1.00e-05,1.05e-05,1.05e-05,1.03e-05},{1.27e-05,1.32e-05,1.32e-05,1.28e-05},
 {1.64e-05,1.69e-05,1.69e-05,1.64e-05},{2.18e-05,2.25e-05,2.24e-05,2.16e-05},
 {3.03e-05,3.10e-05,3.06e-05,2.95e-05},{4.39e-05,4.47e-05,4.40e-05,4.21e-05},
 {6.83e-05,6.89e-05,6.74e-05,6.43e-05},{1.17e-04,1.17e-04,1.14e-04,1.08e-04},
 {1.51e-04,1.50e-04,1.45e-04,1.38e-04},{2.00e-04,1.99e-04,1.92e-04,1.82e-04},
 {2.77e-04,2.73e-04,2.63e-04,2.48e-04},{4.02e-04,3.94e-04,3.78e-04,3.57e-04},
 {6.27e-04,6.11e-04,5.84e-04,5.50e-04},{10.80e-04,10.50e-04,9.96e-04,9.39e-04},
 {2.16e-03,2.08e-03,2.05e-03,1.94e-03},{3.37e-03,3.21e-03,3.35e-03,3.27e-03},
 {6.33e-03,6.17e-03,6.38e-03,6.28e-03},{1.45e-02,1.43e-02,1.42e-02,1.36e-02},
 {2.81e-02,2.81e-02,2.73e-02,2.59e-02},{3.77e-02,3.77e-02,3.65e-02,3.41e-02},
 {5.22e-02,5.20e-02,4.98e-02,4.57e-02},{6.14e-02,6.08e-02,5.80e-02,5.24e-02},
 {7.13e-02,7.03e-02,6.65e-02,5.91e-02},{8.02e-02,7.85e-02,7.38e-02,6.45e-02},
 {8.37e-02,8.25e-02,7.75e-02,6.73e-02},{7.83e-02,7.92e-02,7.58e-02,6.66e-02},
 {6.84e-02,6.99e-02,6.93e-02,6.28e-02},{5.63e-02,5.89e-02,6.07e-02,5.76e-02},
 {4.63e-02,4.97e-02,5.30e-02,5.28e-02},{4.08e-02,4.41e-02,4.80e-02,4.98e-02},
 {3.99e-02,4.24e-02,4.64e-02,4.94e-02},{4.94e-02,5.03e-02,5.32e-02,5.77e-02},
 {7.80e-02,7.65e-02,7.73e-02,8.38e-02},{1.53e-01,1.46e-01,1.46e-01,1.56e-01},
 {2.37e-01,2.27e-01,2.25e-01,2.36e-01},{4.01e-01,3.78e-01,3.66e-01,3.70e-01},
 {6.96e-01,6.40e-01,5.99e-01,5.72e-01},{10.71e-01,9.89e-01,9.05e-01,8.21e-01},
 {1.26,1.23,1.15,1.03},{1.15,1.19,1.19,1.11},
 {8.86e-01,9.54e-01,10.01e-01,10.09e-01},{6.28e-01,6.82e-01,7.39e-01,8.01e-01},
 {4.33e-01,4.67e-01,5.10e-01,5.78e-01},{3.04e-01,3.21e-01,3.46e-01,3.98e-01},
 {2.20e-01,2.28e-01,2.41e-01,2.72e-01},{1.66e-01,1.68e-01,1.73e-01,1.91e-01},
 {1.03e-01,1.00e-01,1.00e-01,1.05e-01},{6.80e-02,6.59e-02,6.39e-02,6.49e-02},
 {4.77e-02,4.57e-02,4.36e-02,4.30e-02},{3.56e-02,3.39e-02,3.19e-02,3.08e-02},
 {2.15e-02,2.03e-02,1.89e-02,1.78e-02},{1.29e-02,1.21e-02,1.12e-02,1.05e-02},
 {8.55e-03,8.00e-03,7.42e-03,6.84e-03},{4.26e-03,3.93e-03,3.58e-03,3.23e-03},
 {2.47e-03,2.34e-03,2.08e-03,1.97e-03},{1.48e-03,1.42e-03,1.33e-03,1.23e-03},
 {7.35e-04,7.11e-04,6.65e-04,6.09e-04},{4.35e-04,4.23e-04,3.96e-04,3.62e-04},
 {2.82e-04,2.76e-04,2.58e-04,2.35e-04},{1.95e-04,1.91e-04,1.80e-04,1.63e-04},
 {1.41e-04,1.39e-04,1.30e-04,1.18e-04},{10.50e-05,10.30e-05,9.68e-05,8.73e-05},
 {8.43e-05,8.30e-05,7.77e-05,7.00e-05},{5.36e-05,5.27e-05,4.92e-05,4.41e-05},
 {3.82e-05,3.72e-05,3.44e-05,3.07e-05},{3.06e-05,2.90e-05,2.64e-05,2.33e-05},
 {2.67e-05,2.44e-05,2.17e-05,1.88e-05},{4.23e-05,4.79e-05,3.87e-05,3.88e-05},
 {5.90e-05,6.59e-05,7.60e-05,10.20e-05},{2.08e-04,2.73e-04,3.31e-04,3.63e-04},
 {6.80e-04,6.49e-04,6.11e-04,5.58e-04},{3.38e-04,3.44e-04,3.55e-04,3.72e-04},
 {2.22e-04,2.23e-04,2.24e-04,2.29e-04},{1.32e-04,1.31e-04,1.29e-04,1.27e-04},
 {9.63e-05,9.16e-05,8.58e-05,8.07e-05},{4.95e-05,4.73e-05,4.51e-05,4.30e-05},
 {2.94e-05,2.80e-05,2.65e-05,2.49e-05},{1.82e-05,1.80e-05,1.74e-05,1.67e-05}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4471.48;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -60.00) {
   p1 = b1[k]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL >= 60.00) {
   p1 = b2[k]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<78;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}


float he4922_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[75] = {-60.0,-55.0,-50.0,-45.0,-40.0,-35.0,-30.0,-25.0,
 -20.0,-18.0,-16.0,-14.0,-13.0,-12.0,-11.6,-11.4,-11.3,-11.2,-11.0,-10.0,
 -8.0,-6.0,-5.0,-4.0,-3.5,-3.0,-2.5,-2.2,-2.0,-1.8,-1.6,-1.5,-1.4,-1.2,-1.0,
 -0.8,-0.6,-0.5,-0.4,-0.3,-0.2,-0.1,0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.8,1.0,1.2,1.5,
 2.0,2.5,3.0,3.5,4.0,5.0,6.0,8.0,10.0,12.0,14.0,16.0,18.0,20.0,25.0,30.0,
 35.0,40.0,45.0,50.0,55.0,60.0};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {3.45e-12,3.49e-12,3.45e-12,3.30e-12};
 static float b2[4] = {2.80e-12,2.89e-12,2.86e-12,2.77e-12};
 static float prof[75][4] = {{1.42e-5,1.44e-5,1.42e-5,1.36e-5},
{1.78e-5,1.80e-5,1.77e-5,1.69e-5},{2.29e-5,2.30e-5,2.25e-5,2.14e-5},
{3.02e-5,3.02e-5,2.93e-5,2.79e-5},{4.12e-5,4.10e-5,3.96e-5,3.75e-5},
{5.89e-5,5.80e-5,5.58e-5,5.27e-5},{8.92e-5,8.72e-5,8.33e-5,7.85e-5},
{1.47e-4,1.43e-4,1.36e-4,1.27e-4},{2.80e-4,2.66e-4,2.46e-4,2.28e-4},
{3.86e-4,3.64e-4,3.34e-4,2.98e-4},{5.53e-4,5.23e-4,4.81e-4,4.30e-4},
{9.19e-4,8.75e-4,8.11e-4,7.33e-4},{1.34e-3,1.30e-3,1.23e-3,1.14e-3},
{2.50e-3,2.40e-3,2.23e-3,2.00e-3},{3.53e-3,3.38e-3,3.08e-3,2.71e-3},
{3.73e-3,3.62e-3,3.34e-3,2.82e-3},{3.54e-3,3.51e-3,3.28e-3,2.90e-3},
{3.16e-3,3.22e-3,3.09e-3,2.80e-3},{2.31e-3,2.48e-3,2.51e-3,2.40e-3},
{9.84e-4,9.96e-4,10.26e-4,10.52e-4},{1.47e-3,1.33e-3,1.19e-3,1.05e-3},
{3.20e-3,2.97e-3,2.73e-3,2.49e-3},{5.40e-3,5.06e-3,4.69e-3,4.32e-3},
{7.20e-3,6.86e-3,6.44e-3,6.05e-3},{1.09e-2,1.07e-2,1.04e-2,1.01e-2},
{1.73e-2,1.71e-2,1.69e-2,1.64e-2},{3.03e-2,3.02e-2,2.96e-2,2.82e-2},
{4.52e-2,4.52e-2,4.40e-2,4.10e-2},{6.02e-2,6.00e-2,5.82e-2,5.31e-2},
{7.84e-2,7.79e-2,7.48e-2,6.67e-2},{9.22e-2,9.08e-2,8.60e-2,7.61e-2},
{9.19e-2,9.04e-2,8.58e-2,7.68e-2},{8.45e-2,8.40e-2,8.11e-2,7.46e-2},
{6.24e-2,6.43e-2,6.59e-2,6.57e-2},{5.42e-2,5.57e-2,5.84e-2,6.17e-2},
{6.31e-2,6.30e-2,6.52e-2,6.98e-2},{9.18e-2,8.98e-2,9.12e-2,9.69e-2},
{1.18e-1,1.15e-1,1.16e-1,1.22e-1},{.158,.153,.153,.158},{.220,.213,.209,.211},
{.314,.301,.291,.286},{.444,.423,.404,.387},{.594,.568,.541,.510},
{.726,.707,.679,.633},{.787,.789,.773,.724},{.751,.775,.784,.754},
{.650,.685,.714,.714},{.531,.564,.599,.624},{.423,.446,.477,.511},
{.265,.272,.285,.309},{.172,.173,.175,.184},{.118,.116,.113,.116},
{7.16e-2,6.89e-2,6.55e-2,6.40e-2},{3.71e-2,3.43e-2,3.16e-2,2.97e-2},
{2.24e-2,2.06e-2,1.89e-2,1.76e-2},{1.46e-2,1.33e-2,1.20e-2,1.08e-2},
{10.51e-3,9.67e-3,8.75e-3,7.87e-3},{7.91e-3,7.48e-3,6.79e-3,6.09e-3},
{4.72e-3,4.54e-3,4.30e-3,4.04e-3},{3.03e-3,2.91e-3,2.75e-3,2.57e-3},
{1.48e-3,1.43e-3,1.34e-3,1.25e-3},{8.99e-4,8.65e-4,8.15e-4,7.59e-4},
{5.90e-4,5.70e-4,5.39e-4,5.03e-4},{4.12e-4,3.99e-4,3.79e-4,3.54e-4},
{3.00e-4,2.92e-4,2.78e-4,2.60e-4},{2.27e-4,2.22e-4,2.11e-4,1.98e-4},
{1.77e-4,1.74e-4,1.66e-4,1.56e-4},{10.38e-5,10.26e-5,9.88e-5,9.32e-5},
{6.70e-5,6.68e-5,6.46e-5,6.12e-5},{4.62e-5,4.63e-5,4.50e-5,4.28e-5},
{3.34e-5,3.37e-5,3.29e-5,3.14e-5},{2.51e-5,2.55e-5,2.50e-5,2.39e-5},
{1.94e-5,1.98e-5,1.95e-5,1.87e-5},{1.53e-5,1.57e-5,1.56e-5,1.50e-5},
{1.24e-5,1.28e-5,1.27e-5,1.23e-5}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4921.93;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -60.00) {
   p1 = b1[k]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL >= 60.00) {
   p1 = b2[k]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<74;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4387_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[52] = {-200.00, -150.00, -100.00,  -80.00,  -60.00,  -40.00,
       -30.00,  -20.00,  -15.00,  -10.00,   -7.00,   -6.00,   -5.00,   -4.00,
	-3.00,   -2.00,   -1.50,   -1.00,   -0.80,   -0.60,   -0.50,   -0.40,
	-0.30,   -0.20,   -0.10,    0.10,    0.20,    0.40,    0.60,    0.80,
	 1.00,    1.50,    2.00,    3.00,    5.00,    7.00,   10.00,   15.00,
	20.00,   30.00,   40.00,   45.00,   48.00,   49.00,   50.00,   52.00,
	55.00,   60.00,   80.00,  100.00,  150.00,  200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[52][3] =          {{3.7318e-07,4.6555e-07,5.4018e-07},
   {8.5966e-07,1.0364e-06,1.1503e-06},{2.6516e-06,3.0550e-06,3.2287e-06},
   {6.3768e-06,6.9632e-06,7.1284e-06},{1.9217e-05,2.0039e-05,2.0015e-05},
   {6.1878e-05,6.2369e-05,6.0836e-05},{1.3189e-04,1.3039e-04,1.2536e-04},
   {3.8226e-04,3.7040e-04,3.5116e-04},{8.0272e-04,7.7375e-04,7.2968e-04},
   {2.3506e-03,2.2695e-03,2.1434e-03},{6.7292e-03,6.6352e-03,6.3458e-03},
   {1.1579e-02,1.1748e-02,1.1496e-02},{2.1087e-02,2.2192e-02,2.2475e-02},
   {1.1793e-02,1.0966e-02,9.9206e-03},{2.1730e-02,2.0448e-02,1.8658e-02},
   {5.6957e-02,5.7263e-02,5.5483e-02},{8.5249e-02,8.6314e-02,8.5455e-02},
   {9.8135e-02,9.3209e-02,9.1349e-02},{1.2185e-01,1.1609e-01,1.1728e-01},
   {2.1137e-01,2.1489e-01,2.2541e-01},{2.8747e-01,2.9978e-01,3.0813e-01},
   {3.5051e-01,3.6891e-01,3.7138e-01},{3.6050e-01,3.7970e-01,3.8426e-01},
   {3.2818e-01,3.4155e-01,3.5411e-01},{2.9679e-01,3.0136e-01,3.1766e-01},
   {2.9540e-01,2.9414e-01,3.1030e-01},{3.1155e-01,3.1188e-01,3.2865e-01},
   {3.2880e-01,3.3336e-01,3.4923e-01},{3.0831e-01,3.1497e-01,3.2609e-01},
   {2.6518e-01,2.7171e-01,2.7728e-01},{2.1757e-01,2.2280e-01,2.2416e-01},
   {1.2484e-01,1.2631e-01,1.2345e-01},{7.3754e-02,7.3360e-02,7.0312e-02},
   {3.1415e-02,3.0404e-02,2.8536e-02},{9.3440e-03,8.9663e-03,8.3804e-03},
   {4.2051e-03,4.0298e-03,3.7686e-03},{1.7738e-03,1.7044e-03,1.5986e-03},
   {6.6510e-04,6.4474e-04,6.0932e-04},{3.2687e-04,3.2009e-04,3.0489e-04},
   {1.1608e-04,1.1599e-04,1.1212e-04},{5.4699e-05,5.5614e-05,5.4477e-05},
   {4.0001e-05,4.0991e-05,4.0393e-05},{3.3695e-05,3.4683e-05,3.4295e-05},
   {3.1938e-05,3.2929e-05,3.2606e-05},{3.1102e-05,3.2086e-05,3.1795e-05},
   {2.6272e-05,2.7205e-05,2.6977e-05},{2.2531e-05,2.3437e-05,2.3342e-05},
   {1.8088e-05,1.8925e-05,1.8948e-05},{5.8420e-06,6.4010e-06,6.5624e-06},
   {3.2797e-06,3.6587e-06,3.8227e-06},{8.8757e-07,1.0556e-06,1.1630e-06},
   {3.9267e-07,4.8307e-07,5.5418e-07}};

 DL = wave - 4387.93;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<51;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3705_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[48] = {-80.00,-60.00,-40.00,-30.00,-20.00,-10.00, -7.00,
    -5.00, -3.00, -2.00, -1.50, -1.00, -0.80, -0.60, -0.40, -0.30, -0.20,
    -0.10,  0.10,  0.20,  0.40,  0.60,  0.80,  1.00,  1.50,  2.00,  3.00,
     4.00,  5.00,  6.00,  6.50,  7.00,  9.00, 11.00, 13.00, 15.00, 18.00,
    22.00, 25.00, 27.00, 28.00, 30.00, 33.00, 36.00, 40.00, 50.00, 60.00,
    80.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[48][3] =          {{6.2538e-06,8.0582e-06,9.6320e-06},
   {1.4418e-05,1.8000e-05,2.0627e-05},{4.5250e-05,5.3967e-05,5.8829e-05},
   {1.0575e-04,1.2053e-04,1.2624e-04},{5.9911e-04,6.2900e-04,6.1053e-04},
   {3.6200e-03,3.6730e-03,3.5572e-03},{8.7672e-03,8.8487e-03,8.5130e-03},
   {1.9176e-02,1.9484e-02,1.8789e-02},{5.2035e-02,5.3374e-02,5.2774e-02},
   {9.7606e-02,9.8249e-02,9.7733e-02},{1.2165e-01,1.2270e-01,1.2418e-01},
   {1.4567e-01,1.4587e-01,1.4913e-01},{1.5692e-01,1.5684e-01,1.6080e-01},
   {1.7127e-01,1.7235e-01,1.7842e-01},{1.8726e-01,1.9162e-01,2.0207e-01},
   {1.9313e-01,1.9921e-01,2.1185e-01},{1.9548e-01,2.0246e-01,2.1632e-01},
   {1.9338e-01,2.0000e-01,2.1376e-01},{1.7864e-01,1.8262e-01,1.9383e-01},
   {1.7076e-01,1.7336e-01,1.8308e-01},{1.5821e-01,1.5998e-01,1.6823e-01},
   {1.4829e-01,1.5091e-01,1.5894e-01},{1.3822e-01,1.4172e-01,1.4918e-01},
   {1.2686e-01,1.3063e-01,1.3687e-01},{9.6418e-02,9.9057e-02,1.0161e-01},
   {7.0302e-02,7.1593e-02,7.1758e-02},{3.8007e-02,3.7759e-02,3.6141e-02},
   {2.1140e-02,2.0771e-02,1.9463e-02},{1.4685e-02,1.4481e-02,1.3563e-02},
   {1.7832e-02,1.8270e-02,1.8253e-02},{1.7916e-02,1.8681e-02,1.8857e-02},
   {1.5404e-02,1.6057e-02,1.6043e-02},{7.2109e-03,7.3193e-03,7.0901e-03},
   {3.8541e-03,3.8725e-03,3.7390e-03},{2.3306e-03,2.3601e-03,2.2849e-03},
   {1.4966e-03,1.5247e-03,1.5299e-03},{8.4747e-04,8.7438e-04,8.9042e-04},
   {4.4324e-04,4.6740e-04,4.8911e-04},{3.0899e-04,3.0506e-04,3.0751e-04},
   {1.8926e-04,2.0490e-04,2.0623e-04},{1.6274e-04,1.7808e-04,1.7995e-04},
   {1.3698e-04,1.4993e-04,1.5321e-04},{1.0593e-04,1.1687e-04,1.2085e-04},
   {8.3546e-05,9.3440e-05,9.7547e-05},{6.2712e-05,7.1194e-05,7.4952e-05},
   {2.7163e-05,3.2620e-05,3.5758e-05},{1.5981e-05,1.9615e-05,2.2046e-05},
   {6.7292e-06,8.5711e-06,1.0105e-05}};

 DL = wave - 3705.00;
 if(DL < -80.0 || DL > 80.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<47;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he5875_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[68] = {-300.00,-250.00,-200.00,-150.00,-125.00,-100.00,
	 -80.00, -60.00, -40.00, -30.00, -20.00, -15.00, -12.00, -10.00,
	  -8.00,  -6.00,  -4.00,  -3.00,  -2.00,  -1.50,  -1.00,  -0.80,
	  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
	   0.80,   1.00,   1.50,   2.00,   2.50,   3.00,   4.00,   6.00,
	   8.00,  10.00,  12.00,  15.00,  20.00,  30.00,  40.00,  60.00,
	  80.00, 100.00, 150.00, 165.00, 180.00, 185.00, 188.00, 190.00,
	 191.00, 191.50, 192.00, 193.00, 195.00, 197.00, 200.00, 205.00,
	 210.00, 220.00, 230.00, 250.00, 275.00, 300.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[68][3] =
  {{3.4597e-08,4.1440e-08,4.5880e-08},{6.7143e-08,7.6355e-08,8.2086e-08},
   {1.1007e-07,1.2328e-07,1.3101e-07},{2.7186e-07,2.9279e-07,3.0387e-07},
   {4.0773e-07,4.3571e-07,4.4945e-07},{6.6314e-07,7.0313e-07,7.2076e-07},
   {1.0679e-06,1.1254e-06,1.1477e-06},{1.9492e-06,2.0415e-06,2.0712e-06},
   {4.4671e-06,4.6510e-06,4.6938e-06},{7.9682e-06,8.2714e-06,8.3247e-06},
   {1.7845e-05,1.8466e-05,1.8533e-05},{3.1476e-05,3.2485e-05,3.2585e-05},
   {4.8793e-05,5.0347e-05,5.0410e-05},{6.9729e-05,7.1887e-05,7.1959e-05},
   {1.0793e-04,1.1118e-04,1.1119e-04},{1.9161e-04,1.9644e-04,1.9577e-04},
   {4.2006e-04,4.3099e-04,4.3008e-04},{7.3287e-04,7.5271e-04,7.5246e-04},
   {1.6061e-03,1.6543e-03,1.6636e-03},{2.8062e-03,2.9014e-03,2.9433e-03},
   {6.1959e-03,6.4866e-03,6.7888e-03},{9.6235e-03,1.0237e-02,1.1222e-02},
   {1.7381e-02,1.9153e-02,2.4581e-02},{4.0785e-02,5.4808e-02,8.5818e-02},
   {2.2887e-01,2.6427e-01,2.7338e-01},{4.9015e-01,4.4781e-01,3.8153e-01},
   {4.7313e-01,4.6179e-01,4.0344e-01},{2.5023e-01,3.0168e-01,3.1392e-01},
   {1.0913e-01,1.1572e-01,1.3694e-01},{3.1573e-02,4.0219e-02,5.0668e-02},
   {1.1313e-02,1.3181e-02,1.7417e-02},{6.4820e-03,7.0030e-03,7.8118e-03},
   {2.6285e-03,2.7601e-03,2.8289e-03},{1.4363e-03,1.4976e-03,1.5137e-03},
   {9.0610e-04,9.4177e-04,9.4651e-04},{6.2420e-04,6.4765e-04,6.4898e-04},
   {3.4816e-04,3.6056e-04,3.6025e-04},{1.5375e-04,1.5901e-04,1.5854e-04},
   {8.6530e-05,8.9250e-05,8.8833e-05},{5.5298e-05,5.7034e-05,5.6755e-05},
   {3.8384e-05,3.9583e-05,3.9384e-05},{2.4576e-05,2.5332e-05,2.5200e-05},
   {1.3860e-05,1.4264e-05,1.4181e-05},{6.2116e-06,6.3638e-06,6.3160e-06},
   {3.3649e-06,3.4344e-06,3.4014e-06},{1.5057e-06,1.5267e-06,1.5082e-06},
   {8.4834e-07,8.5762e-07,8.4621e-07},{5.4179e-07,5.4743e-07,5.3997e-07},
   {2.3799e-07,2.4122e-07,2.3815e-07},{1.9660e-07,1.9955e-07,1.9709e-07},
   {1.6538e-07,1.6824e-07,1.6631e-07},{1.6281e-07,1.6583e-07,1.6390e-07},
   {1.6337e-07,1.6812e-07,1.6823e-07},{2.4178e-07,2.5089e-07,2.5003e-07},
   {7.8593e-07,1.2814e-06,2.5004e-06},{4.1685e-05,4.0810e-05,3.6678e-05},
   {1.8998e-05,2.0239e-05,2.1625e-05},{4.9436e-06,4.9410e-06,4.9408e-06},
   {2.7762e-06,2.7901e-06,2.8054e-06},{1.9087e-06,1.9109e-06,1.9086e-06},
   {1.3828e-06,1.3857e-06,1.3847e-06},{9.6852e-07,9.7092e-07,9.6951e-07},
   {7.5845e-07,7.6080e-07,7.5948e-07},{5.3571e-07,5.3795e-07,5.3669e-07},
   {4.1558e-07,4.1771e-07,4.1659e-07},{2.8462e-07,2.8651e-07,2.8566e-07},
   {1.9974e-07,2.0143e-07,2.0078e-07},{1.5001e-07,1.5154e-07,1.5102e-07}};

 DL = wave - 5875.70;
 if(DL < -300.0 || DL > 300.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<67;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3819_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
	 -40.00, -30.00, -20.00, -10.00,  -7.00,  -5.00,  -3.00,  -2.00,
	  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.30,  -0.20,  -0.10,
	   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,
	   3.00,   5.00,   7.00,   9.00,   9.50,  10.00,  10.50,  11.00,
	  12.00,  13.00,  15.00,  18.00,  20.00,  25.00,  30.00,  40.00,
	  43.00,  47.00,  48.00,  49.00,  50.00,  52.00,  55.00,  60.00,
	  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{3.5379e-07,4.5898e-07,5.6456e-07},{7.8799e-07,1.0059e-06,1.1995e-06},
   {1.2913e-06,1.6294e-06,1.9100e-06},{2.3520e-06,2.9157e-06,3.3472e-06},
   {4.2830e-06,5.1935e-06,5.8336e-06},{9.3233e-06,1.0923e-05,1.1895e-05},
   {3.7769e-05,4.0839e-05,4.2016e-05},{1.0981e-04,1.1397e-04,1.1427e-04},
   {3.3848e-04,3.4132e-04,3.3538e-04},{2.0245e-03,2.0050e-03,1.9298e-03},
   {4.8713e-03,4.8073e-03,4.5999e-03},{1.1088e-02,1.0990e-02,1.0516e-02},
   {3.5514e-02,3.6018e-02,3.5098e-02},{7.5844e-02,7.6693e-02,7.5949e-02},
   {1.0594e-01,1.0698e-01,1.0773e-01},{1.6135e-01,1.6360e-01,1.6733e-01},
   {1.9828e-01,2.0072e-01,2.0553e-01},{2.3459e-01,2.3387e-01,2.3636e-01},
   {2.5706e-01,2.4941e-01,2.4775e-01},{2.6969e-01,2.5980e-01,2.5735e-01},
   {2.8820e-01,2.7866e-01,2.7701e-01},{3.1008e-01,3.0396e-01,3.0493e-01},
   {3.3640e-01,3.4194e-01,3.5158e-01},{3.3361e-01,3.4301e-01,3.5593e-01},
   {3.0213e-01,3.1321e-01,3.2722e-01},{2.5655e-01,2.6556e-01,2.7640e-01},
   {2.1130e-01,2.1805e-01,2.2530e-01},{1.7159e-01,1.7669e-01,1.8100e-01},
   {1.0018e-01,1.0263e-01,1.0285e-01},{6.0002e-02,6.0740e-02,5.9645e-02},
   {2.5539e-02,2.5034e-02,2.3743e-02},{7.1534e-03,6.8462e-03,6.3612e-03},
   {3.0572e-03,2.9222e-03,2.7026e-03},{2.3391e-03,2.3047e-03,2.1556e-03},
   {3.4767e-03,3.5306e-03,3.4308e-03},{7.0791e-03,7.3724e-03,7.4686e-03},
   {6.2279e-03,6.5318e-03,6.6059e-03},{4.4572e-03,4.5882e-03,4.5468e-03},
   {2.7180e-03,2.7402e-03,2.6788e-03},{1.9123e-03,1.9143e-03,1.8636e-03},
   {1.1386e-03,1.1325e-03,1.1007e-03},{6.2890e-04,6.2757e-04,6.1083e-04},
   {4.5850e-04,4.5940e-04,4.4862e-04},{2.3755e-04,2.3949e-04,2.3579e-04},
   {1.3437e-04,1.3432e-04,1.3317e-04},{5.1164e-05,5.3787e-05,5.4463e-05},
   {2.7277e-05,2.9613e-05,3.0215e-05},{2.0668e-05,2.2806e-05,2.3573e-05},
   {2.0473e-05,2.2586e-05,2.3368e-05},{2.0277e-05,2.2322e-05,2.3114e-05},
   {1.9498e-05,2.1476e-05,2.2278e-05},{1.7867e-05,1.9735e-05,2.0551e-05},
   {1.5697e-05,1.7381e-05,1.8192e-05},{1.2692e-05,1.4160e-05,1.4926e-05},
   {4.7194e-06,5.5755e-06,6.1195e-06},{2.5546e-06,3.0858e-06,3.4664e-06},
   {1.3785e-06,1.6954e-06,1.9493e-06},{8.2592e-07,1.0283e-06,1.2069e-06},
   {3.5652e-07,4.5240e-07,5.5252e-07}};

 DL = wave - 3819.60;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<58;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3867_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[55] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
 -55.00, -52.00, -50.00, -48.00, -46.00, -44.00, -42.00, -40.00, -38.00,
 -36.00, -33.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
  -3.00,  -2.50,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,
  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,
   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,  80.00,
 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[55][3] =
  {{5.1235e-07,6.2097e-07,7.2308e-07},{1.3797e-06,1.5944e-06,1.7395e-06},
   {2.3995e-06,2.7252e-06,2.9013e-06},{4.5073e-06,5.0397e-06,5.2527e-06},
   {1.0842e-05,1.1699e-05,1.1908e-05},{3.2411e-05,3.3920e-05,3.4120e-05},
   {3.8021e-05,3.9977e-05,4.0161e-05},{4.0230e-05,4.2557e-05,4.2744e-05},
   {8.4435e-05,8.6287e-05,8.7427e-05},{1.2468e-04,1.2674e-04,1.2625e-04},
   {6.9964e-05,7.1531e-05,6.9232e-05},{5.7012e-05,6.0041e-05,5.9475e-05},
   {8.3599e-05,8.7251e-05,8.6424e-05},{1.3701e-04,1.4199e-04,1.4048e-04},
   {9.9508e-04,1.0439e-03,1.0688e-03},{4.5639e-04,4.6990e-04,4.7031e-04},
   {2.4420e-04,2.4864e-04,2.4804e-04},{1.5617e-04,1.6118e-04,1.6042e-04},
   {1.5426e-04,1.5946e-04,1.5813e-04},{2.0119e-04,2.0753e-04,2.0516e-04},
   {3.2114e-04,3.2907e-04,3.2422e-04},{6.5708e-04,6.7139e-04,6.5943e-04},
   {9.9723e-04,1.0217e-03,1.0053e-03},{1.7228e-03,1.7792e-03,1.7592e-03},
   {6.3706e-03,6.7746e-03,6.7927e-03},{7.7670e-03,8.5040e-03,8.7874e-03},
   {1.1469e-02,1.2595e-02,1.3095e-02},{1.8835e-02,2.0776e-02,2.1815e-02},
   {3.6439e-02,4.0535e-02,4.3425e-02},{5.1240e-02,5.7326e-02,6.2316e-02},
   {7.7255e-02,8.7150e-02,9.6945e-02},{1.2935e-01,1.4775e-01,1.7075e-01},
   {2.5541e-01,2.9578e-01,3.5699e-01},{3.9292e-01,4.5067e-01,5.3590e-01},
   {9.7678e-01,9.7160e-01,9.8551e-01},{1.2473e+00,1.1464e+00,1.0787e+00},
   {9.5734e-01,8.8656e-01,8.1369e-01},{4.6828e-01,4.6070e-01,4.3637e-01},
   {2.4045e-01,2.4354e-01,2.3399e-01},{1.4150e-01,1.4505e-01,1.4014e-01},
   {2.9305e-02,3.0580e-02,3.0061e-02},{5.9018e-03,6.3428e-03,6.4708e-03},
   {2.5385e-03,2.7523e-03,2.8316e-03},{1.3903e-03,1.5175e-03,1.5704e-03},
   {8.6880e-04,9.5289e-04,9.9018e-04},{3.6715e-04,4.0482e-04,4.2349e-04},
   {1.9763e-04,2.1805e-04,2.2902e-04},{4.2724e-05,5.0959e-05,5.5922e-05},
   {2.2115e-05,2.6330e-05,2.9130e-05},{8.6457e-06,1.0267e-05,1.1499e-05},
   {4.3424e-06,5.1693e-06,5.8545e-06},{2.5059e-06,2.9979e-06,3.4321e-06},
   {1.4228e-06,1.7159e-06,1.9910e-06},{8.8345e-07,1.0755e-06,1.2648e-06},
   {4.0339e-07,5.0167e-07,6.0664e-07}};

 DL = wave - 3867.50;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<54;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3888_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[73] = {-200.00,-150.00,-125.00,-100.00, -90.00, -85.00,
 -82.00, -80.00, -77.00, -75.00, -60.00, -40.00, -30.00, -25.00, -20.00,
 -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.50,  -2.00,  -1.80,  -1.60,
  -1.50,  -1.40,  -1.20,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,
   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,   6.00,
   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  50.00,  60.00,  80.00,
 100.00, 125.00, 150.00, 200.00, 250.00, 300.00, 350.00, 360.00, 370.00,
 375.00, 380.00, 383.00, 385.00, 387.00, 389.00, 401.00, 404.00, 410.00,
 420.00, 430.00, 450.00, 500.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[73][3] =
  {{6.4377e-08,7.1028e-08,7.4171e-08},{3.2170e-07,3.3210e-07,3.3588e-07},
   {5.5994e-07,5.7369e-07,5.7759e-07},{1.2957e-06,1.3150e-06,1.3184e-06},
   {2.3402e-06,2.3630e-06,2.3661e-06},{3.9421e-06,3.9664e-06,3.9676e-06},
   {7.2767e-06,7.3179e-06,7.3484e-06},{2.5879e-05,2.5859e-05,2.5736e-05},
   {5.7358e-07,6.0521e-07,6.1009e-07},{5.9343e-07,6.2381e-07,6.2458e-07},
   {9.4914e-07,9.9197e-07,9.8775e-07},{2.2120e-06,2.2981e-06,2.2760e-06},
   {3.9675e-06,4.1165e-06,4.0724e-06},{5.7176e-06,5.9323e-06,5.8691e-06},
   {8.9111e-06,9.2517e-06,9.1590e-06},{1.5742e-05,1.6368e-05,1.6225e-05},
   {3.5115e-05,3.6601e-05,3.6348e-05},{5.4708e-05,5.7093e-05,5.6743e-05},
   {9.7046e-05,1.0143e-04,1.0088e-04},{3.8792e-04,4.0700e-04,4.0573e-04},
   {5.5495e-04,5.8433e-04,5.8406e-04},{8.6621e-04,9.1316e-04,9.1468e-04},
   {1.0690e-03,1.1278e-03,1.1312e-03},{1.3523e-03,1.4282e-03,1.4354e-03},
   {1.5384e-03,1.6258e-03,1.6360e-03},{1.7657e-03,1.8675e-03,1.8822e-03},
   {2.4025e-03,2.5469e-03,2.5784e-03},{3.4616e-03,3.6837e-03,3.7571e-03},
   {5.4100e-03,5.7950e-03,6.0035e-03},{9.7248e-03,1.0599e-02,1.1365e-02},
   {2.1923e-02,2.5102e-02,3.2257e-02},{1.0914e-01,1.4255e-01,1.7642e-01},
   {3.2155e-01,3.4451e-01,3.3085e-01},{4.3592e-01,4.2075e-01,3.7286e-01},
   {1.5982e-01,1.9418e-01,2.1871e-01},{2.9126e-02,3.2779e-02,4.2142e-02},
   {1.2959e-02,1.3881e-02,1.4772e-02},{7.1936e-03,7.5804e-03,7.8185e-03},
   {4.6192e-03,4.8380e-03,4.9140e-03},{1.1811e-03,1.2268e-03,1.2269e-03},
   {2.9899e-04,3.1171e-04,3.1223e-04},{1.3418e-04,1.4037e-04,1.4089e-04},
   {7.5913e-05,7.9608e-05,8.0037e-05},{4.8737e-05,5.1198e-05,5.1546e-05},
   {2.1677e-05,2.2835e-05,2.3054e-05},{1.2130e-05,1.2799e-05,1.2951e-05},
   {5.2876e-06,5.5911e-06,5.6777e-06},{2.8998e-06,3.0713e-06,3.1282e-06},
   {1.8042e-06,1.9140e-06,1.9547e-06},{1.2164e-06,1.2926e-06,1.3234e-06},
   {6.4454e-07,6.8733e-07,7.0695e-07},{3.7030e-07,3.9769e-07,4.1143e-07},
   {1.5420e-07,1.7177e-07,1.8135e-07},{1.0237e-07,1.1461e-07,1.2172e-07},
   {5.3231e-08,6.0162e-08,6.4572e-08},{3.1817e-08,3.6283e-08,3.9311e-08},
   {2.0796e-08,2.3916e-08,2.6135e-08},{1.4470e-08,1.6775e-08,1.8479e-08},
   {1.3541e-08,1.5724e-08,1.7347e-08},{1.2703e-08,1.4773e-08,1.6323e-08},
   {1.2322e-08,1.4342e-08,1.5859e-08},{1.2001e-08,1.3987e-08,1.5486e-08},
   {1.1920e-08,1.3908e-08,1.5397e-08},{1.2357e-08,1.4571e-08,1.6355e-08},
   {2.1041e-07,2.7231e-07,3.1319e-07},{3.2579e-07,3.2806e-07,3.3005e-07},
   {7.8689e-08,8.0457e-08,8.1795e-08},{6.8650e-08,7.0395e-08,7.1729e-08},
   {5.5534e-08,5.7227e-08,5.8523e-08},{4.3063e-08,4.4675e-08,4.5918e-08},
   {3.5634e-08,3.7172e-08,3.8365e-08},{2.6862e-08,2.8269e-08,2.9369e-08},
   {1.6714e-08,1.7858e-08,1.8773e-08}};

 DL = wave - 3888.65;
 if(DL < -200.0 || DL > 500.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<72;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3964_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[54] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
 -40.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.00,
  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,
   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,   4.00,   6.00,   6.50,
   7.00,   7.50,   8.00,   9.00,  10.00,  15.00,  20.00,  25.00,  30.00,
  40.00,  50.00,  60.00,  80.00,  85.00,  88.00,  90.00,  95.00, 100.00,
 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[54][3] =
  {{1.5361e-07,1.8351e-07,2.0639e-07},{3.4139e-07,3.9419e-07,4.2698e-07},
   {5.5498e-07,6.3017e-07,6.6997e-07},{1.4750e-06,1.5888e-06,1.6359e-06},
   {3.3500e-06,3.5181e-06,3.5663e-06},{6.7238e-06,6.9866e-06,7.0063e-06},
   {1.7700e-05,1.8098e-05,1.7894e-05},{5.3630e-05,5.3838e-05,5.2463e-05},
   {8.9679e-05,8.9325e-05,8.6525e-05},{1.7247e-04,1.7026e-04,1.6381e-04},
   {4.2585e-04,4.1617e-04,3.9741e-04},{6.9438e-04,6.7559e-04,6.4307e-04},
   {1.2940e-03,1.2528e-03,1.1880e-03},{5.6159e-03,5.4028e-03,5.0886e-03},
   {1.4018e-02,1.3203e-02,1.2235e-02},{2.5255e-02,2.3806e-02,2.2099e-02},
   {5.8180e-02,5.5103e-02,5.1607e-02},{9.2403e-02,8.7970e-02,8.3430e-02},
   {1.6872e-01,1.6309e-01,1.5979e-01},{3.9207e-01,3.9291e-01,4.2049e-01},
   {1.3751e+00,1.3658e+00,1.2993e+00},{2.1104e+00,1.9417e+00,1.6856e+00},
   {8.3798e-01,9.3520e-01,1.0186e+00},{3.7802e-01,4.2481e-01,5.2272e-01},
   {1.2622e-01,1.2455e-01,1.3248e-01},{6.2656e-02,5.9280e-02,5.6542e-02},
   {3.7453e-02,3.4830e-02,3.2080e-02},{2.4934e-02,2.2989e-02,2.0836e-02},
   {1.1751e-02,1.0728e-02,9.5603e-03},{6.8649e-03,6.2475e-03,5.5413e-03},
   {5.5551e-03,5.4183e-03,5.2724e-03},{3.3354e-03,3.4470e-03,3.4164e-03},
   {1.0034e-03,9.2289e-04,8.4374e-04},{1.0452e-03,9.7631e-04,9.3089e-04},
   {5.2888e-03,5.5634e-03,5.4779e-03},{3.2588e-03,3.4218e-03,3.4631e-03},
   {1.4985e-03,1.4838e-03,1.4346e-03},{9.5594e-04,9.3342e-04,8.9755e-04},
   {2.7353e-04,2.6172e-04,2.4727e-04},{1.2524e-04,1.2014e-04,1.1329e-04},
   {6.8999e-05,6.6659e-05,6.3026e-05},{4.2291e-05,4.1221e-05,3.9161e-05},
   {1.9306e-05,1.9189e-05,1.8439e-05},{1.0436e-05,1.0572e-05,1.0278e-05},
   {6.3558e-06,6.5463e-06,6.4340e-06},{3.0063e-06,3.1748e-06,3.1768e-06},
   {2.6345e-06,2.7958e-06,2.8074e-06},{3.4417e-06,3.6699e-06,3.6939e-06},
   {1.9128e-05,1.9281e-05,1.9273e-05},{6.3743e-06,6.5150e-06,6.5460e-06},
   {4.3462e-06,4.4724e-06,4.4982e-06},{1.4689e-06,1.5572e-06,1.5870e-06},
   {8.3212e-07,8.9596e-07,9.2300e-07},{2.0281e-07,2.4008e-07,2.6022e-07}};

 DL = wave - 3964.73;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<53;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4009_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[42] = {-80.00,-60.00,-40.00,-30.00,-20.00,-15.00,-13.00,
 -11.00,-10.00,-9.00,-8.00,-6.00,-3.00,-2.00,-1.50,-1.00,-0.80,-0.60,-0.40,
 -0.20,-0.10,0.10,0.20,0.40,0.60,0.80,1.00,2.00,4.00,6.00,8.00,10.00,12.00,
 14.00,15.00,16.00,18.00,20.00,25.00,30.00,40.00,60.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[42][3] =
  {{8.7693e-06,1.0992e-05,1.2749e-05},{2.0287e-05,2.4559e-05,2.7320e-05},
   {6.5841e-05,7.5499e-05,7.9549e-05},{2.5922e-04,2.7594e-04,2.7842e-04},
   {8.5727e-04,8.8347e-04,8.6802e-04},{1.8019e-03,1.8896e-03,1.8336e-03},
   {2.6603e-03,2.6812e-03,2.6565e-03},{4.2517e-03,4.2719e-03,4.0964e-03},
   {5.4568e-03,5.4754e-03,5.2484e-03},{7.1613e-03,7.1832e-03,6.8798e-03},
   {9.6318e-03,9.6836e-03,9.2776e-03},{1.9064e-02,1.9346e-02,1.8727e-02},
   {5.7993e-02,5.9595e-02,6.0700e-02},{6.9708e-02,7.0717e-02,7.2229e-02},
   {7.8258e-02,7.8511e-02,7.9692e-02},{9.1271e-02,9.0805e-02,9.2413e-02},
   {9.8399e-02,9.7828e-02,9.9906e-02},{1.0753e-01,1.0749e-01,1.1079e-01},
   {1.1885e-01,1.2043e-01,1.2629e-01},{1.3013e-01,1.3383e-01,1.4276e-01},
   {1.3431e-01,1.3866e-01,1.4854e-01},{1.3760e-01,1.4183e-01,1.5168e-01},
   {1.3732e-01,1.4086e-01,1.4997e-01},{1.3480e-01,1.3702e-01,1.4462e-01},
   {1.3171e-01,1.3342e-01,1.4024e-01},{1.2860e-01,1.3048e-01,1.3695e-01},
   {1.2502e-01,1.2725e-01,1.3332e-01},{9.5870e-02,9.8071e-02,1.0013e-01},
   {3.9520e-02,4.0370e-02,3.9586e-02},{1.7230e-02,1.7378e-02,1.6701e-02},
   {8.6827e-03,8.7111e-03,8.3324e-03},{4.9199e-03,4.9350e-03,4.7289e-03},
   {3.0222e-03,3.0064e-03,2.8919e-03},{1.9336e-03,1.9666e-03,1.9048e-03},
   {1.5969e-03,1.6318e-03,1.5869e-03},{1.3704e-03,1.4059e-03,1.3682e-03},
   {9.7955e-04,1.0111e-03,1.0329e-03},{7.2786e-04,7.5701e-04,7.8876e-04},
   {3.8210e-04,4.1278e-04,4.0584e-04},{2.3089e-04,2.4191e-04,2.5176e-04},
   {6.6880e-05,7.6479e-05,8.0439e-05},{2.0171e-05,2.4383e-05,2.7159e-05}};

 DL = wave - 4009.27;
 if(DL < -80.0 || DL > 60.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<41;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4023_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[51] = {-80.00,-60.00,-45.00,-37.00,-33.00,-30.00,-28.00,
   -27.00,-25.00,-22.00,-19.00,-17.00,-16.00,-15.00,-14.00,-12.00,-10.00,
    -7.00, -5.00, -3.00, -2.00, -1.50, -1.00, -0.80, -0.60, -0.40, -0.30,
    -0.20, -0.10,  0.10,  0.20,  0.40,  0.60,  0.80,  1.00,  1.50,  2.00,
     3.00,  4.00,  6.00,  8.00, 10.00, 13.00, 16.00, 20.00, 25.00, 30.00,
    40.00, 50.00, 60.00, 80.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[51][3] =
  {{1.2447e-05,1.4588e-05,1.6009e-05},{3.2373e-05,3.5893e-05,3.7105e-05},
   {1.3691e-04,1.4257e-04,1.4192e-04},{2.3690e-04,2.4444e-04,2.4167e-04},
   {3.3263e-04,3.3727e-04,3.3175e-04},{4.7834e-04,4.4665e-04,4.3604e-04},
   {5.9543e-04,5.6173e-04,5.3547e-04},{6.6956e-04,6.6025e-04,6.0216e-04},
   {8.6537e-04,8.8604e-04,8.7088e-04},{1.3807e-03,1.4285e-03,1.4103e-03},
   {2.4952e-03,2.6095e-03,2.5997e-03},{3.1810e-03,3.3081e-03,3.3254e-03},
   {2.7785e-03,2.8865e-03,2.8766e-03},{2.4218e-03,2.4585e-03,2.3669e-03},
   {3.5892e-03,3.7750e-03,3.8091e-03},{2.7119e-03,2.8035e-03,2.7489e-03},
   {3.0170e-03,3.0966e-03,3.0189e-03},{4.6324e-03,4.6526e-03,4.4632e-03},
   {7.8057e-03,7.7360e-03,7.3468e-03},{1.4451e-02,1.4873e-02,1.4705e-02},
   {2.5711e-02,2.6700e-02,2.6883e-02},{3.7408e-02,3.9133e-02,4.0053e-02},
   {5.9409e-02,6.2771e-02,6.5933e-02},{7.3818e-02,7.8367e-02,8.3483e-02},
   {9.3725e-02,9.9992e-02,1.0831e-01},{1.2191e-01,1.3057e-01,1.4399e-01},
   {1.4023e-01,1.5033e-01,1.6718e-01},{1.6206e-01,1.7366e-01,1.9445e-01},
   {1.8782e-01,2.0075e-01,2.2571e-01},{2.5099e-01,2.6448e-01,2.9561e-01},
   {2.8650e-01,2.9800e-01,3.2916e-01},{3.5063e-01,3.5280e-01,3.7535e-01},
   {3.7941e-01,3.7067e-01,3.7780e-01},{3.6160e-01,3.4778e-01,3.4201e-01},
   {3.1490e-01,3.0167e-01,2.8928e-01},{1.9113e-01,1.8448e-01,1.7176e-01},
   {1.1533e-01,1.1235e-01,1.0396e-01},{5.0545e-02,4.9774e-02,4.6238e-02},
   {2.0592e-02,2.1467e-02,2.1213e-02},{8.7606e-03,9.1400e-03,9.0368e-03},
   {4.6864e-03,4.9091e-03,4.8796e-03},{2.8552e-03,3.0273e-03,2.9833e-03},
   {1.4961e-03,1.5801e-03,1.6733e-03},{9.0382e-04,9.6200e-04,9.7645e-04},
   {5.7970e-04,6.1817e-04,5.7180e-04},{2.1798e-04,2.4059e-04,2.4871e-04},
   {1.1901e-04,1.3518e-04,1.4327e-04},{5.5552e-05,6.4543e-05,7.0113e-05},
   {3.1152e-05,3.6713e-05,4.0580e-05},{1.9394e-05,2.3105e-05,2.5909e-05},
   {9.0730e-06,1.1003e-05,1.2656e-05}};

 DL = wave - 4023.97;
 if(DL < -80.0 || DL > 80.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<50;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4026_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[56] = {-200.00,-150.00,-100.00, -80.00, -60.00, -40.00,
  -30.00, -20.00, -10.00, -7.00,  -5.00,  -3.00,  -2.00,  -1.50,  -1.00,
   -0.80,  -0.60,  -0.40, -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
    0.80,   1.00,   1.50,  2.00,   3.00,   5.00,   7.00,  10.00,  13.00,
   15.00,  16.00,  18.00, 19.00,  20.00,  22.00,  25.00,  30.00,  40.00,
   60.00,  70.00,  80.00, 85.00,  90.00,  93.00,  95.00,  98.00, 100.00,
  105.00, 110.00, 120.00,150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[56][3] =
  {{2.5790e-07,3.2337e-07,3.8213e-07},{5.8637e-07,7.1159e-07,8.0732e-07},
   {1.7616e-06,2.0557e-06,2.2317e-06},{3.1913e-06,3.6393e-06,3.8630e-06},
   {1.2529e-05,1.3248e-05,1.3490e-05},{3.8911e-05,4.0009e-05,3.9853e-05},
   {7.9577e-05,8.0567e-05,7.9202e-05},{2.1606e-04,2.1451e-04,2.0756e-04},
   {1.1661e-03,1.1324e-03,1.0771e-03},{2.7525e-03,2.6588e-03,2.5180e-03},
   {6.2103e-03,6.0065e-03,5.6862e-03},{2.3464e-02,2.2893e-02,2.1667e-02},
   {5.9946e-02,6.0793e-02,5.9101e-02},{9.4849e-02,9.6162e-02,9.4299e-02},
   {1.1595e-01,1.0981e-01,1.0721e-01},{1.6819e-01,1.6388e-01,1.6791e-01},
   {3.5693e-01,3.5657e-01,3.4778e-01},{4.3598e-01,4.4489e-01,4.3174e-01},
   {3.3157e-01,3.2568e-01,3.3632e-01},{3.3880e-01,3.2347e-01,3.3322e-01},
   {4.3256e-01,4.2267e-01,4.3370e-01},{4.5812e-01,4.5827e-01,4.7388e-01},
   {4.2061e-01,4.3561e-01,4.5510e-01},{3.2722e-01,3.4389e-01,3.5731e-01},
   {2.3832e-01,2.5055e-01,2.5674e-01},{1.7125e-01,1.7865e-01,1.8023e-01},
   {7.9963e-02,8.1015e-02,7.9131e-02},{4.2798e-02,4.2295e-02,4.0482e-02},
   {1.6798e-02,1.6105e-02,1.5086e-02},{4.7980e-03,4.5378e-03,4.1994e-03},
   {2.0536e-03,1.9400e-03,1.7878e-03},{8.1726e-04,7.7234e-04,7.0907e-04},
   {4.2183e-04,4.0134e-04,3.6888e-04},{3.0454e-04,2.9198e-04,2.6977e-04},
   {2.7107e-04,2.6070e-04,2.4084e-04},{2.7397e-04,2.7457e-04,2.6459e-04},
   {2.4986e-03,2.5970e-03,2.6260e-03},{9.8347e-04,1.0051e-03,1.0094e-03},
   {4.0587e-04,4.0515e-04,3.9633e-04},{2.2865e-04,2.2724e-04,2.2199e-04},
   {1.2198e-04,1.2169e-04,1.1883e-04},{5.2527e-05,5.2991e-05,5.2055e-05},
   {1.5616e-05,1.6119e-05,1.6060e-05},{8.9524e-06,9.3712e-06,9.4077e-06},
   {3.9971e-06,4.3475e-06,4.4273e-06},{3.3959e-06,3.7153e-06,3.8051e-06},
   {2.9150e-06,3.2065e-06,3.3021e-06},{2.6698e-06,2.9462e-06,3.0439e-06},
   {2.6727e-06,2.9422e-06,3.0406e-06},{2.5681e-06,2.8207e-06,2.9197e-06},
   {2.4621e-06,2.7061e-06,2.8052e-06},{2.2031e-06,2.4272e-06,2.5255e-06},
   {1.9700e-06,2.1759e-06,2.2730e-06},{1.5854e-06,1.7608e-06,1.8534e-06},
   {7.0462e-07,8.1899e-07,8.9513e-07},{2.9352e-07,3.5777e-07,4.1179e-07}};

 DL = wave - 4026.20;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<55;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4120_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[60] = {-200.00,-150.00,-125.00,-110.00,-100.00, -97.00,
 -95.00, -93.00, -90.00, -85.00, -80.00, -77.00, -75.00, -73.00, -70.00,
 -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
  -3.00,  -2.50,  -2.00,  -1.80,  -1.60,  -1.50,  -1.40,  -1.20,  -1.00,
  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
   0.80,   1.00,   2.00,   4.00,   6.00,   8.00,  10.00,  15.00,  20.00,
  30.00,  40.00,  50.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[60][3] =
  {{4.6288e-07,5.4200e-07,5.9328e-07},{1.4730e-06,1.6174e-06,1.6954e-06},
   {2.1651e-06,2.3759e-06,2.4765e-06},{5.7548e-06,6.0244e-06,6.1423e-06},
   {7.3530e-06,7.6872e-06,7.8205e-06},{7.4826e-06,7.8445e-06,7.9794e-06},
   {3.5310e-06,3.9280e-06,4.0653e-06},{3.4645e-06,3.8671e-06,4.0109e-06},
   {4.8085e-06,5.2361e-06,5.3864e-06},{1.2163e-05,1.2624e-05,1.2787e-05},
   {2.7192e-05,2.7653e-05,2.7882e-05},{3.9333e-05,3.8394e-05,4.0531e-05},
   {1.8135e-04,1.8645e-04,1.8584e-04},{5.9550e-05,6.0873e-05,6.1198e-05},
   {3.2741e-05,3.3415e-05,3.3590e-05},{1.8634e-05,1.9451e-05,1.9676e-05},
   {2.3941e-05,2.5412e-05,2.5677e-05},{3.4432e-05,3.6563e-05,3.6792e-05},
   {4.9735e-05,5.2440e-05,5.2613e-05},{7.7693e-05,8.1467e-05,8.1571e-05},
   {1.3683e-04,1.4341e-04,1.4369e-04},{2.9945e-04,3.1724e-04,3.1978e-04},
   {4.5823e-04,4.9030e-04,4.9681e-04},{7.9019e-04,8.5845e-04,8.7650e-04},
   {2.8270e-03,3.1442e-03,3.2741e-03},{3.9958e-03,4.4502e-03,4.6471e-03},
   {6.0765e-03,6.7814e-03,7.1121e-03},{7.3927e-03,8.2602e-03,8.6851e-03},
   {9.1895e-03,1.0284e-02,1.0849e-02},{1.0345e-02,1.1588e-02,1.2250e-02},
   {1.1734e-02,1.3158e-02,1.3944e-02},{1.5510e-02,1.7442e-02,1.8601e-02},
   {2.1463e-02,2.4241e-02,2.6103e-02},{3.1688e-02,3.6032e-02,3.9430e-02},
   {5.1496e-02,5.9300e-02,6.7048e-02},{9.8990e-02,1.1726e-01,1.4405e-01},
   {2.6617e-01,3.4549e-01,4.7630e-01},{6.0311e-01,7.4938e-01,8.9736e-01},
   {2.3423e+00,1.9835e+00,1.6822e+00},{1.8945e+00,1.7136e+00,1.4974e+00},
   {5.7167e-01,6.0592e-01,6.2994e-01},{1.8278e-01,2.0096e-01,2.1667e-01},
   {8.8663e-02,9.5928e-02,9.9502e-02},{5.2666e-02,5.6691e-02,5.7940e-02},
   {1.1798e-02,1.2615e-02,1.2789e-02},{2.6767e-03,2.8916e-03,2.9756e-03},
   {1.1799e-03,1.2816e-03,1.3243e-03},{6.6084e-04,7.2017e-04,7.4640e-04},
   {4.2115e-04,4.5987e-04,4.7767e-04},{1.8506e-04,2.0244e-04,2.1104e-04},
   {1.0268e-04,1.1230e-04,1.1734e-04},{4.4183e-05,4.8258e-05,5.0572e-05},
   {1.2944e-05,1.5121e-05,1.6444e-05},{7.7072e-06,9.0396e-06,9.9058e-06},
   {5.0936e-06,5.9853e-06,6.5945e-06},{2.6159e-06,3.0889e-06,3.4380e-06},
   {1.5415e-06,1.8304e-06,2.0570e-06},{8.9775e-07,1.0740e-06,1.2211e-06},
   {5.7179e-07,6.8936e-07,7.9266e-07},{2.7521e-07,3.3711e-07,3.9622e-07}};

 DL = wave - 4120.80;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<59;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4143_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[51] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
  -40.00, -30.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.50,
   -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.30,  -0.20,  -0.10,
    0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,   6.00,
    8.00,  10.00,  15.00,  20.00,  22.00,  24.00,  25.00,  26.00,  28.00,
   30.00,  40.00,  50.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[51][3] =
  {{4.8384e-07,6.3138e-07,7.7949e-07},{1.1246e-06,1.4416e-06,1.7118e-06},
   {1.8849e-06,2.3840e-06,2.7720e-06},{3.5263e-06,4.3672e-06,4.9498e-06},
   {6.6003e-06,7.9613e-06,8.7841e-06},{1.4999e-05,1.7358e-05,1.8435e-05},
   {8.1030e-05,8.5335e-05,8.5781e-05},{1.8897e-04,1.9414e-04,1.9157e-04},
   {5.6414e-04,5.6750e-04,5.4886e-04},{1.1997e-03,1.1900e-03,1.1385e-03},
   {3.5546e-03,3.4971e-03,3.3211e-03},{6.4213e-03,6.3261e-03,6.0027e-03},
   {1.3649e-02,1.3614e-02,1.3027e-02},{4.9245e-02,5.0694e-02,5.1454e-02},
   {5.0897e-02,5.0695e-02,4.9706e-02},{6.0507e-02,5.9451e-02,5.7499e-02},
   {8.1820e-02,8.0945e-02,7.9830e-02},{1.2264e-01,1.2466e-01,1.2731e-01},
   {1.4377e-01,1.4826e-01,1.5409e-01},{1.5729e-01,1.6108e-01,1.6839e-01},
   {1.6224e-01,1.6060e-01,1.6611e-01},{1.6609e-01,1.6200e-01,1.6647e-01},
   {1.7263e-01,1.6772e-01,1.7222e-01},{1.8151e-01,1.7774e-01,1.8380e-01},
   {2.0095e-01,2.0307e-01,2.1454e-01},{2.0835e-01,2.1328e-01,2.2667e-01},
   {2.1254e-01,2.2019e-01,2.3437e-01},{2.0479e-01,2.1194e-01,2.2391e-01},
   {1.9108e-01,1.9686e-01,2.0587e-01},{1.7528e-01,1.7989e-01,1.8624e-01},
   {9.8911e-02,1.0075e-01,1.0004e-01},{2.7913e-02,2.7872e-02,2.6629e-02},
   {1.0914e-02,1.0751e-02,1.0176e-02},{5.4051e-03,5.3133e-03,5.0310e-03},
   {3.1045e-03,3.0587e-03,2.9053e-03},{1.0821e-03,1.0783e-03,1.0316e-03},
   {5.0038e-04,5.0519e-04,4.8912e-04},{3.8908e-04,3.9536e-04,3.8404e-04},
   {2.9947e-04,3.0519e-04,2.9757e-04},{2.6972e-04,2.7566e-04,2.6976e-04},
   {2.5107e-04,2.5724e-04,2.5238e-04},{2.0938e-04,2.1523e-04,2.1220e-04},
   {1.8159e-04,1.8123e-04,1.7948e-04},{7.4593e-05,7.8935e-05,7.9733e-05},
   {3.0557e-05,3.3764e-05,3.4831e-05},{1.8540e-05,2.0980e-05,2.2083e-05},
   {6.7272e-06,8.0708e-06,8.8470e-06},{3.6377e-06,4.4641e-06,5.0119e-06},
   {1.9624e-06,2.4526e-06,2.8198e-06},{1.1767e-06,1.4891e-06,1.7476e-06},
   {5.0964e-07,6.5707e-07,8.0244e-07}};

 DL = wave - 4143.76;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<50;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4168_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[50] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -40.00, -37.00, -33.00,
  -30.00, -28.00, -27.00, -25.00, -22.00, -20.00, -15.00, -10.00,  -8.00,
   -6.00,  -3.00,  -2.50,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,
   -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[50][3] =
  {{6.9964e-07,8.5078e-07,9.8805e-07},{1.9126e-06,2.2387e-06,2.4376e-06},
   {3.3437e-06,3.8579e-06,4.1022e-06},{6.3106e-06,7.1784e-06,7.4752e-06},
   {1.3770e-05,1.5165e-05,1.5424e-05},{3.9022e-05,4.0615e-05,4.0822e-05},
   {1.6382e-04,1.6945e-04,1.6868e-04},{2.1789e-04,2.2532e-04,2.2400e-04},
   {4.1918e-04,4.3366e-04,4.3199e-04},{8.2598e-04,8.6583e-04,8.6478e-04},
   {1.1507e-03,1.1881e-03,1.2000e-03},{8.7889e-04,8.9880e-04,8.8867e-04},
   {3.6049e-04,3.6648e-04,3.5079e-04},{5.2602e-04,5.4863e-04,5.4338e-04},
   {5.5529e-04,5.7335e-04,5.6600e-04},{6.9050e-04,7.0414e-04,6.8630e-04},
   {1.1942e-03,1.2125e-03,1.1628e-03},{1.7095e-03,1.7278e-03,1.6559e-03},
   {2.9212e-03,2.9414e-03,2.8132e-03},{8.9372e-03,9.3497e-03,9.2674e-03},
   {1.2204e-02,1.2809e-02,1.2771e-02},{1.7690e-02,1.8654e-02,1.8761e-02},
   {2.7964e-02,2.9698e-02,3.0286e-02},{5.0710e-02,5.4498e-02,5.7014e-02},
   {6.8254e-02,7.3882e-02,7.8608e-02},{9.6471e-02,1.0539e-01,1.1480e-01},
   {1.4544e-01,1.6064e-01,1.8057e-01},{2.3773e-01,2.6450e-01,3.0587e-01},
   {3.1342e-01,3.4705e-01,4.0103e-01},{5.4600e-01,5.7293e-01,6.2322e-01},
   {6.7413e-01,6.7555e-01,6.9989e-01},{7.4964e-01,7.0486e-01,6.7689e-01},
   {5.6709e-01,5.3300e-01,4.9779e-01},{3.7168e-01,3.5498e-01,3.2913e-01},
   {2.4466e-01,2.3671e-01,2.1914e-01},{5.5512e-02,5.5206e-02,5.1812e-02},
   {1.0351e-02,1.0791e-02,1.0678e-02},{4.4906e-03,4.6949e-03,4.6654e-03},
   {2.4609e-03,2.5804e-03,2.5751e-03},{1.5371e-03,1.6166e-03,1.6189e-03},
   {6.2394e-04,6.5823e-04,6.6402e-04},{3.2326e-04,3.4361e-04,3.4945e-04},
   {1.2533e-04,1.3465e-04,1.3890e-04},{3.7761e-05,4.2997e-05,4.5690e-05},
   {1.3056e-05,1.5304e-05,1.6794e-05},{6.3388e-06,7.5338e-06,8.4201e-06},
   {3.6009e-06,4.3202e-06,4.8961e-06},{2.0295e-06,2.4563e-06,2.8244e-06},
   {1.2596e-06,1.5353e-06,1.7885e-06},{5.7994e-07,7.1592e-07,8.5489e-07}};

 DL = wave - 4168.97;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<49;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4437_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -57.00, -55.00, -54.00,
  -53.00, -51.00, -50.00, -49.00, -48.00, -46.00, -43.00, -40.00, -30.00,
  -25.00, -20.00, -15.00, -10.00,  -7.00,  -5.00,  -3.00,  -2.50,  -2.00,
   -1.80,  -1.60,  -1.50,  -1.40,  -1.20,  -1.00,  -0.80,  -0.60,  -0.40,
   -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{6.0916e-07,7.1270e-07,7.8084e-07},{1.4373e-06,1.6132e-06,1.6889e-06},
   {4.1812e-06,4.4232e-06,4.4914e-06},{7.7779e-06,8.1319e-06,8.1631e-06},
   {2.0641e-05,2.1143e-05,2.1078e-05},{7.8817e-05,8.0280e-05,7.9815e-05},
   {1.3901e-04,1.4381e-04,1.4400e-04},{3.2053e-04,3.4537e-04,3.5215e-04},
   {1.5585e-04,1.5573e-04,1.4994e-04},{8.4373e-05,8.6329e-05,8.4344e-05},
   {3.3140e-05,3.3742e-05,3.2367e-05},{5.4165e-05,5.6267e-05,5.5077e-05},
   {8.9716e-05,9.2588e-05,9.2048e-05},{9.7765e-05,1.0043e-04,1.0005e-04},
   {1.0576e-04,1.0740e-04,1.0686e-04},{1.1964e-04,1.2107e-04,1.2028e-04},
   {5.3600e-05,5.4919e-05,5.3769e-05},{7.7974e-05,7.9377e-05,7.7285e-05},
   {1.0446e-04,1.0591e-04,1.0274e-04},{1.5201e-04,1.5345e-04,1.4832e-04},
   {2.5301e-04,2.5483e-04,2.4583e-04},{5.3619e-04,5.4308e-04,5.2495e-04},
   {1.0528e-03,1.0789e-03,1.0482e-03},{1.9959e-03,2.0743e-03,2.0277e-03},
   {4.8620e-03,5.1759e-03,5.1739e-03},{6.8193e-03,7.2758e-03,7.3016e-03},
   {1.0260e-02,1.0985e-02,1.1092e-02},{1.2410e-02,1.3312e-02,1.3491e-02},
   {1.5318e-02,1.6471e-02,1.6769e-02},{1.7172e-02,1.8492e-02,1.8879e-02},
   {1.9386e-02,2.0911e-02,2.1418e-02},{2.5326e-02,2.7433e-02,2.8334e-02},
   {3.4491e-02,3.7581e-02,3.9295e-02},{4.9728e-02,5.4663e-02,5.8275e-02},
   {7.7828e-02,8.6797e-02,9.5803e-02},{1.3874e-01,1.5883e-01,1.8755e-01},
   {3.0825e-01,3.6841e-01,4.6315e-01},{5.2538e-01,6.1720e-01,7.3217e-01},
   {1.4038e+00,1.3271e+00,1.2489e+00},{1.5410e+00,1.3704e+00,1.2269e+00},
   {7.6613e-01,7.4551e-01,7.1342e-01},{3.1644e-01,3.2115e-01,3.1902e-01},
   {1.6395e-01,1.6694e-01,1.6318e-01},{9.8799e-02,1.0078e-01,9.7815e-02},
   {2.1945e-02,2.2520e-02,2.1869e-02},{4.7479e-03,4.9770e-03,4.9650e-03},
   {2.0910e-03,2.2051e-03,2.2094e-03},{1.1663e-03,1.2354e-03,1.2424e-03},
   {7.3987e-04,7.8615e-04,7.9295e-04},{3.1653e-04,3.3814e-04,3.4304e-04},
   {1.7234e-04,1.8459e-04,1.8811e-04},{7.1834e-05,7.7161e-05,7.9184e-05},
   {3.8029e-05,4.0936e-05,4.2243e-05},{1.5154e-05,1.6366e-05,1.7029e-05},
   {4.1568e-06,4.8098e-06,5.2168e-06},{2.4118e-06,2.8144e-06,3.0899e-06},
   {1.3884e-06,1.6360e-06,1.8208e-06},{8.7641e-07,1.0425e-06,1.1751e-06},
   {4.1543e-07,5.0361e-07,5.8190e-07}};

 DL = wave - 4437.55;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<58;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4713_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[67] =
{-280.00,-270.00,-260.00,-255.00,-250.00,-246.00,-244.00,-242.00,-240.00,
 -230.00,-220.00,-210.00,-206.00,-202.00,-198.00,-196.00,-194.00,-192.00,
 -188.00,-184.00,-180.00,-170.00,-160.00,-140.00,-120.00,-100.00, -80.00,
  -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
   -4.00,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,
    0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,   4.00,
    6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,  80.00,
  100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[67][3] =
  {{2.3895e-07,2.6427e-07,2.7693e-07},{2.4678e-07,2.7300e-07,2.8598e-07},
   {2.4606e-07,2.7323e-07,2.8651e-07},{2.4088e-07,2.6856e-07,2.8194e-07},
   {2.3620e-07,2.6509e-07,2.7908e-07},{8.4300e-07,8.7137e-07,8.8431e-07},
   {9.0508e-07,9.3396e-07,9.4767e-07},{9.8162e-07,1.0106e-06,1.0243e-06},
   {1.1096e-06,1.1391e-06,1.1524e-06},{3.1956e-07,3.5337e-07,3.6745e-07},
   {2.6074e-07,2.9207e-07,3.0617e-07},{2.9402e-07,3.2673e-07,3.4092e-07},
   {3.1199e-07,3.4556e-07,3.5984e-07},{3.4659e-07,3.8227e-07,3.9624e-07},
   {5.0016e-07,5.5170e-07,5.7112e-07},{7.5562e-06,8.3033e-06,8.2962e-06},
   {1.1073e-05,1.1140e-05,1.1151e-05},{6.2028e-06,6.2420e-06,6.2603e-06},
   {3.6291e-06,3.6652e-06,3.6794e-06},{2.7315e-06,2.7669e-06,2.7810e-06},
   {2.2699e-06,2.3054e-06,2.3193e-06},{1.7443e-06,1.7804e-06,1.7938e-06},
   {1.5362e-06,1.5731e-06,1.5857e-06},{1.4314e-06,1.4695e-06,1.4795e-06},
   {1.0128e-06,1.0519e-06,1.0571e-06},{1.4866e-06,1.5265e-06,1.5235e-06},
   {2.3536e-06,2.4023e-06,2.3886e-06},{4.1406e-06,4.2475e-06,4.2355e-06},
   {8.8511e-06,9.3040e-06,9.4111e-06},{1.4984e-05,1.6129e-05,1.6535e-05},
   {2.0926e-05,2.2866e-05,2.3637e-05},{3.1679e-05,3.5160e-05,3.6652e-05},
   {5.4838e-05,6.1651e-05,6.4710e-05},{1.2148e-04,1.3745e-04,1.4477e-04},
   {1.8956e-04,2.1437e-04,2.2578e-04},{3.3771e-04,3.8077e-04,4.0055e-04},
   {7.3119e-04,8.3083e-04,8.7992e-04},{2.8157e-03,3.2119e-03,3.4299e-03},
   {4.8981e-03,5.6065e-03,6.0316e-03},{1.0588e-02,1.2231e-02,1.3432e-02},
   {1.6118e-02,1.8784e-02,2.1082e-02},{2.7587e-02,3.2789e-02,3.8924e-02},
   {5.8675e-02,7.4275e-02,1.0811e-01},{2.2440e-01,3.4131e-01,4.8798e-01},
   {6.7665e-01,8.4871e-01,9.0060e-01},{2.0020e+00,1.7216e+00,1.3663e+00},
   {1.1044e+00,1.1856e+00,1.0902e+00},{2.7991e-01,3.2023e-01,3.8167e-01},
   {6.7756e-02,8.3544e-02,1.0687e-01},{3.2970e-02,3.7393e-02,4.2034e-02},
   {1.9799e-02,2.2134e-02,2.3797e-02},{8.3111e-03,9.1755e-03,9.6337e-03},
   {4.6030e-03,5.0603e-03,5.2811e-03},{1.1491e-03,1.2558e-03,1.3039e-03},
   {5.0132e-04,5.4936e-04,5.7316e-04},{2.8513e-04,3.1199e-04,3.2541e-04},
   {1.8410e-04,2.0132e-04,2.1002e-04},{8.2671e-05,9.0511e-05,9.4601e-05},
   {4.6518e-05,5.1100e-05,5.3571e-05},{2.0423e-05,2.2617e-05,2.3866e-05},
   {1.1306e-05,1.2596e-05,1.3361e-05},{4.8723e-06,5.4589e-06,5.8267e-06},
   {2.6601e-06,2.9874e-06,3.1959e-06},{8.2775e-07,1.0235e-06,1.1561e-06},
   {5.0899e-07,6.2609e-07,7.0891e-07},{3.4295e-07,4.1895e-07,4.7487e-07},
   {1.8388e-07,2.2149e-07,2.5127e-07}};

 DL = wave - 4713.20;
 if(DL < -280.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<66;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he5047_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] =
{-200.00,-160.00,-155.00,-147.00,-143.00,-140.00,-138.00,-136.00,-134.00,
 -131.00,-129.00,-127.00,-125.00,-123.00,-120.00,-115.00,-110.00,-100.00,
  -80.00, -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,
   -6.00,  -4.00,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,
   -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{1.2237e-06,1.2826e-06,1.2943e-06},{3.9438e-06,4.0088e-06,4.0124e-06},
   {4.7906e-06,4.8560e-06,4.8577e-06},{7.4292e-06,7.4971e-06,7.4962e-06},
   {1.0615e-05,1.0744e-05,1.0737e-05},{1.7328e-05,1.7564e-05,1.7625e-05},
   {3.9583e-05,4.0585e-05,4.0340e-05},{8.3527e-06,8.5529e-06,8.5623e-06},
   {9.5002e-06,9.5860e-06,9.5797e-06},{1.7906e-05,1.7949e-05,1.7906e-05},
   {4.9576e-06,5.0935e-06,5.0920e-06},{1.5982e-06,1.6658e-06,1.6508e-06},
   {2.2268e-06,2.3315e-06,2.3105e-06},{2.6825e-06,2.7665e-06,2.7451e-06},
   {3.0978e-06,3.1710e-06,3.1462e-06},{3.5283e-06,3.5835e-06,3.5524e-06},
   {3.8251e-06,3.8777e-06,3.8392e-06},{4.3971e-06,4.4400e-06,4.3823e-06},
   {5.9512e-06,5.9604e-06,5.8393e-06},{8.9116e-06,8.8799e-06,8.6378e-06},
   {1.7009e-05,1.7138e-05,1.6699e-05},{2.8050e-05,2.8779e-05,2.8263e-05},
   {3.8878e-05,4.0418e-05,3.9938e-05},{5.8476e-05,6.1722e-05,6.1423e-05},
   {9.9916e-05,1.0698e-04,1.0716e-04},{2.2100e-04,2.3853e-04,2.3989e-04},
   {3.4443e-04,3.7192e-04,3.7423e-04},{6.1230e-04,6.6022e-04,6.6416e-04},
   {1.3116e-03,1.4291e-03,1.4510e-03},{5.0329e-03,5.5169e-03,5.6654e-03},
   {8.7227e-03,9.6098e-03,9.9667e-03},{1.8723e-02,2.0883e-02,2.2231e-02},
   {2.8334e-02,3.1955e-02,3.4933e-02},{4.7879e-02,5.5304e-02,6.4661e-02},
   {9.9624e-02,1.2278e-01,1.7399e-01},{3.3922e-01,4.8935e-01,6.6647e-01},
   {9.2428e-01,1.0958e+00,1.1408e+00},{2.6994e+00,2.1234e+00,1.6425e+00},
   {1.6012e+00,1.5129e+00,1.3188e+00},{2.8538e-01,3.5415e-01,4.5316e-01},
   {1.0818e-01,1.2040e-01,1.3888e-01},{5.6328e-02,6.1072e-02,6.4642e-02},
   {3.4864e-02,3.7378e-02,3.8420e-02},{1.4967e-02,1.5888e-02,1.6030e-02},
   {8.3221e-03,8.8143e-03,8.8552e-03},{2.0842e-03,2.2017e-03,2.2074e-03},
   {8.9446e-04,9.5222e-04,9.6352e-04},{5.0836e-04,5.4109e-04,5.4779e-04},
   {3.2756e-04,3.4883e-04,3.5349e-04},{1.4634e-04,1.5631e-04,1.5890e-04},
   {8.1890e-05,8.7881e-05,8.9682e-05},{3.5566e-05,3.8556e-05,3.9650e-05},
   {1.9481e-05,2.1285e-05,2.2025e-05},{8.2375e-06,9.0790e-06,9.4713e-06},
   {4.4407e-06,4.9050e-06,5.1396e-06},{2.7380e-06,3.0221e-06,3.1751e-06},
   {1.6807e-06,1.8508e-06,1.9488e-06},{5.7882e-07,6.8938e-07,7.5638e-07},
   {2.9786e-07,3.5214e-07,3.8923e-07}};

 DL = wave - 5047.74;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<57;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he6678_15(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[53] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -55.00, -52.00, -49.00,
  -48.00, -47.00, -46.50, -46.00, -45.50, -45.00, -44.00, -43.00, -40.00,
  -35.00, -30.00, -20.00, -15.00, -10.00,  -6.00,  -4.00,  -2.00,  -1.00,
   -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
    0.80,   1.00,   1.50,   2.00,   3.00,   5.00,  10.00,  15.00,  20.00,
   30.00,  45.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[53][3] =
  {{3.6861e-07,3.6623e-07,3.5855e-07},{8.0810e-07,7.8579e-07,7.5826e-07},
   {1.3259e-06,1.2788e-06,1.2277e-06},{2.4504e-06,2.3527e-06,2.2541e-06},
   {4.6744e-06,4.4937e-06,4.3184e-06},{1.2715e-05,1.2362e-05,1.2026e-05},
   {1.9401e-05,1.8981e-05,1.8581e-05},{2.7918e-05,2.7439e-05,2.6973e-05},
   {5.1297e-05,5.0870e-05,5.0521e-05},{7.3364e-05,7.2518e-05,7.1471e-05},
   {1.5316e-04,1.6129e-04,1.7075e-04},{3.3788e-04,3.2455e-04,2.9236e-04},
   {5.8551e-05,6.4206e-05,7.2765e-05},{1.4719e-05,1.4272e-05,1.3938e-05},
   {9.7703e-06,9.0646e-06,8.2605e-06},{7.7435e-06,7.0407e-06,6.3122e-06},
   {7.4013e-06,6.6875e-06,5.9772e-06},{7.9137e-06,7.1190e-06,6.3534e-06},
   {1.0025e-05,9.0171e-06,8.0532e-06},{1.3437e-05,1.2101e-05,1.0823e-05},
   {2.9686e-05,2.6788e-05,2.4012e-05},{5.2729e-05,4.7557e-05,4.2624e-05},
   {1.1946e-04,1.0750e-04,9.6224e-05},{3.2798e-04,2.9591e-04,2.6555e-04},
   {7.3361e-04,6.6282e-04,5.9635e-04},{2.8938e-03,2.6317e-03,2.3979e-03},
   {1.1436e-02,1.0693e-02,1.0401e-02},{1.7881e-02,1.7128e-02,1.8080e-02},
   {3.2227e-02,3.2888e-02,4.4641e-02},{7.7591e-02,1.0084e-01,1.6174e-01},
   {3.9167e-01,4.7154e-01,4.9005e-01},{8.9873e-01,8.3381e-01,6.8813e-01},
   {1.4154e+00,1.0946e+00,8.0040e-01},{8.3228e-01,7.8267e-01,6.5750e-01},
   {1.4897e-01,2.0213e-01,2.7531e-01},{5.6197e-02,5.9306e-02,8.2949e-02},
   {2.9771e-02,2.9344e-02,3.2257e-02},{1.8746e-02,1.8007e-02,1.8063e-02},
   {8.2778e-03,7.8036e-03,7.4548e-03},{4.6793e-03,4.3931e-03,4.1508e-03},
   {2.1083e-03,1.9762e-03,1.8559e-03},{7.7766e-04,7.2954e-04,6.8439e-04},
   {1.9304e-04,1.8321e-04,1.7341e-04},{8.5763e-05,8.1758e-05,7.7678e-05},
   {4.7927e-05,4.5844e-05,4.3679e-05},{2.0832e-05,2.0042e-05,1.9181e-05},
   {8.8871e-06,8.6128e-06,8.2886e-06},{4.7023e-06,4.5834e-06,4.4285e-06},
   {2.5052e-06,2.4599e-06,2.3900e-06},{1.5252e-06,1.5074e-06,1.4720e-06},
   {9.2142e-07,9.1746e-07,9.0111e-07},{6.0538e-07,6.0691e-07,5.9923e-07},
   {3.0259e-07,3.0726e-07,3.0625e-07}};

 DL = wave - 6678.15;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<51;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}
