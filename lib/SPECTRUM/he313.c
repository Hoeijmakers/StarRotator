#include <stdio.h>
#include <math.h>
#include "spectrum.h"

float he4471_313(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[44] = {-5.00,-4.00,-3.50,-3.00,-2.50,-2.00,-1.80,-1.60,-1.55,
		 -1.50,-1.45,-1.40,-1.20,-1.00,-0.50,-0.30,-0.20,-0.15,
		 -0.10,-0.06,-0.04,-0.02,0.00,0.02,0.04,0.06,0.10,0.15,
		 0.20,0.22,0.25,0.30,0.35,0.40,0.60,0.80,1.00,1.50,2.00,
		 2.50,3.00,3.50,4.00,5.00};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {6.52e-14,6.27e-14,5.99e-14,5.69e-14};
 static float b2[4] = {4.51e-14,4.34e-14,4.11e-14,3.85e-14};
 static float prof[44][4] = {{10.40e-05,10.00e-05,9.54e-05,9.07e-05},
 {1.87e-04,1.79e-04,1.70e-04,1.62e-04},{2.72e-04,2.59e-04,2.46e-04,2.34e-04},
 {4.19e-04,3.97e-04,3.77e-04,3.60e-04},{7.15e-04,6.82e-04,6.51e-04,6.23e-04},
 {1.72e-03,1.66e-03,1.60e-03,1.53e-03},{2.55e-03,2.46e-03,2.35e-03,2.23e-03},
 {4.96e-03,4.68e-03,4.27e-03,3.67e-03},{6.49e-03,5.85e-03,5.01e-03,4.08e-03},
 {8.57e-03,7.10e-03,5.67e-03,4.41e-03},{9.79e-03,7.77e-03,6.04e-03,4.62e-03},
 {8.81e-03,7.47e-03,5.98e-03,4.66e-03},{3.52e-03,3.76e-03,3.83e-03,3.69e-03},
 {2.24e-03,2.46e-03,2.71e-03,2.90e-03},{6.09e-03,5.91e-03,6.22e-03,10.47e-03},
 {1.83e-02,2.03e-02,5.08e-02,23.30e-02},{4.94e-02,11.75e-02,42.31e-02,83.45e-02},
 {1.55e-01,4.98e-01,10.36e-01,13.40e-01},{8.66e-01,15.91e-01,19.44e-01,18.63e-01},
 {3.06,3.19,2.80,2.26},{4.42,3.88,3.11,2.39},{5.85,4.50,3.37,2.50},
 {6.52,4.77,3.48,2.55},{6.26,4.68,3.47,2.56},{5.11,4.24,3.32,2.52},
 {3.54,3.53,3.04,2.42},{1.29,2.10,2.36,2.14},{5.89e-01,9.59e-01,14.48e-01,16.45e-01},
 {7.27e-01,6.33e-01,8.52e-01,11.74e-01},{6.90e-01,5.59e-01,6.76e-01,9.90e-01},
 {5.00e-01,4.44e-01,4.88e-01,7.57e-01},{1.62e-01,2.28e-01,2.76e-01,4.56e-01},
 {4.89e-02,9.17e-02,14.94e-02,26.96e-02},{2.46e-02,3.42e-02,6.99e-02,14.82e-02},
 {8.32e-03,7.92e-03,7.76e-03,12.67e-03},{4.31e-03,4.09e-03,3.81e-03,4.02e-03},
 {2.64e-03,2.50e-03,2.30e-03,2.33e-03},{10.87e-04,10.33e-04,9.74e-04,9.32e-04},
 {5.85e-04,5.56e-04,5.29e-04,4.94e-04},{3.45e-04,3.29e-04,3.10e-04,2.91e-04},
 {2.31e-04,2.20e-04,2.08e-04,1.95e-04},{1.63e-04,1.56e-04,1.48e-04,1.38e-04},
 {1.21e-04,1.16e-04,1.09e-04,1.02e-04},{7.23e-05,6.96e-05,6.59e-05,6.18e-05}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4471.48;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -5.00) {
   p1 = b1[k]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL >= 5.00) {
   p1 = b2[k]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<43;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}


float he4922_313(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[49] = {-6.00,-5.00,-4.00,-3.50,-3.00,-2.50,-2.00,-1.80,
  -1.70,-1.60,-1.50,-1.45,-1.40,-1.35,-1.30,-1.25,-1.20,-1.10,-1.00,-0.50,
  -0.30,-0.20,-0.15,-0.10,-0.06,-0.04,-0.02,0.00,0.02,0.04,0.06,0.10,0.15,
  0.20,0.25,0.30,0.35,0.40,0.60,0.80,1.00,1.50,2.00,2.50,3.00,3.50,4.00,
  5.00,6.00};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {5.307e-14,4.721e-14,4.112e-14,3.548e-14};
 static float b2[4] = {6.175e-14,5.873e-14,5.497e-14,5.106e-14};
 static float prof[49][4] = {{7.15e-5,6.36e-5,5.54e-5,4.78e-5},
 {11.56e-5,10.37e-5,9.17e-5,8.06e-5},{2.33e-4,2.11e-4,1.90e-4,1.71e-4},
 {3.45e-4,3.15e-4,2.86e-4,2.60e-4},{5.33e-4,4.90e-4,4.50e-4,4.13e-4},
 {9.23e-4,8.58e-4,7.97e-4,7.42e-4},{2.00e-3,2.03e-3,1.93e-3,1.86e-3},
 {3.04e-3,2.95e-3,2.87e-3,2.76e-3},{3.87e-3,3.74e-3,3.62e-3,3.47e-3},
 {5.21e-3,5.01e-3,4.82e-3,4.49e-3},{7.92e-3,7.50e-3,6.78e-3,5.75e-3},
 {10.59e-3,9.44e-3,7.93e-3,6.35e-3},{14.00e-3,11.37e-3,8.91e-3,6.82e-3},
 {15.84e-3,12.32e-3,9.41e-3,7.10e-3},{14.37e-3,11.81e-3,9.31e-3,7.15e-3},
 {10.89e-3,10.12e-3,8.65e-3,6.97e-3},{7.95e-3,8.20e-3,7.71e-3,6.64e-3},
 {5.17e-3,5.68e-3,5.97e-3,5.82e-3},{4.30e-3,4.70e-3,5.02e-3,5.22e-3},
 {1.05e-2,1.04e-2,1.14e-2,2.40e-2},{3.19e-2,3.76e-2,10.58e-2,36.46e-2},
 {9.57e-2,23.60e-2,64.31e-2,104.10e-2},{3.05e-1,7.72e-1,13.13e-1,15.20e-1},
 {1.35,2.03,2.23,2.00},{3.50,3.45,2.95,2.31},{4.82,4.10,3.22,2.42},
 {5.91,4.57,3.41,2.50},{6.43,4.78,3.50,2.53},{6.20,4.69,3.47,2.52},
 {5.29,4.32,3.32,2.47},{4.03,3.74,3.08,2.38},{1.71,2.33,2.41,2.09},
 {4.26e-1,9.46e-1,14.75e-1,16.26e-1},{1.41e-1,3.11e-1,7.53e-1,11.40e-1},
 {7.56e-2,11.06e-2,33.09e-2,72.34e-2},{4.95e-2,5.54e-2,13.58e-2,41.87e-2},
 {3.54e-2,3.61e-2,6.00e-2,22.40e-2},{2.67e-2,2.63e-2,3.26e-2,11.36e-2},
 {1.15e-2,1.09e-2,1.06e-2,1.25e-2},{6.33e-3,5.92e-3,5.59e-3,5.61e-3},
 {3.96e-3,3.64e-3,3.39e-3,3.28e-3},{1.71e-3,1.59e-3,1.49e-3,1.41e-3},
 {9.20e-4,8.62e-4,8.01e-4,7.46e-4},{5.72e-4,5.37e-4,4.99e-4,4.61e-4},
 {3.87e-4,3.64e-4,3.39e-4,3.13e-4},{2.77e-4,2.61e-4,2.43e-4,2.25e-4},
 {2.06e-4,1.95e-4,1.82e-4,1.68e-4},{1.26e-4,1.19e-4,1.12e-4,1.04e-4},
 {8.38e-5,7.97e-5,7.46e-5,6.93e-5}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4921.93;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -5.00) {
   p1 = b1[k]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL >= 5.00) {
   p1 = b2[k]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<48;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}


