#include <stdio.h>
#include <math.h>
#include "spectrum.h"

float he4471_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[73] = {-80.0,-70.0,-60.0,-50.0,-45.0,-40.0,-35.0,-30.0,-25.0,
		 -20.0,-18.0,-16.0,-14.0,-12.0,-10.0,-8.0,-6.0,-5.0,-4.0,
		 -3.5,-3.0,-2.8,-2.6,-2.4,-2.2,-2.0,-1.8,-1.6,-1.4,-1.2,
		 -1.0,-0.8,-0.6,-0.4,-0.2,0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,
		 1.6,1.8,2.0,2.5,3.0,5.0,6.0,8.0,10.0,12.0,14.0,16.0,
		 18.0,20.0,25.0,30.0,35.0,40.0,44.0,44.8,45.2,45.6,46.0,
		 46.4,47.0,48.0,50.0,60.0,70.0,80.0};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {7.98e-12,8.58e-12,8.79e-12,8.72e-12};
 static float b2[4] = {1.24e-11,1.27e-11,1.26e-11,1.22e-11};
 static float prof[73][4] = {{1.18e-05,1.27e-05,1.30e-05,1.29e-05},
 {1.65e-05,1.75e-05,1.79e-05,1.76e-05},{2.41e-05,2.55e-05,2.58e-05,2.53e-05},
 {3.79e-05,3.97e-05,3.99e-05,3.88e-05},{4.92e-05,5.11e-05,5.11e-05,4.96e-05},
 {6.57e-05,6.78e-05,6.75e-05,6.52e-05},{9.12e-05,9.35e-05,9.26e-05,8.91e-05},
 {1.33e-04,1.35e-04,1.33e-04,1.28e-04},{2.07e-04,2.09e-04,2.04e-04,1.95e-04},
 {3.56e-04,3.56e-04,3.46e-04,3.29e-04},{4.60e-04,4.58e-04,4.44e-04,4.22e-04},
 {6.12e-04,6.08e-04,5.87e-04,5.57e-04},{8.47e-04,8.38e-04,8.07e-04,7.64e-04},
 {1.23e-03,1.21e-03,1.16e-03,1.10e-03},{1.93e-03,1.89e-03,1.82e-03,1.72e-03},
 {3.57e-03,3.46e-03,3.20e-03,2.90e-03},{7.06e-03,6.84e-03,6.54e-03,6.05e-03},
 {10.73e-03,10.62e-03,10.27e-03,9.65e-03},{1.90e-02,1.93e-02,1.91e-02,1.84e-02},
 {2.73e-02,2.79e-02,2.79e-02,2.71e-02},{4.09e-02,4.22e-02,4.21e-02,4.07e-02},
 {4.87e-02,5.03e-02,5.00e-02,4.82e-02},{5.81e-02,6.00e-02,5.95e-02,5.69e-02},
 {6.92e-02,7.12e-02,7.02e-02,6.66e-02},{8.09e-02,8.27e-02,8.11e-02,7.63e-02},
 {9.09e-02,9.21e-02,8.98e-02,8.41e-02},{9.52e-02,9.55e-02,9.30e-02,8.74e-02},
 {8.98e-02,8.97e-02,8.80e-02,8.49e-02},{7.71e-02,7.76e-02,7.67e-02,7.91e-02},
 {6.69e-02,6.82e-02,6.69e-02,7.41e-02},{6.71e-02,6.83e-02,6.57e-02,7.32e-02},
 {8.25e-02,8.13e-02,7.59e-02,8.10e-02},{1.18e-01,1.10e-01,1.00e-01,1.01e-01},
 {1.83e-01,1.60e-01,1.45e-01,1.37e-01},{2.86e-01,2.37e-01,2.17e-01,1.96e-01},
 {3.93e-01,3.30e-01,3.10e-01,2.77e-01},{4.43e-01,4.05e-01,3.96e-01,3.63e-01},
 {4.23e-01,4.27e-01,4.35e-01,4.20e-01},{3.51e-01,3.82e-01,4.05e-01,4.17e-01},
 {2.76e-01,3.10e-01,3.33e-01,3.59e-01},{2.13e-01,2.41e-01,2.58e-01,2.83e-01},
 {1.65e-01,1.84e-01,1.95e-01,2.14e-01},{1.29e-01,1.41e-01,1.47e-01,1.60e-01},
 {1.02e-01,1.10e-01,1.13e-01,1.20e-01},{8.21e-02,8.63e-02,8.74e-02,9.15e-02},
 {6.73e-02,6.97e-02,6.96e-02,7.15e-02},{4.26e-02,4.26e-02,4.16e-02,4.11e-02},
 {2.88e-02,2.80e-02,2.69e-02,2.57e-02},{9.13e-03,8.57e-03,7.95e-03,7.28e-03},
 {5.95e-03,5.56e-03,5.12e-03,4.63e-03},{2.83e-03,2.61e-03,2.50e-03,2.29e-03},
 {1.47e-03,1.44e-03,1.36e-03,1.26e-03},{8.66e-04,8.44e-04,7.97e-04,7.28e-04},
 {5.91e-04,5.80e-04,5.44e-04,4.95e-04},{4.22e-04,4.15e-04,3.89e-04,3.52e-04},
 {3.18e-04,3.13e-04,2.93e-04,2.64e-04},{2.55e-04,2.51e-04,2.35e-04,2.11e-04},
 {1.65e-04,1.61e-04,1.50e-04,1.34e-04},{11.80e-05,11.40e-05,10.50e-05,9.38e-05},
 {9.00e-05,8.62e-05,7.88e-05,6.96e-05},{6.97e-05,6.64e-05,6.05e-05,5.34e-05},
 {8.47e-05,8.25e-05,7.77e-05,7.10e-05},{1.19e-04,1.26e-04,1.28e-04,1.26e-04},
 {2.16e-04,2.52e-04,2.87e-04,3.24e-04},{8.95e-04,9.57e-04,9.99e-04,9.94e-04},
 {7.27e-04,7.36e-04,7.41e-04,7.51e-04},{4.63e-04,4.68e-04,4.68e-04,4.66e-04},
 {3.13e-04,3.13e-04,3.10e-04,3.04e-04},{2.14e-04,2.13e-04,2.10e-04,2.05e-04},
 {1.43e-04,1.41e-04,1.37e-04,1.33e-04},{5.67e-05,5.57e-05,5.36e-05,5.09e-05},
 {3.26e-05,3.26e-05,3.17e-05,3.03e-05},{2.04e-05,2.10e-05,2.08e-05,2.01e-05}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4471.48;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -80.00) {
   p1 = b1[k]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4471.48+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL >= 80.00) {
   p1 = b2[k]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4471.48+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<72;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}


float he4922_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[75] = {-100.0,-90.0,-80.0,-70.0,-60.0,-50.0,-45.0,-40.0,
 -35.0,-30.0,-25.0,-20.0,-18.0,-16.0,-14.0,-13.0,-12.5,-12.0,-11.5,-11.0,
 -10.0,-8.0,-6.0,-5.0,-4.0,-3.5,-3.0,-2.8,-2.6,-2.4,-2.2,-2.0,-1.8,-1.6,-1.4,
 -1.2,-1.0,-0.8,-0.6,-0.4,-0.2,0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.8,2.0,
 2.5,3.0,4.0,5.0,6.0,8.0,10.0,12.0,14.0,16.0,18.0,20.0,25.0,30.0,35.0,40.0,
 45.0,50.0,60.0,70.0,80.0,90.0,100.0};
 static float t[4] = {5000.0,10000.0,20000.0,40000.0};
 static float b1[4] = {9.81e-12,1.03e-11,1.03e-11,1.02e-11};
 static float b2[4] = {3.41e-11,3.98e-11,4.23e-11,4.20e-11};
 static float prof[75][4] = {{1.10e-5,1.15e-5,1.16e-5,1.14e-5},
 {1.45e-5,1.51e-5,1.51e-5,1.47e-5},{1.97e-5,2.03e-5,2.03e-5,1.97e-5},
 {2.79e-5,2.86e-5,2.83e-5,2.73e-5},{4.17e-5,4.24e-5,4.17e-5,4.00e-5},
 {6.73e-5,6.76e-5,6.60e-5,6.30e-5},{8.88e-5,8.87e-5,8.61e-5,8.21e-5},
 {1.21e-4,1.21e-4,1.10e-4,1.11e-4},{1.73e-4,1.70e-4,1.64e-4,1.55e-4},
 {2.52e-4,2.50e-4,2.34e-4,2.21e-4},{4.46e-4,4.29e-4,3.99e-4,3.58e-4},
 {8.45e-4,8.10e-4,7.50e-4,6.74e-4},{11.61e-4,11.14e-4,10.33e-4,9.28e-4},
 {1.71e-3,1.65e-3,1.53e-3,1.38e-3},{2.88e-3,2.83e-3,2.68e-3,2.47e-3},
 {4.16e-3,4.12e-3,3.95e-3,3.66e-3},{5.12e-3,5.10e-3,4.89e-3,4.54e-3},
 {5.96e-3,5.98e-3,5.80e-3,5.40e-3},{5.59e-3,5.72e-3,5.68e-3,5.41e-3},
 {4.05e-3,4.25e-3,4.34e-3,4.28e-3},{2.65e-3,2.62e-3,2.57e-3,2.50e-3},
 {3.59e-3,3.36e-3,3.04e-3,2.70e-3},{6.31e-3,5.88e-3,5.27e-3,4.55e-3},
 {10.70e-3,10.24e-3,9.44e-3,8.48e-3},{2.08e-2,2.07e-2,1.99e-2,1.87e-2},
 {3.03e-2,3.08e-2,3.01e-2,2.82e-2},{4.53e-2,4.65e-2,4.59e-2,4.53e-2},
 {5.31e-2,5.48e-2,5.42e-2,5.74e-2},{6.22e-2,6.42e-2,6.35e-2,6.78e-2},
 {7.20e-2,7.40e-2,7.32e-2,7.59e-2},{8.15e-2,8.33e-2,8.21e-2,8.11e-2},
 {8.88e-2,8.99e-2,8.81e-2,8.16e-2},{9.15e-2,9.15e-2,8.93e-2,7.70e-2},
 {8.74e-2,8.64e-2,8.44e-2,6.91e-2},{7.77e-2,7.63e-2,7.52e-2,6.12e-2},
 {6.81e-2,6.69e-2,6.69e-2,5.71e-2},{6.52e-2,6.39e-2,6.41e-2,5.82e-2},
 {7.26e-2,6.97e-2,6.91e-2,6.47e-2},{9.00e-2,8.46e-2,8.20e-2,7.71e-2},
 {11.65e-2,10.91e-2,10.29e-2,9.70e-2},{.158,.144,.134,.125},
 {.205,.187,.174,.161},{.243,.227,.214,.199},{.264,.255,.246,.234},
 {.267,.266,.265,.259},{.254,.261,.266,.268},{.224,.236,.246,.256},
 {.193,.206,.217,.230},{.166,.177,.186,.200},{.142,.151,.158,.171},
 {.122,.129,.134,.144},{.105,.110,.113,.120},
 {7.32e-2,7.40e-2,7.49e-2,7.76e-2},{5.25e-2,5.27e-2,5.13e-2,5.14e-2},
 {2.95e-2,2.87e-2,2.70e-2,2.58e-2},{1.83e-2,1.79e-2,1.61e-2,1.49e-2},
 {12.15e-3,11.41e-3,10.34e-3,9.21e-3},{6.12e-3,5.75e-3,5.24e-3,4.86e-3},
 {2.98e-3,2.92e-3,2.80e-3,2.65e-3},{1.90e-3,1.86e-3,1.78e-3,1.67e-3},
 {1.29e-3,1.26e-3,1.21e-3,1.14e-3},{9.23e-4,9.04e-4,8.64e-4,8.13e-4},
 {6.80e-4,6.68e-4,6.38e-4,6.01e-4},{5.32e-4,5.26e-4,5.05e-4,4.76e-4},
 {3.16e-4,3.13e-4,3.00e-4,2.84e-4},{2.05e-4,2.04e-4,1.96e-4,1.86e-4},
 {1.42e-4,1.42e-4,1.35e-4,1.28e-4},{10.38e-5,10.50e-5,10.25e-5,9.77e-5},
 {7.92e-5,8.06e-5,7.91e-5,7.57e-5},{6.22e-5,6.30e-5,6.32e-5,6.06e-5},
 {4.21e-5,4.45e-5,4.43e-5,4.28e-5},{3.20e-5,3.48e-5,3.51e-5,3.41e-5},
 {2.80e-5,3.13e-5,3.20e-5,3.13e-5},{3.00e-5,3.43e-5,3.56e-5,3.51e-5},
 {4.32e-5,5.04e-5,5.36e-5,5.32e-5}};

 if(T <= 5000.0) T = 5000.1;
 if(T >= 40000.0) T = 39999.9;

 DL = wave - 4921.93;

 for(i=0;i<3;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 if(DL <= -100.00) {
   p1 = b1[k]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   p2 = b1[k+1]*pow(4921.93+DL,3.0)*pow(-DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 if(DL >= 100.00) {
   p1 = b2[k]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   p2 = b2[k+1]*pow(4921.93+DL,3.0)*pow(DL,-2.5);
   return(p1 + (p2 - p1)*(T-t[k])/(t[k+1]-t[k]));
 }

 for(j=l;j<74;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4387_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[52] = {-200.00, -150.00, -100.00,  -80.00,  -60.00,  -40.00,
       -30.00,  -20.00,  -15.00,  -10.00,   -7.00,   -6.00,   -5.00,   -4.00,
	-3.00,   -2.00,   -1.50,   -1.00,   -0.80,   -0.60,   -0.50,   -0.40,
	-0.30,   -0.20,   -0.10,    0.10,    0.20,    0.40,    0.60,    0.80,
	 1.00,    1.50,    2.00,    3.00,    5.00,    7.00,   10.00,   15.00,
	20.00,   30.00,   40.00,   45.00,   48.00,   49.00,   50.00,   52.00,
	55.00,   60.00,   80.00,  100.00,  150.00,  200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[52][3] =          {{1.1087e-06,1.3865e-06,1.6153e-06},
   {2.5586e-06,3.0899e-06,3.4462e-06},{8.0476e-06,9.2514e-06,9.8049e-06},
   {1.9725e-05,2.1428e-05,2.1928e-05},{5.8602e-05,6.0977e-05,6.0932e-05},
   {1.8993e-04,1.9144e-04,1.8685e-04},{4.0382e-04,4.0143e-04,3.8716e-04},
   {1.1698e-03,1.1484e-03,1.0971e-03},{2.4734e-03,2.4292e-03,2.3229e-03},
   {7.1987e-03,7.2035e-03,7.0006e-03},{1.7906e-02,1.8502e-02,1.8619e-02},
   {2.3519e-02,2.4474e-02,2.5088e-02},{2.4003e-02,2.4254e-02,2.4333e-02},
   {2.6831e-02,2.6167e-02,2.4944e-02},{4.0600e-02,4.0379e-02,3.9643e-02},
   {5.8789e-02,5.7978e-02,5.7854e-02},{6.6990e-02,6.4102e-02,6.2489e-02},
   {8.9479e-02,8.6072e-02,8.4355e-02},{1.0956e-01,1.0859e-01,1.0994e-01},
   {1.3615e-01,1.4039e-01,1.4777e-01},{1.4947e-01,1.5682e-01,1.6753e-01},
   {1.6048e-01,1.7043e-01,1.8370e-01},{1.6753e-01,1.7881e-01,1.9320e-01},
   {1.6987e-01,1.8084e-01,1.9473e-01},{1.6794e-01,1.7723e-01,1.8932e-01},
   {1.5687e-01,1.6130e-01,1.6863e-01},{1.5078e-01,1.5305e-01,1.5843e-01},
   {1.4116e-01,1.4071e-01,1.4393e-01},{1.3541e-01,1.3403e-01,1.3676e-01},
   {1.3198e-01,1.3072e-01,1.3365e-01},{1.2905e-01,1.2838e-01,1.3159e-01},
   {1.1795e-01,1.1898e-01,1.2218e-01},{1.0091e-01,1.0280e-01,1.0509e-01},
   {6.5850e-02,6.7298e-02,6.7679e-02},{2.7352e-02,2.7325e-02,2.6597e-02},
   {1.2812e-02,1.2708e-02,1.2233e-02},{5.5196e-03,5.4165e-03,5.1635e-03},
   {2.0628e-03,2.0228e-03,1.9267e-03},{1.0121e-03,9.9685e-04,9.5286e-04},
   {3.5841e-04,3.5869e-04,3.4715e-04},{1.6826e-04,1.7075e-04,1.6731e-04},
   {1.2258e-04,1.2551e-04,1.2370e-04},{1.0302e-04,1.0615e-04,1.0501e-04},
   {9.7659e-05,1.0094e-04,1.0001e-04},{9.4188e-05,9.7644e-05,9.6874e-05},
   {8.1636e-05,8.4457e-05,8.3846e-05},{6.8886e-05,7.1650e-05,7.1407e-05},
   {5.5044e-05,5.7596e-05,5.7716e-05},{1.8121e-05,1.9769e-05,2.0256e-05},
   {9.8649e-06,1.1012e-05,1.1536e-05},{2.6442e-06,3.1508e-06,3.4851e-06},
   {1.1702e-06,1.4412e-06,1.6586e-06}};

 DL = wave - 4387.93;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<51;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3705_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[48] = {-80.00,-60.00,-40.00,-30.00,-20.00,-10.00, -7.00,
    -5.00, -3.00, -2.00, -1.50, -1.00, -0.80, -0.60, -0.40, -0.30, -0.20,
    -0.10,  0.10,  0.20,  0.40,  0.60,  0.80,  1.00,  1.50,  2.00,  3.00,
     4.00,  5.00,  6.00,  6.50,  7.00,  9.00, 11.00, 13.00, 15.00, 18.00,
    22.00, 25.00, 27.00, 28.00, 30.00, 33.00, 36.00, 40.00, 50.00, 60.00,
    80.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[48][3] =          {{1.9095e-05,2.4446e-05,2.9169e-05},
   {4.4472e-05,5.5137e-05,6.3097e-05},{1.4488e-04,1.7119e-04,1.8594e-04},
   {3.6379e-04,4.1031e-04,4.2723e-04},{1.7114e-03,1.8178e-03,1.8308e-03},
   {1.0722e-02,1.1180e-02,1.1174e-02},{2.1640e-02,2.2478e-02,2.2664e-02},
   {3.5374e-02,3.6472e-02,3.7205e-02},{5.9255e-02,5.9343e-02,6.0583e-02},
   {6.7942e-02,6.7574e-02,6.9375e-02},{7.2053e-02,7.1515e-02,7.3562e-02},
   {7.6403e-02,7.6175e-02,7.9031e-02},{7.7987e-02,7.8059e-02,8.1478e-02},
   {7.9200e-02,7.9612e-02,8.3636e-02},{7.9779e-02,8.0472e-02,8.4968e-02},
   {7.9762e-02,8.0541e-02,8.5163e-02},{7.9522e-02,8.0337e-02,8.4987e-02},
   {7.9046e-02,7.9844e-02,8.4422e-02},{7.7365e-02,7.8043e-02,8.2248e-02},
   {7.6326e-02,7.6871e-02,8.0788e-02},{7.3997e-02,7.4238e-02,7.7523e-02},
   {7.1499e-02,7.1485e-02,7.4232e-02},{6.9015e-02,6.8854e-02,7.1237e-02},
   {6.6611e-02,6.6420e-02,6.8603e-02},{6.0808e-02,6.0842e-02,6.2834e-02},
   {5.4849e-02,5.5111e-02,5.6784e-02},{4.3006e-02,4.3236e-02,4.3818e-02},
   {3.3819e-02,3.3831e-02,3.3591e-02},{2.7277e-02,2.7337e-02,2.6935e-02},
   {2.4227e-02,2.4518e-02,2.4498e-02},{2.3385e-02,2.3835e-02,2.4085e-02},
   {2.2472e-02,2.3073e-02,2.3513e-02},{1.6628e-02,1.7436e-02,1.7745e-02},
   {1.0896e-02,1.1355e-02,1.1383e-02},{7.1648e-03,7.4340e-03,7.5894e-03},
   {4.7828e-03,4.9600e-03,5.1599e-03},{2.8350e-03,3.1383e-03,3.0684e-03},
   {1.4974e-03,1.6498e-03,1.5804e-03},{1.0147e-03,1.0796e-03,1.0361e-03},
   {6.5337e-04,7.0860e-04,7.1684e-04},{5.6212e-04,6.1303e-04,6.2125e-04},
   {4.5195e-04,4.9756e-04,5.0892e-04},{3.4016e-04,4.0002e-04,3.9235e-04},
   {2.8120e-04,3.0251e-04,3.1078e-04},{2.0221e-04,2.2518e-04,2.3545e-04},
   {8.5461e-05,1.0178e-04,1.1138e-04},{4.9498e-05,6.0284e-05,6.7669e-05},
   {2.0623e-05,2.6052e-05,3.0641e-05}};

 DL = wave - 3705.00;
 if(DL < -80.0 || DL > 80.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<47;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he5875_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[68] = {-300.00,-250.00,-200.00,-150.00,-125.00,-100.00,
	 -80.00, -60.00, -40.00, -30.00, -20.00, -15.00, -12.00, -10.00,
	  -8.00,  -6.00,  -4.00,  -3.00,  -2.00,  -1.50,  -1.00,  -0.80,
	  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
	   0.80,   1.00,   1.50,   2.00,   2.50,   3.00,   4.00,   6.00,
	   8.00,  10.00,  12.00,  15.00,  20.00,  30.00,  40.00,  60.00,
	  80.00, 100.00, 150.00, 165.00, 180.00, 185.00, 188.00, 190.00,
	 191.00, 191.50, 192.00, 193.00, 195.00, 197.00, 200.00, 205.00,
	 210.00, 220.00, 230.00, 250.00, 275.00, 300.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[68][3] =
  {{1.0390e-07,1.2417e-07,1.3767e-07},{2.0168e-07,2.2892e-07,2.4637e-07},
   {3.3092e-07,3.6992e-07,3.9351e-07},{8.1695e-07,8.7859e-07,9.1264e-07},
   {1.2250e-06,1.3074e-06,1.3498e-06},{1.9913e-06,2.1091e-06,2.1626e-06},
   {3.2048e-06,3.3741e-06,3.4447e-06},{5.8469e-06,6.1196e-06,6.2160e-06},
   {1.3401e-05,1.3943e-05,1.4088e-05},{2.3900e-05,2.4803e-05,2.4983e-05},
   {5.3603e-05,5.5398e-05,5.5665e-05},{9.4660e-05,9.7618e-05,9.7930e-05},
   {1.4687e-04,1.5125e-04,1.5159e-04},{2.1463e-04,2.1930e-04,2.1857e-04},
   {3.3127e-04,3.3810e-04,3.3726e-04},{5.7907e-04,5.9157e-04,5.8957e-04},
   {1.2724e-03,1.2999e-03,1.2962e-03},{2.2254e-03,2.2737e-03,2.2699e-03},
   {4.8990e-03,5.0106e-03,5.0259e-03},{8.5959e-03,8.8099e-03,8.9038e-03},
   {1.9125e-02,1.9777e-02,2.0561e-02},{2.9822e-02,3.1273e-02,3.3921e-02},
   {5.4077e-02,5.8545e-02,7.2384e-02},{1.2881e-01,1.6207e-01,2.3003e-01},
   {6.6177e-01,6.8288e-01,6.7125e-01},{1.2903e+00,1.0916e+00,9.1322e-01},
   {1.0675e+00,1.0626e+00,9.4851e-01},{5.8374e-01,7.0381e-01,7.4305e-01},
   {2.6588e-01,2.8280e-01,3.3522e-01},{8.0403e-02,1.0244e-01,1.2963e-01},
   {3.2029e-02,3.7253e-02,4.8018e-02},{1.8656e-02,2.0326e-02,2.2730e-02},
   {7.6901e-03,8.1157e-03,8.3736e-03},{4.2287e-03,4.4233e-03,4.4950e-03},
   {2.6778e-03,2.7891e-03,2.8160e-03},{1.8493e-03,1.9214e-03,1.9331e-03},
   {1.0346e-03,1.0720e-03,1.0747e-03},{4.5832e-04,4.7381e-04,4.7369e-04},
   {2.5774e-04,2.6617e-04,2.6582e-04},{1.6501e-04,1.7031e-04,1.6999e-04},
   {1.1522e-04,1.1841e-04,1.1793e-04},{7.3945e-05,7.5856e-05,7.5488e-05},
   {4.1734e-05,4.2735e-05,4.2498e-05},{1.8620e-05,1.9038e-05,1.8921e-05},
   {1.0015e-05,1.0251e-05,1.0185e-05},{4.4245e-06,4.5354e-06,4.5087e-06},
   {2.4772e-06,2.5426e-06,2.5287e-06},{1.5795e-06,1.6224e-06,1.6138e-06},
   {6.9871e-07,7.1797e-07,7.1402e-07},{5.8016e-07,5.9616e-07,5.9283e-07},
   {5.0135e-07,5.1581e-07,5.1319e-07},{5.1356e-07,5.2948e-07,5.2711e-07},
   {5.8673e-07,6.1135e-07,6.1442e-07},{1.1040e-06,1.1617e-06,1.1652e-06},
   {4.6482e-06,6.2103e-06,9.1215e-06},{8.4791e-05,8.3272e-05,7.7866e-05},
   {4.9821e-05,5.2177e-05,5.4537e-05},{1.5782e-05,1.5849e-05,1.5879e-05},
   {8.3884e-06,8.4235e-06,8.4544e-06},{5.8078e-06,5.8225e-06,5.8204e-06},
   {4.1743e-06,4.1870e-06,4.1862e-06},{2.9170e-06,2.9277e-06,2.9257e-06},
   {2.2796e-06,2.2895e-06,2.2875e-06},{1.6072e-06,1.6160e-06,1.6140e-06},
   {1.2458e-06,1.2537e-06,1.2518e-06},{8.5287e-07,8.5953e-07,8.5780e-07},
   {5.9739e-07,6.0422e-07,6.0275e-07},{4.5012e-07,4.5460e-07,4.5333e-07}};

 DL = wave - 5875.70;
 if(DL < -300.0 || DL > 300.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<67;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3819_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
	 -40.00, -30.00, -20.00, -10.00,  -7.00,  -5.00,  -3.00,  -2.00,
	  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.30,  -0.20,  -0.10,
	   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,
	   3.00,   5.00,   7.00,   9.00,   9.50,  10.00,  10.50,  11.00,
	  12.00,  13.00,  15.00,  18.00,  20.00,  25.00,  30.00,  40.00,
	  43.00,  47.00,  48.00,  49.00,  50.00,  52.00,  55.00,  60.00,
	  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{1.0552e-06,1.4041e-06,1.7807e-06},{2.4197e-06,3.1857e-06,3.9033e-06},
   {4.0357e-06,5.2575e-06,6.3189e-06},{7.5254e-06,9.6213e-06,1.1289e-05},
   {1.4075e-05,1.7551e-05,2.0063e-05},{3.1913e-05,3.8234e-05,4.2110e-05},
   {1.3483e-04,1.4833e-04,1.5317e-04},{3.9874e-04,4.2000e-04,4.2103e-04},
   {1.1569e-03,1.1942e-03,1.2250e-03},{6.8373e-03,6.9722e-03,6.8191e-03},
   {1.5426e-02,1.5815e-02,1.5600e-02},{2.9857e-02,3.0753e-02,3.0790e-02},
   {6.6778e-02,6.6982e-02,6.6995e-02},{9.1158e-02,9.2064e-02,9.3955e-02},
   {1.0206e-01,1.0339e-01,1.0703e-01},{1.0594e-01,1.0595e-01,1.0961e-01},
   {1.0517e-01,1.0386e-01,1.0645e-01},{1.0408e-01,1.0137e-01,1.0264e-01},
   {1.0416e-01,1.0047e-01,1.0088e-01},{1.0500e-01,1.0116e-01,1.0154e-01},
   {1.0644e-01,1.0273e-01,1.0339e-01},{1.0828e-01,1.0503e-01,1.0633e-01},
   {1.1240e-01,1.1082e-01,1.1420e-01},{1.1443e-01,1.1382e-01,1.1832e-01},
   {1.1696e-01,1.1835e-01,1.2472e-01},{1.1650e-01,1.1936e-01,1.2672e-01},
   {1.1315e-01,1.1655e-01,1.2383e-01},{1.0752e-01,1.1082e-01,1.1723e-01},
   {8.9246e-02,9.1308e-02,9.4883e-02},{7.2019e-02,7.3304e-02,7.5192e-02},
   {4.7056e-02,4.7948e-02,4.8492e-02},{2.1364e-02,2.1339e-02,2.0610e-02},
   {1.0413e-02,1.0302e-02,9.7382e-03},{7.7836e-03,7.8091e-03,7.4829e-03},
   {8.5610e-03,8.6681e-03,8.4797e-03},{9.7748e-03,1.0026e-02,1.0094e-02},
   {1.0456e-02,1.0963e-02,1.1145e-02},{1.0036e-02,1.0603e-02,1.0799e-02},
   {7.9915e-03,8.3718e-03,8.4489e-03},{6.1726e-03,6.3973e-03,6.3808e-03},
   {3.9394e-03,3.9865e-03,3.9237e-03},{2.2093e-03,2.2401e-03,2.1909e-03},
   {1.6096e-03,1.6348e-03,1.5982e-03},{8.2781e-04,8.4514e-04,8.3127e-04},
   {4.6567e-04,4.8182e-04,4.8789e-04},{1.8042e-04,1.9847e-04,1.9007e-04},
   {1.0596e-04,1.1661e-04,1.1908e-04},{7.7599e-05,8.7039e-05,9.0271e-05},
   {7.4960e-05,8.4187e-05,8.7525e-05},{7.3416e-05,8.2356e-05,8.5752e-05},
   {7.0195e-05,7.8874e-05,8.2329e-05},{6.3494e-05,7.1701e-05,7.5116e-05},
   {5.4741e-05,6.2177e-05,6.5604e-05},{4.3414e-05,4.9753e-05,5.3048e-05},
   {1.5891e-05,1.9485e-05,2.1793e-05},{8.3348e-06,1.0523e-05,1.2109e-05},
   {4.4054e-06,5.6795e-06,6.7095e-06},{2.6123e-06,3.4055e-06,4.1095e-06},
   {1.1193e-06,1.4730e-06,1.8482e-06}};

 DL = wave - 3819.60;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<58;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3867_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[55] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
 -55.00, -52.00, -50.00, -48.00, -46.00, -44.00, -42.00, -40.00, -38.00,
 -36.00, -33.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
  -3.00,  -2.50,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,
  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,
   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,  80.00,
 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[55][3] =
  {{1.5482e-06,1.8773e-06,2.1889e-06},{4.2906e-06,5.0011e-06,5.4598e-06},
   {7.5141e-06,8.6415e-06,9.2184e-06},{1.4187e-05,1.6123e-05,1.6874e-05},
   {4.8837e-05,5.2186e-05,5.2910e-05},{9.9313e-05,1.0680e-04,1.0799e-04},
   {1.1983e-04,1.3093e-04,1.3053e-04},{1.3295e-04,1.4436e-04,1.4726e-04},
   {2.5674e-04,2.6975e-04,2.7087e-04},{3.7223e-04,3.8706e-04,3.9144e-04},
   {2.8158e-04,3.0064e-04,3.0285e-04},{1.9535e-04,2.1354e-04,2.1673e-04},
   {2.7727e-04,3.0029e-04,3.0492e-04},{4.4712e-04,4.7775e-04,4.8354e-04},
   {1.2849e-03,1.3323e-03,1.3625e-03},{1.3170e-03,1.3996e-03,1.4404e-03},
   {7.5618e-04,7.9835e-04,8.1086e-04},{4.9181e-04,5.2268e-04,5.2968e-04},
   {4.3192e-04,4.6335e-04,4.6995e-04},{5.3396e-04,5.7519e-04,5.8449e-04},
   {8.3047e-04,8.9063e-04,9.0140e-04},{1.7090e-03,1.8212e-03,1.8315e-03},
   {2.6286e-03,2.7814e-03,2.7864e-03},{4.6535e-03,4.8733e-03,4.8542e-03},
   {1.2375e-02,1.3480e-02,1.4113e-02},{1.6361e-02,1.7847e-02,1.8800e-02},
   {2.2645e-02,2.4743e-02,2.6277e-02},{3.3341e-02,3.6490e-02,3.9199e-02},
   {5.3632e-02,5.8737e-02,6.4139e-02},{6.7080e-02,7.3411e-02,8.0821e-02},
   {8.5949e-02,9.3848e-02,1.0422e-01},{1.1318e-01,1.2293e-01,1.3760e-01},
   {1.5336e-01,1.6471e-01,1.8495e-01},{1.8018e-01,1.9173e-01,2.1480e-01},
   {2.5040e-01,2.5881e-01,2.8479e-01},{2.9335e-01,2.9699e-01,3.2130e-01},
   {3.8139e-01,3.6839e-01,3.8053e-01},{4.3505e-01,4.0550e-01,3.9931e-01},
   {4.2446e-01,3.9148e-01,3.7238e-01},{3.6679e-01,3.4145e-01,3.1892e-01},
   {1.1552e-01,1.1540e-01,1.0857e-01},{2.4765e-02,2.5671e-02,2.5003e-02},
   {8.1176e-03,8.7893e-03,9.0345e-03},{4.3708e-03,4.7776e-03,4.9465e-03},
   {2.7104e-03,2.9819e-03,3.1033e-03},{1.1300e-03,1.2494e-03,1.3123e-03},
   {6.0465e-04,6.7232e-04,7.0618e-04},{1.3411e-04,1.6046e-04,1.7610e-04},
   {6.7479e-05,8.0845e-05,8.9712e-05},{2.6108e-05,3.1089e-05,3.4927e-05},
   {1.3104e-05,1.5589e-05,1.7698e-05},{7.5611e-06,9.0242e-06,1.0351e-05},
   {4.2923e-06,5.1597e-06,5.9958e-06},{2.6644e-06,3.2323e-06,3.8060e-06},
   {1.2155e-06,1.5073e-06,1.8243e-06}};

 DL = wave - 3867.50;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<54;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3888_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[73] = {-200.00,-150.00,-125.00,-100.00, -90.00, -85.00,
 -82.00, -80.00, -77.00, -75.00, -60.00, -40.00, -30.00, -25.00, -20.00,
 -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.50,  -2.00,  -1.80,  -1.60,
  -1.50,  -1.40,  -1.20,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,
   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,   6.00,
   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  50.00,  60.00,  80.00,
 100.00, 125.00, 150.00, 200.00, 250.00, 300.00, 350.00, 360.00, 370.00,
 375.00, 380.00, 383.00, 385.00, 387.00, 389.00, 401.00, 404.00, 410.00,
 420.00, 430.00, 450.00, 500.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[73][3] =
  {{1.9391e-07,2.1336e-07,2.2301e-07},{9.7142e-07,1.0010e-06,1.0120e-06},
   {1.6934e-06,1.7318e-06,1.7423e-06},{3.9178e-06,3.9704e-06,3.9778e-06},
   {7.0729e-06,7.1348e-06,7.1403e-06},{1.1923e-05,1.1989e-05,1.1989e-05},
   {2.2087e-05,2.2209e-05,2.2301e-05},{8.0698e-05,8.0766e-05,8.0400e-05},
   {1.8663e-06,1.9572e-06,1.9689e-06},{1.8618e-06,1.9440e-06,1.9414e-06},
   {2.9110e-06,3.0218e-06,3.0023e-06},{6.6992e-06,6.9172e-06,6.8472e-06},
   {1.1927e-05,1.2302e-05,1.2176e-05},{1.7129e-05,1.7669e-05,1.7498e-05},
   {2.6635e-05,2.7497e-05,2.7256e-05},{4.7086e-05,4.8696e-05,4.8328e-05},
   {1.0534e-04,1.0932e-04,1.0865e-04},{1.6418e-04,1.7078e-04,1.6987e-04},
   {2.9101e-04,3.0364e-04,3.0233e-04},{1.1417e-03,1.2003e-03,1.2014e-03},
   {1.6388e-03,1.7246e-03,1.7288e-03},{2.5489e-03,2.6866e-03,2.6998e-03},
   {3.1392e-03,3.3121e-03,3.3337e-03},{3.9616e-03,4.1851e-03,4.2216e-03},
   {4.4998e-03,4.7577e-03,4.8059e-03},{5.1560e-03,5.4570e-03,5.5216e-03},
   {6.9867e-03,7.4143e-03,7.5381e-03},{1.0006e-02,1.0665e-02,1.0929e-02},
   {1.5511e-02,1.6654e-02,1.7333e-02},{2.7406e-02,2.9947e-02,3.2273e-02},
   {6.0483e-02,6.9228e-02,8.6970e-02},{2.6050e-01,3.4346e-01,4.4025e-01},
   {7.5394e-01,8.4371e-01,8.4587e-01},{1.3964e+00,1.2508e+00,1.0611e+00},
   {5.4105e-01,6.1705e-01,6.5512e-01},{9.3689e-02,1.0441e-01,1.3279e-01},
   {4.0970e-02,4.3491e-02,4.6085e-02},{2.2462e-02,2.3502e-02,2.4168e-02},
   {1.4325e-02,1.4911e-02,1.5108e-02},{3.6089e-03,3.7339e-03,3.7310e-03},
   {9.2661e-04,9.5739e-04,9.5495e-04},{4.0560e-04,4.2272e-04,4.2432e-04},
   {2.2860e-04,2.3916e-04,2.4063e-04},{1.4639e-04,1.5360e-04,1.5484e-04},
   {6.4885e-05,6.8394e-05,6.9186e-05},{3.6250e-05,3.8312e-05,3.8853e-05},
   {1.5791e-05,1.6733e-05,1.7031e-05},{8.6646e-06,9.1930e-06,9.3834e-06},
   {5.3957e-06,5.7306e-06,5.8637e-06},{3.6412e-06,3.8713e-06,3.9702e-06},
   {1.9328e-06,2.0598e-06,2.1215e-06},{1.1122e-06,1.1925e-06,1.2352e-06},
   {4.6544e-07,5.1642e-07,5.4576e-07},{3.0871e-07,3.4415e-07,3.6587e-07},
   {1.6061e-07,1.8068e-07,1.9409e-07},{9.5983e-08,1.0895e-07,1.1814e-07},
   {6.2702e-08,7.1796e-08,7.8530e-08},{4.3623e-08,5.0376e-08,5.5547e-08},
   {4.0842e-08,4.7244e-08,5.2176e-08},{3.8375e-08,4.4474e-08,4.9197e-08},
   {3.7323e-08,4.3303e-08,4.7942e-08},{3.6676e-08,4.2655e-08,4.7315e-08},
   {3.7258e-08,4.3487e-08,4.8287e-08},{4.1641e-08,4.9651e-08,5.6442e-08},
   {1.5875e-06,2.0489e-06,2.3583e-06},{9.8741e-07,9.9765e-07,1.0094e-06},
   {2.3644e-07,2.4165e-07,2.4567e-07},{2.0628e-07,2.1146e-07,2.1554e-07},
   {1.6684e-07,1.7183e-07,1.7578e-07},{1.2935e-07,1.3410e-07,1.3788e-07},
   {1.0702e-07,1.1156e-07,1.1518e-07},{8.0667e-08,8.4818e-08,8.8161e-08},
   {5.0156e-08,5.3539e-08,5.6318e-08}};

 DL = wave - 3888.65;
 if(DL < -200.0 || DL > 500.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<72;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he3964_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[54] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
 -40.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.00,
  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,
   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,   4.00,   6.00,   6.50,
   7.00,   7.50,   8.00,   9.00,  10.00,  15.00,  20.00,  25.00,  30.00,
  40.00,  50.00,  60.00,  80.00,  85.00,  88.00,  90.00,  95.00, 100.00,
 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[54][3] =
  {{4.5814e-07,5.4757e-07,6.1797e-07},{1.0146e-06,1.1747e-06,1.2789e-06},
   {1.6555e-06,1.8853e-06,2.0148e-06},{4.4015e-06,4.7503e-06,4.9098e-06},
   {1.0015e-05,1.0530e-05,1.0704e-05},{2.0176e-05,2.0967e-05,2.1069e-05},
   {5.3448e-05,5.4583e-05,5.4005e-05},{1.6303e-04,1.6340e-04,1.5923e-04},
   {2.7340e-04,2.7196e-04,2.6343e-04},{5.2816e-04,5.2088e-04,5.0117e-04},
   {1.3088e-03,1.2820e-03,1.2261e-03},{2.1416e-03,2.0913e-03,1.9951e-03},
   {4.0370e-03,3.9226e-03,3.7279e-03},{1.9525e-02,1.8545e-02,1.7274e-02},
   {4.5202e-02,4.3151e-02,4.0355e-02},{8.1039e-02,7.7812e-02,7.3215e-02},
   {1.7781e-01,1.7286e-01,1.6543e-01},{2.6468e-01,2.5970e-01,2.5220e-01},
   {4.1494e-01,4.1255e-01,4.0920e-01},{6.5223e-01,6.5939e-01,6.6730e-01},
   {8.2862e-01,8.5428e-01,8.7782e-01},{7.6979e-01,8.0560e-01,8.4426e-01},
   {4.5649e-01,4.8092e-01,5.2526e-01},{3.2737e-01,3.3793e-01,3.6523e-01},
   {1.7804e-01,1.7529e-01,1.7749e-01},{1.0839e-01,1.0356e-01,9.9659e-02},
   {7.2322e-02,6.7934e-02,6.3552e-02},{5.1576e-02,4.7950e-02,4.4126e-02},
   {2.6793e-02,2.4582e-02,2.2164e-02},{1.6549e-02,1.5110e-02,1.3532e-02},
   {1.4150e-02,1.3925e-02,1.3676e-02},{7.3653e-03,7.5925e-03,7.6583e-03},
   {3.0563e-03,2.8293e-03,2.6005e-03},{2.7408e-03,2.5056e-03,2.2699e-03},
   {5.1362e-03,5.0866e-03,5.0198e-03},{6.9247e-03,7.3655e-03,7.5871e-03},
   {4.6622e-03,4.8597e-03,4.8993e-03},{3.0162e-03,3.0466e-03,2.9973e-03},
   {8.1706e-04,7.9315e-04,7.5675e-04},{3.7398e-04,3.6164e-04,3.4314e-04},
   {2.0642e-04,2.0016e-04,1.9002e-04},{1.2683e-04,1.2384e-04,1.1797e-04},
   {5.8275e-05,5.7844e-05,5.5634e-05},{3.1651e-05,3.1957e-05,3.1066e-05},
   {1.9316e-05,1.9811e-05,1.9461e-05},{9.2255e-06,9.6984e-06,9.6993e-06},
   {8.4079e-06,8.8909e-06,8.9294e-06},{1.5492e-05,1.6629e-05,1.6839e-05},
   {5.9954e-05,6.1343e-05,6.1652e-05},{1.9563e-05,1.9969e-05,2.0057e-05},
   {1.3246e-05,1.3605e-05,1.3677e-05},{4.4524e-06,4.7056e-06,4.7939e-06},
   {2.5133e-06,2.6983e-06,2.7796e-06},{6.1004e-07,7.1975e-07,7.8097e-07}};

 DL = wave - 3964.73;
 if(DL < -200.0 || DL > 200.0) return(0.0);

  for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<53;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4009_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[42] = {-80.00,-60.00,-40.00,-30.00,-20.00,-15.00,-13.00,
 -11.00,-10.00,-9.00,-8.00,-6.00,-3.00,-2.00,-1.50,-1.00,-0.80,-0.60,-0.40,
 -0.20,-0.10,0.10,0.20,0.40,0.60,0.80,1.00,2.00,4.00,6.00,8.00,10.00,12.00,
 14.00,15.00,16.00,18.00,20.00,25.00,30.00,40.00,60.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[42][3] =
  {{2.6861e-05,3.3487e-05,3.8811e-05},{6.3658e-05,7.6461e-05,8.4772e-05},
   {2.2341e-04,2.5280e-04,2.6413e-04},{7.7052e-04,8.2241e-04,8.3362e-04},
   {2.5807e-03,2.6929e-03,2.6901e-03},{5.6445e-03,5.8604e-03,5.8263e-03},
   {8.0006e-03,8.2965e-03,8.2432e-03},{1.1620e-02,1.2122e-02,1.2147e-02},
   {1.4048e-02,1.4622e-02,1.4691e-02},{1.7000e-02,1.7639e-02,1.7816e-02},
   {2.0555e-02,2.1271e-02,2.1598e-02},{2.9340e-02,3.0113e-02,3.0862e-02},
   {4.1617e-02,4.1720e-02,4.2874e-02},{4.5541e-02,4.5144e-02,4.6007e-02},
   {4.8287e-02,4.7717e-02,4.8528e-02},{5.1898e-02,5.1431e-02,5.2605e-02},
   {5.3540e-02,5.3219e-02,5.4705e-02},{5.5208e-02,5.5075e-02,5.6946e-02},
   {5.6799e-02,5.6864e-02,5.9132e-02},{5.8205e-02,5.8434e-02,6.1024e-02},
   {5.8793e-02,5.9079e-02,6.1783e-02},{5.9632e-02,6.0012e-02,6.2846e-02},
   {5.9973e-02,6.0344e-02,6.3166e-02},{6.0431e-02,6.0730e-02,6.3421e-02},
   {6.0592e-02,6.0772e-02,6.3260e-02},{6.0522e-02,6.0574e-02,6.2847e-02},
   {6.0286e-02,6.0233e-02,6.2331e-02},{5.7670e-02,5.7661e-02,5.9512e-02},
   {4.6182e-02,4.6811e-02,4.8052e-02},{3.0618e-02,3.1532e-02,3.2242e-02},
   {2.0308e-02,2.1012e-02,2.1279e-02},{1.3382e-02,1.3954e-02,1.3932e-02},
   {8.9137e-03,9.2645e-03,9.1774e-03},{6.1227e-03,6.3420e-03,6.2659e-03},
   {5.0963e-03,5.2873e-03,5.4591e-03},{4.3356e-03,4.5716e-03,4.6872e-03},
   {3.1556e-03,3.3557e-03,3.5342e-03},{2.4232e-03,2.7494e-03,2.7045e-03},
   {1.2838e-03,1.4282e-03,1.3804e-03},{8.1642e-04,8.6120e-04,8.1353e-04},
   {2.3283e-04,2.6202e-04,2.7332e-04},{6.3085e-05,7.5725e-05,8.4159e-05}};

 DL = wave - 4009.27;
 if(DL < -80.0 || DL > 60.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<41;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4023_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[51] = {-80.00,-60.00,-45.00,-37.00,-33.00,-30.00,-28.00,
   -27.00,-25.00,-22.00,-19.00,-17.00,-16.00,-15.00,-14.00,-12.00,-10.00,
    -7.00, -5.00, -3.00, -2.00, -1.50, -1.00, -0.80, -0.60, -0.40, -0.30,
    -0.20, -0.10,  0.10,  0.20,  0.40,  0.60,  0.80,  1.00,  1.50,  2.00,
     3.00,  4.00,  6.00,  8.00, 10.00, 13.00, 16.00, 20.00, 25.00, 30.00,
    40.00, 50.00, 60.00, 80.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[51][3] =
  {{3.7133e-05,4.3852e-05,4.8498e-05},{9.5164e-05,1.0718e-04,1.1236e-04},
   {3.2809e-04,3.4743e-04,3.5233e-04},{7.1163e-04,8.4249e-04,8.4759e-04},
   {9.9073e-04,1.0490e-03,1.1921e-03},{1.3376e-03,1.4143e-03,1.4230e-03},
   {1.6670e-03,1.7620e-03,1.7719e-03},{1.8804e-03,1.9871e-03,1.9992e-03},
   {2.4825e-03,2.7586e-03,2.7842e-03},{3.6279e-03,3.8132e-03,3.9119e-03},
   {4.6306e-03,4.8448e-03,4.9430e-03},{4.8166e-03,5.0178e-03,5.0982e-03},
   {4.8373e-03,4.9846e-03,4.9774e-03},{5.3511e-03,5.5218e-03,5.5147e-03},
   {6.3970e-03,6.7116e-03,6.8954e-03},{6.5495e-03,6.7291e-03,6.6918e-03},
   {7.2899e-03,7.4532e-03,7.3662e-03},{1.0985e-02,1.1028e-02,1.0770e-02},
   {1.3443e-02,1.3748e-02,1.3706e-02},{2.2452e-02,2.2878e-02,2.3112e-02},
   {3.1822e-02,3.2326e-02,3.3178e-02},{3.8846e-02,3.9454e-02,4.0936e-02},
   {4.8251e-02,4.8963e-02,5.1433e-02},{5.2822e-02,5.3550e-02,5.6565e-02},
   {5.7787e-02,5.8533e-02,6.2278e-02},{6.3425e-02,6.4128e-02,6.8568e-02},
   {6.6462e-02,6.7130e-02,7.1916e-02},{6.9628e-02,7.0243e-02,7.5379e-02},
   {7.2906e-02,7.3448e-02,7.8935e-02},{7.9699e-02,8.0062e-02,8.6234e-02},
   {8.3260e-02,8.3472e-02,8.9941e-02},{9.0517e-02,9.0391e-02,9.7276e-02},
   {9.7675e-02,9.7257e-02,1.0417e-01},{1.0438e-01,1.0343e-01,1.1022e-01},
   {1.1022e-01,1.0866e-01,1.1505e-01},{1.1890e-01,1.1607e-01,1.2034e-01},
   {1.1756e-01,1.1437e-01,1.1597e-01},{9.5463e-02,9.3525e-02,9.1738e-02},
   {6.9319e-02,6.8630e-02,6.6070e-02},{2.5566e-02,2.6943e-02,2.7080e-02},
   {1.4719e-02,1.5550e-02,1.5563e-02},{9.2526e-03,9.7324e-03,9.7804e-03},
   {4.9315e-03,5.4601e-03,5.4308e-03},{3.2299e-03,3.4012e-03,3.2364e-03},
   {1.8958e-03,2.0108e-03,1.8667e-03},{7.9573e-04,8.7315e-04,9.0101e-04},
   {4.1633e-04,4.6765e-04,4.9061e-04},{1.8258e-04,2.1050e-04,2.2709e-04},
   {9.9501e-05,1.1660e-04,1.2830e-04},{6.0832e-05,7.2159e-05,8.0706e-05},
   {2.7774e-05,3.3607e-05,3.8677e-05}};

 DL = wave - 4023.97;
 if(DL < -80.0 || DL > 80.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<50;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4026_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[56] = {-200.00,-150.00,-100.00, -80.00, -60.00, -40.00,
  -30.00, -20.00, -10.00, -7.00,  -5.00,  -3.00,  -2.00,  -1.50,  -1.00,
   -0.80,  -0.60,  -0.40, -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
    0.80,   1.00,   1.50,  2.00,   3.00,   5.00,   7.00,  10.00,  13.00,
   15.00,  16.00,  18.00, 19.00,  20.00,  22.00,  25.00,  30.00,  40.00,
   60.00,  70.00,  80.00, 85.00,  90.00,  93.00,  95.00,  98.00, 100.00,
  105.00, 110.00, 120.00,150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[56][3] =
  {{7.5418e-07,9.5628e-07,1.1405e-06},{1.7176e-06,2.1075e-06,2.4121e-06},
   {5.2237e-06,6.1428e-06,6.7123e-06},{9.6239e-06,1.1016e-05,1.1734e-05},
   {3.7942e-05,4.0196e-05,4.0985e-05},{1.1920e-04,1.2254e-04,1.2204e-04},
   {2.4610e-04,2.4902e-04,2.4452e-04},{6.7031e-04,6.6829e-04,6.4747e-04},
   {3.6527e-03,3.5983e-03,3.4542e-03},{8.5924e-03,8.5222e-03,8.2266e-03},
   {2.0306e-02,2.0035e-02,1.9285e-02},{5.4917e-02,5.5767e-02,5.5549e-02},
   {8.3310e-02,8.2386e-02,8.1746e-02},{9.8413e-02,9.3887e-02,9.0787e-02},
   {1.4965e-01,1.4405e-01,1.4098e-01},{1.9802e-01,1.9749e-01,1.9983e-01},
   {2.4900e-01,2.5825e-01,2.6885e-01},{2.5841e-01,2.7192e-01,2.8667e-01},
   {2.2400e-01,2.2959e-01,2.3903e-01},{2.0444e-01,2.0502e-01,2.1034e-01},
   {1.7611e-01,1.7166e-01,1.7261e-01},{1.6913e-01,1.6394e-01,1.6450e-01},
   {1.6278e-01,1.5864e-01,1.6046e-01},{1.5883e-01,1.5719e-01,1.6107e-01},
   {1.5298e-01,1.5392e-01,1.5925e-01},{1.4414e-01,1.4710e-01,1.5303e-01},
   {1.1372e-01,1.1850e-01,1.2324e-01},{8.3085e-02,8.6826e-02,8.9249e-02},
   {4.2456e-02,4.3452e-02,4.3291e-02},{1.4170e-02,1.3859e-02,1.3210e-02},
   {6.2681e-03,6.0193e-03,5.6233e-03},{2.4987e-03,2.3825e-03,2.2016e-03},
   {1.3006e-03,1.2452e-03,1.1498e-03},{9.6156e-04,9.2819e-04,8.6151e-04},
   {8.7640e-04,8.5197e-04,7.9277e-04},{1.0821e-03,1.0910e-03,1.0468e-03},
   {2.9853e-03,3.1067e-03,3.1942e-03},{2.7465e-03,2.8852e-03,2.9561e-03},
   {1.3158e-03,1.3359e-03,1.3223e-03},{7.1992e-04,7.2112e-04,7.0575e-04},
   {3.8012e-04,3.8094e-04,3.7241e-04},{1.6168e-04,1.6334e-04,1.6043e-04},
   {4.7081e-05,4.8803e-05,4.8753e-05},{2.6814e-05,2.8243e-05,2.8481e-05},
   {1.1905e-05,1.3077e-05,1.3411e-05},{1.0035e-05,1.1108e-05,1.1469e-05},
   {8.5741e-06,9.5538e-06,9.9262e-06},{7.8497e-06,8.7790e-06,9.1541e-06},
   {7.8157e-06,8.7324e-06,9.1167e-06},{7.5277e-06,8.3830e-06,8.7580e-06},
   {7.2114e-06,8.0361e-06,8.4086e-06},{6.4572e-06,7.2137e-06,7.5651e-06},
   {5.7763e-06,6.4599e-06,6.8117e-06},{4.6378e-06,5.2212e-06,5.5458e-06},
   {2.0448e-06,2.4167e-06,2.6712e-06},{8.5932e-07,1.0614e-06,1.2332e-06}};

 DL = wave - 4026.20;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<55;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4120_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[60] = {-200.00,-150.00,-125.00,-110.00,-100.00, -97.00,
 -95.00, -93.00, -90.00, -85.00, -80.00, -77.00, -75.00, -73.00, -70.00,
 -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
  -3.00,  -2.50,  -2.00,  -1.80,  -1.60,  -1.50,  -1.40,  -1.20,  -1.00,
  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
   0.80,   1.00,   2.00,   4.00,   6.00,   8.00,  10.00,  15.00,  20.00,
  30.00,  40.00,  50.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[60][3] =
  {{1.3872e-06,1.6235e-06,1.7818e-06},{4.4491e-06,4.8829e-06,5.1212e-06},
   {6.6582e-06,7.2859e-06,7.5943e-06},{1.7488e-05,1.8314e-05,1.8689e-05},
   {2.2520e-05,2.3697e-05,2.4194e-05},{2.2752e-05,2.4108e-05,2.4673e-05},
   {1.3057e-05,1.4407e-05,1.4905e-05},{1.1200e-05,1.2450e-05,1.2928e-05},
   {1.5820e-05,1.7314e-05,1.7895e-05},{3.8419e-05,4.0211e-05,4.0840e-05},
   {8.5544e-05,8.6535e-05,8.7765e-05},{1.3411e-04,1.4650e-04,1.4644e-04},
   {4.8270e-04,5.1152e-04,5.2924e-04},{1.9311e-04,2.0124e-04,2.0474e-04},
   {1.0340e-04,1.0686e-04,1.0790e-04},{5.7424e-05,5.9826e-05,6.0467e-05},
   {7.1808e-05,7.6061e-05,7.6913e-05},{1.0299e-04,1.0906e-04,1.0983e-04},
   {1.4791e-04,1.5555e-04,1.5620e-04},{2.3040e-04,2.4091e-04,2.4142e-04},
   {4.0438e-04,4.2252e-04,4.2358e-04},{8.7995e-04,9.2860e-04,9.3621e-04},
   {1.3410e-03,1.4285e-03,1.4474e-03},{2.2983e-03,2.4833e-03,2.5338e-03},
   {7.2453e-03,8.0531e-03,8.4893e-03},{9.9548e-03,1.1082e-02,1.1735e-02},
   {1.4536e-02,1.6217e-02,1.7286e-02},{1.7302e-02,1.9324e-02,2.0671e-02},
   {2.0940e-02,2.3418e-02,2.5159e-02},{2.3206e-02,2.5971e-02,2.7973e-02},
   {2.5860e-02,2.8965e-02,3.1287e-02},{3.2740e-02,3.6741e-02,3.9961e-02},
   {4.2772e-02,4.8110e-02,5.2804e-02},{5.8202e-02,6.5645e-02,7.2942e-02},
   {8.3636e-02,9.4620e-02,1.0694e-01},{1.2962e-01,1.4696e-01,1.6984e-01},
   {2.2319e-01,2.5156e-01,2.9535e-01},{3.0736e-01,3.4134e-01,3.9673e-01},
   {6.1154e-01,6.2066e-01,6.5813e-01},{8.0624e-01,7.6625e-01,7.6203e-01},
   {9.2015e-01,8.2625e-01,7.5953e-01},{6.3291e-01,5.9352e-01,5.4582e-01},
   {3.6723e-01,3.6231e-01,3.4081e-01},{2.2080e-01,2.2422e-01,2.1432e-01},
   {4.3561e-02,4.5936e-02,4.5380e-02},{9.6405e-03,1.0252e-02,1.0307e-02},
   {3.6619e-03,3.9705e-03,4.1011e-03},{2.0379e-03,2.2170e-03,2.2973e-03},
   {1.2912e-03,1.4091e-03,1.4646e-03},{5.6038e-04,6.1506e-04,6.4311e-04},
   {3.0946e-04,3.4007e-04,3.5661e-04},{1.3312e-04,1.4595e-04,1.5344e-04},
   {4.0695e-05,4.7508e-05,5.1634e-05},{2.3500e-05,2.7561e-05,3.0233e-05},
   {1.5528e-05,1.8205e-05,2.0062e-05},{7.9883e-06,9.3843e-06,1.0435e-05},
   {4.7061e-06,5.5537e-06,6.2336e-06},{2.7353e-06,3.2520e-06,3.6933e-06},
   {1.7368e-06,2.0825e-06,2.3929e-06},{8.2997e-07,1.0134e-06,1.1918e-06}};

 DL = wave - 4120.80;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<59;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4143_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[51] = {-200.00,-150.00,-125.00,-100.00, -80.00, -60.00,
  -40.00, -30.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,  -3.00,  -2.50,
   -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.30,  -0.20,  -0.10,
    0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,   4.00,   6.00,
    8.00,  10.00,  15.00,  20.00,  22.00,  24.00,  25.00,  26.00,  28.00,
   30.00,  40.00,  50.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[51][3] =
  {{1.4575e-06,1.8957e-06,2.3418e-06},{3.3646e-06,4.3172e-06,5.1417e-06},
   {5.6460e-06,7.1509e-06,8.3419e-06},{1.0643e-05,1.3178e-05,1.4974e-05},
   {2.0229e-05,2.4308e-05,2.6837e-05},{4.8014e-05,5.4939e-05,5.8109e-05},
   {2.6479e-04,2.7781e-04,2.7778e-04},{5.9981e-04,6.3836e-04,6.2834e-04},
   {1.8142e-03,1.8370e-03,1.7870e-03},{3.8150e-03,3.8564e-03,3.7471e-03},
   {1.0430e-02,1.0658e-02,1.0499e-02},{1.6976e-02,1.7468e-02,1.7427e-02},
   {2.8161e-02,2.9010e-02,2.9398e-02},{4.6499e-02,4.6547e-02,4.6927e-02},
   {5.1147e-02,5.1039e-02,5.1312e-02},{5.7381e-02,5.7411e-02,5.8097e-02},
   {6.4698e-02,6.5055e-02,6.6710e-02},{7.0931e-02,7.1201e-02,7.3594e-02},
   {7.2395e-02,7.2239e-02,7.4427e-02},{7.3279e-02,7.2454e-02,7.4074e-02},
   {7.4052e-02,7.2519e-02,7.3483e-02},{7.4598e-02,7.2799e-02,7.3535e-02},
   {7.5344e-02,7.3373e-02,7.4004e-02},{7.6250e-02,7.4230e-02,7.4931e-02},
   {7.8307e-02,7.6731e-02,7.8163e-02},{7.9796e-02,7.8514e-02,8.0408e-02},
   {8.2972e-02,8.2471e-02,8.5386e-02},{8.5669e-02,8.5982e-02,8.9818e-02},
   {8.7461e-02,8.8420e-02,9.2829e-02},{8.8160e-02,8.9536e-02,9.4143e-02},
   {7.9631e-02,8.0979e-02,8.3929e-02},{4.9760e-02,5.0737e-02,5.1421e-02},
   {2.7124e-02,2.7847e-02,2.7838e-02},{1.5536e-02,1.5850e-02,1.5606e-02},
   {9.4533e-03,9.5910e-03,9.3625e-03},{3.4393e-03,3.4829e-03,3.3706e-03},
   {1.6036e-03,1.6240e-03,1.5797e-03},{1.2410e-03,1.2640e-03,1.2338e-03},
   {9.6400e-04,9.8074e-04,9.6032e-04},{8.6352e-04,8.8448e-04,8.6843e-04},
   {7.8846e-04,8.1025e-04,7.9839e-04},{6.6109e-04,6.8174e-04,6.7447e-04},
   {5.5449e-04,5.7396e-04,5.6908e-04},{2.3539e-04,2.4981e-04,2.5088e-04},
   {9.7690e-05,1.0737e-04,1.1292e-04},{5.8177e-05,6.3973e-05,6.8400e-05},
   {2.0827e-05,2.4789e-05,2.7180e-05},{1.1095e-05,1.3544e-05,1.5239e-05},
   {5.9423e-06,7.3970e-06,8.5284e-06},{3.5554e-06,4.4823e-06,5.2737e-06},
   {1.5431e-06,1.9799e-06,2.4187e-06}};

 DL = wave - 4143.76;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<50;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4168_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[50] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -40.00, -37.00, -33.00,
  -30.00, -28.00, -27.00, -25.00, -22.00, -20.00, -15.00, -10.00,  -8.00,
   -6.00,  -3.00,  -2.50,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,
   -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[50][3] =
  {{2.0802e-06,2.5302e-06,2.9507e-06},{5.6419e-06,6.5937e-06,7.2132e-06},
   {9.8756e-06,1.1364e-05,1.2134e-05},{1.8822e-05,2.1318e-05,2.2265e-05},
   {4.3706e-05,4.7833e-05,4.8843e-05},{1.1893e-04,1.5754e-04,1.5834e-04},
   {5.4154e-04,5.5314e-04,5.5355e-04},{7.0407e-04,7.5276e-04,7.4929e-04},
   {1.2762e-03,1.3457e-03,1.3660e-03},{1.8181e-03,1.9054e-03,1.9417e-03},
   {1.9470e-03,2.0097e-03,2.0277e-03},{2.0967e-03,2.1896e-03,2.2232e-03},
   {1.2060e-03,1.2408e-03,1.2134e-03},{1.4228e-03,1.5046e-03,1.5216e-03},
   {1.5911e-03,1.6715e-03,1.6826e-03},{1.9977e-03,2.0475e-03,2.0120e-03},
   {3.3326e-03,3.3577e-03,3.2320e-03},{4.6490e-03,4.6588e-03,4.4600e-03},
   {7.6417e-03,7.6083e-03,7.2610e-03},{1.7255e-02,1.8004e-02,1.8260e-02},
   {2.1945e-02,2.2955e-02,2.3472e-02},{2.8848e-02,3.0268e-02,3.1284e-02},
   {3.9510e-02,4.1592e-02,4.3605e-02},{5.6946e-02,6.0113e-02,6.4211e-02},
   {6.7003e-02,7.0758e-02,7.6234e-02},{7.9604e-02,8.4025e-02,9.1326e-02},
   {9.5429e-02,1.0053e-01,1.1015e-01},{1.1518e-01,1.2078e-01,1.3313e-01},
   {1.2668e-01,1.3237e-01,1.4611e-01},{1.5283e-01,1.5805e-01,1.7415e-01},
   {1.6724e-01,1.7173e-01,1.8848e-01},{1.9692e-01,1.9867e-01,2.1496e-01},
   {2.2351e-01,2.2107e-01,2.3414e-01},{2.4108e-01,2.3424e-01,2.4202e-01},
   {2.4571e-01,2.3584e-01,2.3794e-01},{1.5470e-01,1.4935e-01,1.4152e-01},
   {4.5046e-02,4.4846e-02,4.2261e-02},{1.4241e-02,1.4998e-02,1.5022e-02},
   {7.8546e-03,8.2775e-03,8.2979e-03},{4.9014e-03,5.1739e-03,5.1952e-03},
   {1.9839e-03,2.1020e-03,2.1726e-03},{1.0226e-03,1.1302e-03,1.1060e-03},
   {3.9480e-04,4.2056e-04,4.3311e-04},{1.3045e-04,1.4644e-04,1.5410e-04},
   {4.0875e-05,4.7589e-05,5.2052e-05},{1.9479e-05,2.3053e-05,2.5741e-05},
   {1.0964e-05,1.3115e-05,1.4869e-05},{6.1420e-06,7.4173e-06,8.5384e-06},
   {3.8002e-06,4.6229e-06,5.3927e-06},{1.7453e-06,2.1497e-06,2.5705e-06}};

 DL = wave - 4168.97;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<49;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4437_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -57.00, -55.00, -54.00,
  -53.00, -51.00, -50.00, -49.00, -48.00, -46.00, -43.00, -40.00, -30.00,
  -25.00, -20.00, -15.00, -10.00,  -7.00,  -5.00,  -3.00,  -2.50,  -2.00,
   -1.80,  -1.60,  -1.50,  -1.40,  -1.20,  -1.00,  -0.80,  -0.60,  -0.40,
   -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{1.8396e-06,2.1483e-06,2.3568e-06},{4.4944e-06,5.0232e-06,5.2485e-06},
   {1.2917e-05,1.3629e-05,1.3811e-05},{2.4351e-05,2.5392e-05,2.5441e-05},
   {6.4015e-05,6.5761e-05,6.5605e-05},{2.4826e-04,2.6003e-04,2.6348e-04},
   {4.0105e-04,4.3000e-04,4.4500e-04},{4.9790e-04,5.1972e-04,5.3517e-04},
   {3.4316e-04,3.5438e-04,3.5536e-04},{2.4660e-04,2.5999e-04,2.6228e-04},
   {1.1912e-04,1.2112e-04,1.1650e-04},{1.6129e-04,1.6667e-04,1.6399e-04},
   {2.6257e-04,2.7892e-04,2.8416e-04},{2.8949e-04,3.0235e-04,3.0577e-04},
   {3.1805e-04,3.2849e-04,3.3042e-04},{3.5935e-04,3.6596e-04,3.6561e-04},
   {1.8549e-04,1.9035e-04,1.8703e-04},{2.3331e-04,2.3647e-04,2.3047e-04},
   {3.0891e-04,3.1142e-04,3.0236e-04},{4.4560e-04,4.4721e-04,4.3269e-04},
   {7.3514e-04,7.3763e-04,7.1265e-04},{1.5369e-03,1.5572e-03,1.5090e-03},
   {2.9743e-03,3.0548e-03,2.9749e-03},{4.7667e-03,5.0524e-03,5.0719e-03},
   {1.1409e-02,1.2174e-02,1.2392e-02},{1.5334e-02,1.6410e-02,1.6816e-02},
   {2.1695e-02,2.3307e-02,2.4108e-02},{2.5397e-02,2.7337e-02,2.8415e-02},
   {3.0128e-02,3.2499e-02,3.3978e-02},{3.3000e-02,3.5641e-02,3.7388e-02},
   {3.6300e-02,3.9256e-02,4.1332e-02},{4.4553e-02,4.8318e-02,5.1312e-02},
   {5.5906e-02,6.0825e-02,6.5283e-02},{7.2056e-02,7.8667e-02,8.5545e-02},
   {9.5932e-02,1.0507e-01,1.1607e-01},{1.3274e-01,1.4558e-01,1.6359e-01},
   {1.9153e-01,2.0906e-01,2.3763e-01},{2.3325e-01,2.5266e-01,2.8681e-01},
   {3.4748e-01,3.6362e-01,4.0113e-01},{4.1602e-01,4.2329e-01,4.5418e-01},
   {5.2852e-01,5.0647e-01,5.0939e-01},{5.3104e-01,4.9375e-01,4.7318e-01},
   {4.3752e-01,4.0826e-01,3.8235e-01},{3.2821e-01,3.1126e-01,2.8933e-01},
   {8.4404e-02,8.4121e-02,7.9124e-02},{1.8632e-02,1.8973e-02,1.8252e-02},
   {7.8641e-03,8.0481e-03,7.8136e-03},{3.6618e-03,3.8709e-03,3.8911e-03},
   {2.2997e-03,2.4447e-03,2.4674e-03},{9.7121e-04,1.0435e-03,1.0618e-03},
   {5.2628e-04,5.6685e-04,5.7914e-04},{2.1646e-04,2.3457e-04,2.4180e-04},
   {1.1395e-04,1.2365e-04,1.2825e-04},{4.5282e-05,4.9194e-05,5.1421e-05},
   {1.2606e-05,1.4576e-05,1.5856e-05},{7.2008e-06,8.4125e-06,9.2827e-06},
   {4.1348e-06,4.8755e-06,5.4530e-06},{2.6146e-06,3.1098e-06,3.5200e-06},
   {1.2498e-06,1.5118e-06,1.7493e-06}};

 DL = wave - 4437.55;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<58;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he4713_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[67] =
{-280.00,-270.00,-260.00,-255.00,-250.00,-246.00,-244.00,-242.00,-240.00,
 -230.00,-220.00,-210.00,-206.00,-202.00,-198.00,-196.00,-194.00,-192.00,
 -188.00,-184.00,-180.00,-170.00,-160.00,-140.00,-120.00,-100.00, -80.00,
  -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,  -6.00,
   -4.00,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,  -0.10,
    0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,   4.00,
    6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,  80.00,
  100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[67][3] =
  {{7.2319e-07,7.9763e-07,8.3599e-07},{7.4988e-07,8.2645e-07,8.6545e-07},
   {7.5382e-07,8.3265e-07,8.7222e-07},{7.4005e-07,8.2199e-07,8.6253e-07},
   {7.8381e-07,8.7311e-07,9.1653e-07},{2.5502e-06,2.6355e-06,2.6741e-06},
   {2.7317e-06,2.8173e-06,2.8568e-06},{2.9672e-06,3.0494e-06,3.0892e-06},
   {3.3614e-06,3.4482e-06,3.4894e-06},{1.5128e-06,1.6260e-06,1.6625e-06},
   {8.2142e-07,9.0934e-07,9.4935e-07},{9.4146e-07,1.0339e-06,1.0739e-06},
   {1.0266e-06,1.1243e-06,1.1649e-06},{1.2253e-06,1.3388e-06,1.3808e-06},
   {2.3960e-06,2.6501e-06,2.7470e-06},{3.9873e-05,4.3499e-05,4.4304e-05},
   {3.5093e-05,3.5835e-05,3.6150e-05},{1.9243e-05,1.9518e-05,1.9622e-05},
   {1.1188e-05,1.1293e-05,1.1335e-05},{8.3584e-06,8.4539e-06,8.4916e-06},
   {6.9245e-06,7.0170e-06,7.0529e-06},{5.3058e-06,5.3946e-06,5.4268e-06},
   {4.6727e-06,4.7589e-06,4.7868e-06},{4.3654e-06,4.4436e-06,4.4583e-06},
   {3.1611e-06,3.2282e-06,3.2216e-06},{4.5880e-06,4.6358e-06,4.5967e-06},
   {7.2065e-06,7.2623e-06,7.1883e-06},{1.2510e-05,1.2746e-05,1.2698e-05},
   {2.6251e-05,2.7646e-05,2.8075e-05},{4.4087e-05,4.7726e-05,4.9215e-05},
   {6.1549e-05,6.7643e-05,7.0323e-05},{9.3578e-05,1.0419e-04,1.0907e-04},
   {1.6308e-04,1.8316e-04,1.9263e-04},{3.6381e-04,4.0908e-04,4.3062e-04},
   {5.6888e-04,6.3803e-04,6.7083e-04},{9.5092e-04,1.0780e-03,1.1448e-03},
   {2.0732e-03,2.3535e-03,2.5075e-03},{7.6045e-03,8.6714e-03,9.3461e-03},
   {1.2819e-02,1.4668e-02,1.5952e-02},{2.6092e-02,3.0085e-02,3.3402e-02},
   {3.8014e-02,4.4109e-02,4.9853e-02},{6.0523e-02,7.1043e-02,8.3151e-02},
   {1.1194e-01,1.3458e-01,1.6996e-01},{2.7476e-01,3.4813e-01,4.6060e-01},
   {5.3831e-01,6.4392e-01,7.5775e-01},{1.7666e+00,1.5220e+00,1.3335e+00},
   {1.7815e+00,1.5328e+00,1.3169e+00},{7.8158e-01,7.9262e-01,7.7702e-01},
   {2.7893e-01,3.0852e-01,3.3145e-01},{1.2523e-01,1.3983e-01,1.5042e-01},
   {7.1976e-02,7.9535e-02,8.3672e-02},{2.8396e-02,3.1157e-02,3.2295e-02},
   {1.5253e-02,1.6691e-02,1.7258e-02},{3.6397e-03,3.9620e-03,4.0965e-03},
   {1.6153e-03,1.7553e-03,1.8162e-03},{8.6337e-04,9.4407e-04,9.8604e-04},
   {5.5600e-04,6.0753e-04,6.3464e-04},{2.4969e-04,2.7289e-04,2.8544e-04},
   {1.4058e-04,1.5401e-04,1.6150e-04},{6.1668e-05,6.8096e-05,7.1866e-05},
   {3.4039e-05,3.7865e-05,4.0194e-05},{1.4593e-05,1.6367e-05,1.7507e-05},
   {7.9566e-06,8.9557e-06,9.6069e-06},{2.4692e-06,3.0669e-06,3.4802e-06},
   {1.5167e-06,1.8732e-06,2.1302e-06},{1.0237e-06,1.2536e-06,1.4261e-06},
   {5.5172e-07,6.6364e-07,7.5431e-07}};

 DL = wave - 4713.20;
 if(DL < -280.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<66;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he5047_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[59] =
{-200.00,-160.00,-155.00,-147.00,-143.00,-140.00,-138.00,-136.00,-134.00,
 -131.00,-129.00,-127.00,-125.00,-123.00,-120.00,-115.00,-110.00,-100.00,
  -80.00, -60.00, -40.00, -30.00, -25.00, -20.00, -15.00, -10.00,  -8.00,
   -6.00,  -4.00,  -2.00,  -1.50,  -1.00,  -0.80,  -0.60,  -0.40,  -0.20,
   -0.10,   0.10,   0.20,   0.40,   0.60,   0.80,   1.00,   1.50,   2.00,
    4.00,   6.00,   8.00,  10.00,  15.00,  20.00,  30.00,  40.00,  60.00,
   80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[59][3] =
  {{3.6801e-06,3.8625e-06,3.9050e-06},{1.1900e-05,1.2168e-05,1.2216e-05},
   {1.4385e-05,1.4756e-05,1.4851e-05},{2.2564e-05,2.3055e-05,2.3186e-05},
   {3.3000e-05,3.3878e-05,3.4158e-05},{5.5628e-05,5.7931e-05,5.8985e-05},
   {1.1961e-04,1.2771e-04,1.3025e-04},{2.9002e-05,2.9879e-05,2.9939e-05},
   {2.9518e-05,2.9998e-05,3.0067e-05},{5.1812e-05,5.2779e-05,5.3129e-05},
   {1.6866e-05,1.7960e-05,1.8308e-05},{5.1180e-06,5.5558e-06,5.6188e-06},
   {5.9939e-06,6.4887e-06,6.5822e-06},{8.0718e-06,8.7502e-06,8.9329e-06},
   {9.1709e-06,9.7699e-06,9.9116e-06},{1.0151e-05,1.0709e-05,1.0823e-05},
   {1.0896e-05,1.1470e-05,1.1582e-05},{1.2384e-05,1.2986e-05,1.3082e-05},
   {1.6241e-05,1.7095e-05,1.7199e-05},{2.3898e-05,2.5207e-05,2.5277e-05},
   {4.6899e-05,4.9208e-05,4.9026e-05},{8.0548e-05,8.4131e-05,8.3534e-05},
   {1.1445e-04,1.1944e-04,1.1850e-04},{1.7609e-04,1.8411e-04,1.8280e-04},
   {3.0416e-04,3.2015e-04,3.1885e-04},{6.6230e-04,7.0658e-04,7.0850e-04},
   {9.5840e-04,1.0412e-03,1.0587e-03},{1.6652e-03,1.8117e-03,1.8470e-03},
   {3.5859e-03,3.9123e-03,4.0096e-03},{1.2695e-02,1.3969e-02,1.4566e-02},
   {2.0911e-02,2.3139e-02,2.4429e-02},{4.0735e-02,4.5559e-02,4.9352e-02},
   {5.7478e-02,6.4772e-02,7.1556e-02},{8.7019e-02,9.9171e-02,1.1309e-01},
   {1.4629e-01,1.6954e-01,2.0289e-01},{2.8847e-01,3.3853e-01,4.1332e-01},
   {4.3803e-01,5.0237e-01,5.8636e-01},{9.9985e-01,9.6570e-01,9.4015e-01},
   {1.2254e+00,1.0920e+00,9.9490e-01},{9.0527e-01,8.3201e-01,7.6267e-01},
   {4.3293e-01,4.3425e-01,4.2475e-01},{2.2485e-01,2.3172e-01,2.3004e-01},
   {1.3450e-01,1.3959e-01,1.3804e-01},{5.4031e-02,5.6444e-02,5.5658e-02},
   {2.8919e-02,3.0283e-02,2.9912e-02},{6.7882e-03,7.1369e-03,7.1019e-03},
   {2.9979e-03,3.1456e-03,3.1373e-03},{1.6827e-03,1.7664e-03,1.7654e-03},
   {9.9501e-04,1.0596e-03,1.0756e-03},{4.3989e-04,4.7126e-04,4.8062e-04},
   {2.4643e-04,2.6482e-04,2.7090e-04},{1.0874e-04,1.1698e-04,1.1999e-04},
   {6.0636e-05,6.5118e-05,6.6868e-05},{2.6217e-05,2.8074e-05,2.8886e-05},
   {1.4207e-05,1.5206e-05,1.5693e-05},{8.7180e-06,9.3461e-06,9.6814e-06},
   {5.2893e-06,5.6881e-06,5.9224e-06},{1.9355e-06,2.2150e-06,2.3856e-06},
   {9.0581e-07,1.0624e-06,1.1728e-06}};

 DL = wave - 5047.74;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<57;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}

float he6678_315(T,wave)
double T,wave;
{
 double DL,p1,p2;
 int i,j,k;
 static int l = 0;
 static float dl[53] =
{-200.00,-150.00,-125.00,-100.00, -80.00, -60.00, -55.00, -52.00, -49.00,
  -48.00, -47.00, -46.50, -46.00, -45.50, -45.00, -44.00, -43.00, -40.00,
  -35.00, -30.00, -20.00, -15.00, -10.00,  -6.00,  -4.00,  -2.00,  -1.00,
   -0.80,  -0.60,  -0.40,  -0.20,  -0.10,   0.10,   0.20,   0.40,   0.60,
    0.80,   1.00,   1.50,   2.00,   3.00,   5.00,  10.00,  15.00,  20.00,
   30.00,  45.00,  60.00,  80.00, 100.00, 125.00, 150.00, 200.00};

 static float t[3] = {10000.0,20000.0,40000.0};
 static float prof[53][3] =
  {{1.1099e-06,1.1007e-06,1.0778e-06},{2.4585e-06,2.3807e-06,2.2935e-06},
   {4.0448e-06,3.8838e-06,3.7207e-06},{7.4721e-06,7.1459e-06,6.8341e-06},
   {1.4205e-05,1.3624e-05,1.3082e-05},{3.8706e-05,3.7628e-05,3.6624e-05},
   {5.9493e-05,5.8231e-05,5.7037e-05},{8.6110e-05,8.4960e-05,8.3670e-05},
   {1.5949e-04,1.5991e-04,1.5942e-04},{2.3145e-04,2.3320e-04,2.3217e-04},
   {4.8046e-04,5.1149e-04,5.4171e-04},{8.7229e-04,8.9954e-04,8.7009e-04},
   {2.7309e-04,2.9115e-04,3.1313e-04},{7.8791e-05,7.8549e-05,7.8284e-05},
   {4.5502e-05,4.3452e-05,4.0596e-05},{2.9595e-05,2.7463e-05,2.5014e-05},
   {2.5589e-05,2.3439e-05,2.1181e-05},{2.4607e-05,2.2260e-05,1.9993e-05},
   {2.9984e-05,2.7031e-05,2.4256e-05},{3.9906e-05,3.5958e-05,3.2277e-05},
   {8.8777e-05,7.9852e-05,7.1635e-05},{1.5847e-04,1.4219e-04,1.2737e-04},
   {3.4972e-04,3.1473e-04,2.8259e-04},{9.5618e-04,8.6151e-04,7.7504e-04},
   {2.1134e-03,1.9077e-03,1.7215e-03},{8.0667e-03,7.3392e-03,6.7170e-03},
   {2.9924e-02,2.8009e-02,2.7233e-02},{4.5314e-02,4.3310e-02,4.4645e-02},
   {7.6910e-02,7.7071e-02,9.2284e-02},{1.6080e-01,1.8303e-01,2.5806e-01},
   {5.0143e-01,6.0395e-01,6.9865e-01},{9.5569e-01,1.0138e+00,9.8606e-01},
   {1.7287e+00,1.5218e+00,1.2627e+00},{1.3682e+00,1.2855e+00,1.1307e+00},
   {4.7516e-01,5.3151e-01,6.0550e-01},{1.8959e-01,1.9901e-01,2.4203e-01},
   {1.0019e-01,9.8962e-02,1.0716e-01},{6.2037e-02,5.9784e-02,6.0160e-02},
   {2.6638e-02,2.5179e-02,2.4092e-02},{1.4837e-02,1.3950e-02,1.3189e-02},
   {6.5848e-03,6.1807e-03,5.8094e-03},{2.4037e-03,2.2543e-03,2.1153e-03},
   {6.1387e-04,5.7633e-04,5.4172e-04},{2.6024e-04,2.4778e-04,2.3552e-04},
   {1.4494e-04,1.3849e-04,1.3203e-04},{6.2851e-05,6.0387e-05,5.7825e-05},
   {2.6774e-05,2.5909e-05,2.4945e-05},{1.4153e-05,1.3776e-05,1.3318e-05},
   {7.5338e-06,7.3883e-06,7.1833e-06},{4.5845e-06,4.5259e-06,4.4227e-06},
   {2.7687e-06,2.7536e-06,2.7064e-06},{1.8186e-06,1.8210e-06,1.7993e-06},
   {9.0872e-07,9.2155e-07,9.1916e-07}};

 DL = wave - 6678.15;
 if(DL < -200.0 || DL > 200.0) return(0.0);

 for(i=0;i<2;i++) {
   if(T >= t[i] && T < t[i+1]) {
     k = i;
     break;
   }
 }

 for(j=l;j<51;j++) {
   if(DL > dl[j] && DL <= dl[j+1]) {
     l = j;
     break;
   }
 }

 p1 = prof[l][k] + (prof[l][k+1]-prof[l][k])*(T-t[k])/(t[k+1]-t[k]);
 p2 = prof[l+1][k] + (prof[l+1][k+1]-prof[l+1][k])*(T-t[k])/(t[k+1]-t[k]);
 return(p1 + (p2-p1)*(DL-dl[l])/(dl[l+1]-dl[l]));
}
